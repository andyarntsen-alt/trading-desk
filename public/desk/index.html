<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Trading Desk ‚Äì Day Trading Journal</title>

    <meta name="theme-color" content="#10b981">
    <meta name="description" content="Your complete trading journal ‚Äì Daily prep, checklist, Monte Carlo and analysis in one place">
    
    <link rel="apple-touch-icon" href="/brand/tradingdesk-icon-180.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/brand/tradingdesk-icon-152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/brand/tradingdesk-icon-180.png">
    <link rel="apple-touch-icon" sizes="167x167" href="/brand/tradingdesk-icon-167.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="/brand/tradingdesk-icon-32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/brand/tradingdesk-icon-16.png">
    <link rel="shortcut icon" href="/brand/favicon.ico">

    <!-- Tailwind Play CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <!-- Inter font -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />

    <style>
      /* Theme CSS Variables */
      :root {
        /* Accent colors - Emerald (default) */
        --accent-primary: #10b981;
        --accent-primary-rgb: 16, 185, 129;
        --accent-light: #34d399;
        --accent-dark: #059669;
        --accent-glow: rgba(16, 185, 129, 0.2);
        --accent-border: rgba(16, 185, 129, 0.3);
        
        /* Background colors - Dark mode (default) */
        --bg-base: #050505;
        --bg-card: #0a0a0a;
        --bg-elevated: #0d0d0d;
        --bg-hover: #181818;
        --border-color: #161616;
        --border-light: #1f1f1f;
        --border-dark: #101010;
        
        /* Text colors */
        --text-primary: #f1f5f9;
        --text-secondary: #94a3b8;
        --text-muted: #64748b;
        --text-dim: #475569;
        
        /* Status colors */
        --color-success: #10b981;
        --color-warning: #f59e0b;
        --color-danger: #ef4444;
        --color-info: #3b82f6;
      }
      
      /* Light mode overrides */
      :root.light-mode {
        --bg-base: #f8fafc;
        --bg-card: #ffffff;
        --bg-elevated: #f1f5f9;
        --bg-hover: #e2e8f0;
        --border-color: #e2e8f0;
        --border-light: #cbd5e1;
        --border-dark: #f1f5f9;
        
        --text-primary: #0f172a;
        --text-secondary: #475569;
        --text-muted: #64748b;
        --text-dim: #94a3b8;
      }
      
      /* Accent color themes */
      :root.accent-blue {
        --accent-primary: #3b82f6;
        --accent-primary-rgb: 59, 130, 246;
        --accent-light: #60a5fa;
        --accent-dark: #2563eb;
        --accent-glow: rgba(59, 130, 246, 0.2);
        --accent-border: rgba(59, 130, 246, 0.3);
      }
      
      :root.accent-purple {
        --accent-primary: #8b5cf6;
        --accent-primary-rgb: 139, 92, 246;
        --accent-light: #a78bfa;
        --accent-dark: #7c3aed;
        --accent-glow: rgba(139, 92, 246, 0.2);
        --accent-border: rgba(139, 92, 246, 0.3);
      }
      
      :root.accent-amber {
        --accent-primary: #f59e0b;
        --accent-primary-rgb: 245, 158, 11;
        --accent-light: #fbbf24;
        --accent-dark: #d97706;
        --accent-glow: rgba(245, 158, 11, 0.2);
        --accent-border: rgba(245, 158, 11, 0.3);
      }
      
      :root.accent-rose {
        --accent-primary: #f43f5e;
        --accent-primary-rgb: 244, 63, 94;
        --accent-light: #fb7185;
        --accent-dark: #e11d48;
        --accent-glow: rgba(244, 63, 94, 0.2);
        --accent-border: rgba(244, 63, 94, 0.3);
      }
      
      /* Warm Linen Theme - A complete warm palette */
      :root.accent-warm {
        --accent-primary: #1F4E79;
        --accent-primary-rgb: 31, 78, 121;
        --accent-light: #9AA8B5;
        --accent-dark: #163a5c;
        --accent-glow: rgba(31, 78, 121, 0.15);
        --accent-border: rgba(31, 78, 121, 0.3);
        
        /* Warm theme specific colors */
        --warm-terracotta: #A8745F;
        --warm-caramel: #C49155;
        --warm-steel: #9AA8B5;
      }
      
      :root.accent-warm.light-mode {
        --bg-base: #EEE5D6;
        --bg-card: #F5EDE0;
        --bg-elevated: #D6C3A8;
        --bg-hover: #CDB89A;
        --border-color: #D6C3A8;
        --border-light: #C4B196;
        --border-dark: #E8DFD0;
        
        --text-primary: #2E3440;
        --text-secondary: #4A5568;
        --text-muted: #6B7280;
        --text-dim: #9AA8B5;
      }

      * {
        font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont,
          "Segoe UI", sans-serif;
      }
      
      /* Custom scrollbar for lists */
      .scrollbar-thin::-webkit-scrollbar {
        width: 4px;
      }
      .scrollbar-thin::-webkit-scrollbar-track {
        background: transparent;
      }
      .scrollbar-thin::-webkit-scrollbar-thumb {
        background: #333;
        border-radius: 4px;
      }
      .scrollbar-thin::-webkit-scrollbar-thumb:hover {
        background: #444;
      }
      
      /* Hide scrollbar utility */
      .scrollbar-hide {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }
      .scrollbar-hide::-webkit-scrollbar {
        display: none;
      }
      
      /* Apply theme variables to common elements */
      body {
        background-color: var(--bg-base);
        color: var(--text-primary);
      }

      .grade-badge-low {
        background-color: rgba(52, 211, 153, 0.15);
        border-color: rgba(52, 211, 153, 0.5);
        color: rgb(52 211 153);
      }

      .grade-badge-mid {
        background-color: rgba(251, 191, 36, 0.15);
        border-color: rgba(251, 191, 36, 0.5);
        color: rgb(251 191 36);
      }

      .grade-badge-high {
        background-color: rgba(248, 113, 113, 0.15);
        border-color: rgba(248, 113, 113, 0.5);
        color: rgb(248 113 113);
      }

      .notion-panel {
        background-color: #050505;
        border-color: #161616;
      }

      /* Mobile optimizations */
      @media (max-width: 768px) {
        /* Sidebar - hidden by default on mobile */
        aside#sidebar,
        aside.mobile-sidebar,
        #sidebar.mobile-sidebar {
          transform: translateX(-100%) !important;
          transition: transform 0.3s ease-in-out !important;
          z-index: 50 !important;
          position: fixed !important;
        }
        
        aside#sidebar.open,
        aside.mobile-sidebar.open,
        #sidebar.mobile-sidebar.open {
          transform: translateX(0) !important;
        }
        
        /* Overlay when sidebar is open */
        .sidebar-overlay {
          display: none;
          position: fixed;
          inset: 0;
          background: rgba(0, 0, 0, 0.7);
          z-index: 40;
        }
        
        .sidebar-overlay.open {
          display: block;
        }
        
        /* Main content - full width on mobile */
        .main-content {
          margin-left: 0 !important;
        }
        
        /* Touch-friendly inputs */
        input, select, textarea, button {
          font-size: 16px !important; /* Prevents zoom on iOS */
        }
        
        /* Better spacing for touch */
        .touch-target {
          min-height: 44px;
          min-width: 44px;
        }
        
        /* Scrollable containers */
        .mobile-scroll {
          -webkit-overflow-scrolling: touch;
          overflow-x: auto;
        }
        
        /* Hide desktop-only elements */
        .desktop-only {
          display: none !important;
        }
      }
      
      @media (min-width: 769px) {
        /* Show sidebar on desktop */
        aside#sidebar,
        aside.mobile-sidebar,
        #sidebar.mobile-sidebar {
          transform: translateX(0) !important;
        }
        
        /* Hide mobile-only elements */
        .mobile-only {
          display: none !important;
        }
      }
      
      /* Theme color preview circles */
      .theme-preview {
        width: 28px;
        height: 28px;
        border-radius: 50%;
        cursor: pointer;
        transition: transform 0.2s, box-shadow 0.2s;
        border: 2px solid transparent;
      }
      
      .theme-preview:hover {
        transform: scale(1.1);
      }
      
      .theme-preview.active {
        border-color: white;
        box-shadow: 0 0 0 2px rgba(255,255,255,0.3);
      }
      
      /* ============================================
         LIGHT MODE - Complete page override
         ============================================ */
      html.light-mode,
      html.light-mode body {
        background-color: var(--bg-base) !important;
        color: var(--text-primary) !important;
      }
      
      /* Light mode - All dark backgrounds become light */
      .light-mode .bg-\[\#050505\],
      .light-mode .bg-\[\#0a0a0a\],
      .light-mode .bg-\[\#080808\],
      .light-mode .bg-\[\#0d0d0d\],
      .light-mode .bg-black,
      .light-mode .bg-black\/60,
      .light-mode .bg-black\/40,
      .light-mode .notion-panel {
        background-color: var(--bg-card) !important;
      }
      
      .light-mode .bg-\[\#181818\],
      .light-mode .bg-\[\#1a1a1a\],
      .light-mode .bg-\[\#101010\],
      .light-mode .bg-\[\#121212\] {
        background-color: var(--bg-elevated) !important;
      }
      
      /* Light mode - Borders */
      .light-mode .border-\[\#161616\],
      .light-mode .border-\[\#101010\],
      .light-mode .border-\[\#1f1f1f\],
      .light-mode .border-\[\#262626\],
      .light-mode .border-t.border-\[\#101010\],
      .light-mode .border-b.border-\[\#161616\] {
        border-color: var(--border-color) !important;
      }
      
      /* Light mode - Text */
      .light-mode .text-white,
      .light-mode .text-slate-100,
      .light-mode .text-slate-200,
      .light-mode h1, .light-mode h2, .light-mode h3, .light-mode h4 {
        color: var(--text-primary) !important;
      }
      
      .light-mode .text-slate-300,
      .light-mode .text-slate-400 {
        color: var(--text-secondary) !important;
      }
      
      .light-mode .text-slate-500,
      .light-mode .text-slate-600 {
        color: var(--text-muted) !important;
      }
      
      /* Light mode - Sidebar */
      .light-mode aside,
      .light-mode #sidebar,
      .light-mode .mobile-sidebar {
        background-color: var(--bg-card) !important;
        border-color: var(--border-color) !important;
      }
      
      .light-mode [data-section-nav]:hover {
        background-color: var(--bg-elevated) !important;
      }
      
      .light-mode [data-section-nav].bg-\[\#181818\] {
        background-color: var(--bg-elevated) !important;
      }
      
      /* Light mode - Inputs & Form elements */
      .light-mode input:not([type="checkbox"]):not([type="radio"]),
      .light-mode textarea,
      .light-mode select {
        background-color: var(--bg-elevated) !important;
        border-color: var(--border-color) !important;
        color: var(--text-primary) !important;
      }
      
      .light-mode input::placeholder,
      .light-mode textarea::placeholder {
        color: var(--text-muted) !important;
      }
      
      /* Light mode - Modals */
      .light-mode .fixed.inset-0.bg-black\/80,
      .light-mode .fixed.inset-0.bg-black\/70 {
        background-color: rgba(0, 0, 0, 0.4) !important;
      }
      
      /* Light mode - Scrollbars */
      .light-mode ::-webkit-scrollbar-track {
        background: var(--bg-elevated);
      }
      
      .light-mode ::-webkit-scrollbar-thumb {
        background: var(--border-color);
      }
      
      /* Light mode - Keep certain buttons dark text */
      .light-mode .bg-emerald-500,
      .light-mode .bg-emerald-600,
      .light-mode .bg-blue-500,
      .light-mode .bg-rose-500,
      .light-mode .bg-red-500 {
        color: white !important;
      }
      
      /* Light mode - Header gradient */
      .light-mode .bg-gradient-to-b.from-black,
      .light-mode .from-black,
      .light-mode [class*="from-black"] {
        --tw-gradient-from: var(--bg-card) !important;
        background: var(--bg-card) !important;
      }
      
      .light-mode .via-\[\#050505\],
      .light-mode .to-\[\#050505\] {
        --tw-gradient-via: var(--bg-card) !important;
        --tw-gradient-to: var(--bg-card) !important;
      }
      
      /* Light mode - Checkboxes and form elements */
      .light-mode input[type="checkbox"],
      .light-mode input[type="radio"],
      .light-mode input[type="checkbox"].bg-black,
      .light-mode input[type="radio"].bg-black,
      .light-mode input.bg-black,
      .light-mode .rounded.border-\[\#333\].bg-black {
        background-color: var(--bg-elevated) !important;
        border-color: var(--border-color) !important;
        accent-color: var(--accent-primary) !important;
      }
      
      .light-mode input[type="checkbox"]:checked,
      .light-mode input[type="radio"]:checked {
        background-color: var(--accent-primary) !important;
        border-color: var(--accent-primary) !important;
      }
      
      .light-mode .bg-black:not(.bg-gradient-to-b):not(button):not(a) {
        background-color: var(--bg-card) !important;
      }
      
      /* Super specific checkbox override for Tailwind */
      html.light-mode input#prep-sleep,
      html.light-mode input#prep-emotions,
      html.light-mode input#prep-risklimit,
      html.light-mode input[id^="prep-"],
      html.light-mode input[id^="check-"],
      html.light-mode section input[type="checkbox"],
      html.light-mode section input[type="radio"] {
        background-color: var(--bg-elevated) !important;
        border-color: var(--border-color) !important;
        background-image: none !important;
      }
      
      html.light-mode section input[type="checkbox"]:checked,
      html.light-mode section input[type="radio"]:checked {
        background-color: var(--accent-primary) !important;
        border-color: var(--accent-primary) !important;
      }
      
      /* Light mode - Sidebar badges and slate elements */
      .light-mode .bg-slate-800,
      .light-mode .bg-slate-900,
      .light-mode .bg-slate-700 {
        background-color: var(--bg-elevated) !important;
      }
      
      .light-mode .text-slate-500 {
        color: var(--text-muted) !important;
      }
      
      .light-mode .border-\[\#333\],
      .light-mode .border-slate-700,
      .light-mode .border-slate-600 {
        border-color: var(--border-color) !important;
      }
      
      /* Light mode - Dropdown selects */
      .light-mode select option {
        background-color: var(--bg-card);
        color: var(--text-primary);
      }
      
      /* Light mode - Toggle switches */
      .light-mode .toggle-slider {
        background-color: var(--bg-elevated) !important;
      }
      
      .light-mode .toggle-switch input:checked + .toggle-slider {
        background-color: var(--accent-primary) !important;
      }
      
      /* Light mode - Charts background */
      .light-mode canvas {
        background-color: transparent !important;
      }
      
      /* Light mode - Status bar */
      .light-mode .fixed.bottom-0 {
        background-color: var(--bg-card) !important;
        border-color: var(--border-color) !important;
      }
      
      /* Light mode - Specific gradient badges */
      .light-mode .bg-gradient-to-br.from-emerald-500\/10,
      .light-mode .bg-gradient-to-br.from-blue-500\/10,
      .light-mode .bg-gradient-to-br.from-purple-500\/10,
      .light-mode .bg-gradient-to-br.from-amber-500\/10 {
        background: var(--bg-elevated) !important;
      }
      
      /* ============================================
         ACCENT COLOR OVERRIDES  
         ============================================ */
      
      /* Override emerald accent colors for other themes */
      :root:not(.accent-emerald) .text-emerald-400,
      :root:not(.accent-emerald) .text-emerald-300,
      :root:not(.accent-emerald) .text-emerald-500 {
        color: var(--accent-primary) !important;
      }
      
      :root:not(.accent-emerald) .bg-emerald-500 {
        background-color: var(--accent-primary) !important;
      }
      
      :root:not(.accent-emerald) .bg-emerald-400 {
        background-color: var(--accent-light) !important;
      }
      
      :root:not(.accent-emerald) .bg-emerald-600 {
        background-color: var(--accent-dark) !important;
      }
      
      :root:not(.accent-emerald) .bg-emerald-500\/20,
      :root:not(.accent-emerald) .bg-emerald-500\/10 {
        background-color: var(--accent-glow) !important;
      }
      
      :root:not(.accent-emerald) .border-emerald-500,
      :root:not(.accent-emerald) .border-emerald-400 {
        border-color: var(--accent-primary) !important;
      }
      
      :root:not(.accent-emerald) .border-emerald-500\/30,
      :root:not(.accent-emerald) .border-emerald-500\/20 {
        border-color: var(--accent-border) !important;
      }
      
      :root:not(.accent-emerald) .hover\:bg-emerald-400:hover,
      :root:not(.accent-emerald) .hover\:bg-emerald-500:hover {
        background-color: var(--accent-light) !important;
      }
      
      :root:not(.accent-emerald) .from-emerald-500 {
        --tw-gradient-from: var(--accent-primary) !important;
      }
      
      :root:not(.accent-emerald) .to-emerald-600,
      :root:not(.accent-emerald) .to-emerald-500 {
        --tw-gradient-to: var(--accent-dark) !important;
      }
      
      :root:not(.accent-emerald) .section-dot.bg-emerald-400 {
        background-color: var(--accent-primary) !important;
      }
      
      :root:not(.accent-emerald) .shadow-emerald-500\/20,
      :root:not(.accent-emerald) .shadow-emerald-500\/30 {
        --tw-shadow-color: var(--accent-glow) !important;
      }
      
      /* Safe area for notched phones */
      @supports (padding: max(0px)) {
        .safe-area-bottom {
          padding-bottom: max(1rem, env(safe-area-inset-bottom));
        }
        .safe-area-top {
          padding-top: max(0.5rem, env(safe-area-inset-top));
        }
      }
      
      /* Smooth scrolling */
      html {
        scroll-behavior: smooth;
      }
      
      /* Prevent text selection on buttons */
      button {
        -webkit-user-select: none;
        user-select: none;
      }
      
      /* Better tap highlight */
      @media (max-width: 768px) {
        a, button {
          -webkit-tap-highlight-color: rgba(255, 255, 255, 0.1);
        }
        
        /* Improve checkbox/radio touch targets */
        input[type="checkbox"], input[type="radio"] {
          width: 20px;
          height: 20px;
          min-height: 20px;
        }
        
        /* Fix textarea height */
        textarea {
          min-height: 80px;
        }
        
        /* Smaller text on very small screens */
        @media (max-width: 375px) {
          .text-\[12px\] { font-size: 11px !important; }
          .text-\[11px\] { font-size: 10px !important; }
          .text-\[10px\] { font-size: 9px !important; }
        }
      }
      
      /* Modern number input spinners */
      input[type="number"] {
        -moz-appearance: textfield;
        appearance: textfield;
      }
      
      input[type="number"]::-webkit-outer-spin-button,
      input[type="number"]::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }
      
      /* Custom number input wrapper styling */
      .number-input-wrapper {
        position: relative;
        display: flex;
        align-items: center;
        width: 100%;
      }
      
      .number-input-wrapper input {
        padding-right: 28px !important;
        width: 100%;
      }
      
      .number-input-controls {
        position: absolute;
        right: 4px;
        top: 50%;
        transform: translateY(-50%);
        display: flex;
        flex-direction: column;
        gap: 1px;
      }
      
      .number-input-controls button {
        width: 20px;
        height: 14px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 4px;
        color: rgba(255, 255, 255, 0.4);
        font-size: 8px;
        cursor: pointer;
        transition: all 0.15s ease;
        line-height: 1;
      }
      
      .number-input-controls button:hover {
        background: rgba(16, 185, 129, 0.2);
        border-color: rgba(16, 185, 129, 0.4);
        color: rgb(52, 211, 153);
      }
      
      .number-input-controls button:active {
        background: rgba(16, 185, 129, 0.3);
        transform: scale(0.95);
      }
      
      /* Modern checkbox styling */
      input[type="checkbox"].crit {
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        width: 18px;
        height: 18px;
        min-width: 18px;
        border: 2px solid rgba(255, 255, 255, 0.15);
        border-radius: 5px;
        background: rgba(0, 0, 0, 0.4);
        cursor: pointer;
        transition: all 0.2s ease;
        position: relative;
        flex-shrink: 0;
      }
      
      input[type="checkbox"].crit:hover {
        border-color: rgba(16, 185, 129, 0.4);
        background: rgba(16, 185, 129, 0.05);
      }
      
      input[type="checkbox"].crit:checked {
        background: linear-gradient(135deg, rgb(16, 185, 129), rgb(5, 150, 105));
        border-color: rgb(16, 185, 129);
        box-shadow: 0 0 12px rgba(16, 185, 129, 0.3);
      }
      
      input[type="checkbox"].crit:checked::after {
        content: '';
        position: absolute;
        left: 5px;
        top: 2px;
        width: 5px;
        height: 9px;
        border: solid white;
        border-width: 0 2px 2px 0;
        transform: rotate(45deg);
      }
      
      input[type="checkbox"].crit:focus {
        outline: none;
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.2);
      }
      
      /* Animation for checkbox */
      input[type="checkbox"].crit:checked {
        animation: checkPop 0.3s ease;
      }
      
      @keyframes checkPop {
        0% { transform: scale(1); }
        50% { transform: scale(1.15); }
        100% { transform: scale(1); }
      }

      @keyframes slideUp {
        from {
          transform: translateY(100%);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      .animate-slide-up {
        animation: slideUp 0.4s ease-out forwards;
      }
      
      /* Mobile checkbox size */
      @media (max-width: 768px) {
        input[type="checkbox"].crit {
          width: 22px;
          height: 22px;
          min-width: 22px;
        }
        
        input[type="checkbox"].crit:checked::after {
          left: 6px;
          top: 3px;
          width: 6px;
          height: 10px;
        }
      }
      
      /* Widget Settings Dropdown */
      .widget-settings-container {
        position: relative;
      }
      
      .widget-settings-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 32px;
        height: 32px;
        border-radius: 8px;
        background: transparent;
        border: 1px solid transparent;
        color: rgba(148, 163, 184, 0.6);
        cursor: pointer;
        transition: all 0.2s ease;
      }
      
      .widget-settings-btn:hover {
        background: rgba(255, 255, 255, 0.05);
        border-color: rgba(255, 255, 255, 0.1);
        color: rgba(148, 163, 184, 1);
      }
      
      .widget-settings-btn.active {
        background: rgba(16, 185, 129, 0.1);
        border-color: rgba(16, 185, 129, 0.3);
        color: rgb(52, 211, 153);
      }
      
      .widget-settings-btn svg {
        transition: transform 0.3s ease;
        pointer-events: none;
      }
      
      .widget-settings-btn:hover svg {
        transform: rotate(45deg);
      }
      
      .widget-settings-dropdown {
        position: absolute;
        top: calc(100% + 8px);
        right: 0;
        min-width: 220px;
        background: #0a0a0a;
        border: 1px solid #262626;
        border-radius: 12px;
        padding: 8px 0;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        z-index: 100;
        opacity: 0;
        visibility: hidden;
        transform: translateY(-8px);
        transition: all 0.2s ease;
      }
      
      .widget-settings-dropdown.open {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }
      
      .widget-settings-header {
        padding: 8px 16px 12px;
        border-bottom: 1px solid #1a1a1a;
        margin-bottom: 4px;
      }
      
      .widget-settings-header span {
        font-size: 11px;
        font-weight: 600;
        color: rgba(148, 163, 184, 0.7);
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }
      
      .widget-settings-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 10px 16px;
        cursor: pointer;
        transition: background 0.15s ease;
      }
      
      .widget-settings-item:hover {
        background: rgba(255, 255, 255, 0.03);
      }
      
      .widget-settings-item label {
        font-size: 12px;
        color: #e2e8f0;
        cursor: pointer;
        flex: 1;
      }
      
      /* Modern Toggle Switch */
      .toggle-switch {
        position: relative;
        width: 40px;
        height: 22px;
        flex-shrink: 0;
      }
      
      .toggle-switch input {
        position: absolute;
        opacity: 0;
        width: 100%;
        height: 100%;
        cursor: pointer;
        z-index: 1;
        margin: 0;
      }
      
      .toggle-slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 22px;
        transition: all 0.25s ease;
      }
      
      .toggle-slider::before {
        position: absolute;
        content: "";
        height: 16px;
        width: 16px;
        left: 2px;
        bottom: 2px;
        background: rgba(255, 255, 255, 0.5);
        border-radius: 50%;
        transition: all 0.25s ease;
      }
      
      .toggle-switch input:checked + .toggle-slider {
        background: rgba(16, 185, 129, 0.3);
        border-color: rgba(16, 185, 129, 0.5);
      }
      
      .toggle-switch input:checked + .toggle-slider::before {
        transform: translateX(18px);
        background: rgb(52, 211, 153);
        box-shadow: 0 0 8px rgba(16, 185, 129, 0.5);
      }
      
      .toggle-switch input:focus + .toggle-slider {
        box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.2);
      }
      
      /* ============================================
         FINAL OVERRIDES - Loaded last for max priority
         ============================================ */
      html.light-mode input[type="checkbox"].bg-black,
      html.light-mode input[type="checkbox"].rounded.bg-black,
      html.light-mode input.rounded.border-\[\#333\].bg-black,
      html.light-mode .bg-black[type="checkbox"] {
        background-color: #D6C3A8 !important;
        border-color: #C4B196 !important;
        -webkit-appearance: none !important;
        appearance: none !important;
      }
      
      /* Force override with attribute selector */
      html.light-mode [type="checkbox"][class*="bg-black"] {
        background-color: var(--bg-elevated, #D6C3A8) !important;
        border-color: var(--border-color, #C4B196) !important;
      }
      
      html.light-mode [type="checkbox"]:checked[class*="bg-black"],
      html.light-mode [type="checkbox"]:checked {
        background-color: var(--accent-primary, #1F4E79) !important;
        border-color: var(--accent-primary, #1F4E79) !important;
      }
    </style>

  </head>

  <body class="min-h-screen bg-black text-white antialiased">
    <!-- Mobile Header -->
    <header class="mobile-only fixed top-0 left-0 right-0 z-30 bg-[#050505] border-b border-[#1f1f1f] px-4 py-3 safe-area-top">
      <div class="flex items-center justify-between">
        <button id="mobile-menu-btn" class="p-2 -ml-2 touch-target" aria-label="Open menu">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
          </svg>
        </button>
        <!-- App Title -->
        <span class="text-[13px] font-semibold tracking-wide text-slate-200">Trading Desk</span>
        <div class="w-10"></div> <!-- Spacer for centering -->
      </div>
    </header>
    
    <!-- Sidebar Overlay -->
    <div id="sidebar-overlay" class="sidebar-overlay"></div>
    
    <!-- Sidebar -->
    <aside
      id="sidebar"
      class="mobile-sidebar fixed inset-y-0 left-0 w-60 bg-[#050505] border-r border-[#1f1f1f] flex flex-col"
    >
      <div class="px-4 py-3">
        <a
          href="#"
          data-section-nav="prep"
          class="block text-white hover:opacity-80 transition-opacity cursor-pointer"
        >
          <div class="text-[16px] font-bold uppercase tracking-tight leading-none mb-0.5">
            TRADING DESK
          </div>
          <div class="text-[10px] font-normal uppercase tracking-wide text-slate-400 ml-0.5">
            trader1andy
          </div>
        </a>
      </div>

      <nav
        class="mt-2 flex-1 overflow-y-auto text-[12px] text-slate-400"
      >
        <!-- DAILY WORKFLOW - Prep, Trade, Review -->
        <div class="mb-4">
          <p class="px-4 mb-1 text-[10px] text-slate-500 uppercase tracking-wider font-medium">Daily Workflow</p>
          <a
            href="#"
            data-section-nav="prep"
            class="flex items-center gap-2.5 px-4 py-2 bg-[#181818] text-slate-100 rounded-md"
          >
            <span class="flex items-center justify-center w-5 h-5 rounded bg-emerald-500/20 text-emerald-400 text-[10px] font-bold">1</span>
            <span class="section-dot w-1.5 h-1.5 rounded-full bg-emerald-400 hidden"></span>
            Daily Prep
          </a>
          <a
            href="#"
            data-section-nav="checklist"
            class="flex items-center gap-2.5 px-4 py-2 rounded-md hover:bg-[#181818] hover:text-white transition-colors"
          >
            <span class="flex items-center justify-center w-5 h-5 rounded bg-slate-800 text-slate-500 text-[10px] font-bold">2</span>
            <span class="section-dot w-1.5 h-1.5 rounded-full bg-slate-600 hidden"></span>
            Trade Checklist
          </a>
          <a
            href="#"
            data-section-nav="review"
            class="flex items-center gap-2.5 px-4 py-2 rounded-md hover:bg-[#181818] hover:text-white transition-colors"
          >
            <span class="flex items-center justify-center w-5 h-5 rounded bg-slate-800 text-slate-500 text-[10px] font-bold">3</span>
            <span class="section-dot w-1.5 h-1.5 rounded-full bg-slate-600 hidden"></span>
            Review
          </a>
        </div>

        <!-- INSIGHTS - Analysis & Strategy -->
        <div class="mb-4 pt-3 border-t border-[#1a1a1a]">
          <p class="px-4 mb-1 text-[10px] text-slate-500 uppercase tracking-wider font-medium">Insights</p>
          <a
            href="#"
            data-section-nav="analysis"
            class="flex items-center gap-2.5 px-4 py-2 rounded-md hover:bg-[#181818] hover:text-white transition-colors"
          >
            <span class="section-dot w-1.5 h-1.5 rounded-full bg-slate-600"></span>
            Analysis
          </a>
          <a
            href="#"
            data-section-nav="playbook"
            class="flex items-center gap-2.5 px-4 py-2 rounded-md hover:bg-[#181818] hover:text-white transition-colors"
          >
            <span class="section-dot w-1.5 h-1.5 rounded-full bg-slate-600"></span>
            Playbook
          </a>
        </div>

        <!-- TOOLS - Utilities -->
        <div class="mb-4 pt-3 border-t border-[#1a1a1a]">
          <p class="px-4 mb-1 text-[10px] text-slate-500 uppercase tracking-wider font-medium">Tools</p>
          <a
            href="#"
            data-section-nav="finance"
            class="flex items-center gap-2.5 px-4 py-2 rounded-md hover:bg-[#181818] hover:text-white transition-colors"
          >
            <span class="section-dot w-1.5 h-1.5 rounded-full bg-slate-600"></span>
            Finance & Risk
          </a>
          <a
            href="#"
            data-section-nav="import"
            class="flex items-center gap-2.5 px-4 py-2 rounded-md hover:bg-[#181818] hover:text-white transition-colors"
          >
            <span class="section-dot w-1.5 h-1.5 rounded-full bg-slate-600"></span>
            Import Trades
          </a>
          <a
            href="#"
            data-section-nav="montecarlo"
            class="flex items-center gap-2.5 px-4 py-2 rounded-md hover:bg-[#181818] hover:text-white transition-colors"
          >
            <span class="section-dot w-1.5 h-1.5 rounded-full bg-slate-600"></span>
            Monte Carlo
          </a>
          <a
            href="#"
            data-section-nav="screenshots"
            class="flex items-center gap-2.5 px-4 py-2 rounded-md hover:bg-[#181818] hover:text-white transition-colors"
          >
            <span class="section-dot w-1.5 h-1.5 rounded-full bg-slate-600"></span>
            Calendar
          </a>
          <a
            href="#"
            data-section-nav="symbols"
            class="flex items-center gap-2.5 px-4 py-2 rounded-md hover:bg-[#181818] hover:text-white transition-colors"
          >
            <span class="section-dot w-1.5 h-1.5 rounded-full bg-slate-600"></span>
            Symbols
          </a>
          <a
            href="#"
            data-section-nav="reports"
            class="flex items-center gap-2.5 px-4 py-2 rounded-md hover:bg-[#181818] hover:text-white transition-colors"
          >
            <span class="section-dot w-1.5 h-1.5 rounded-full bg-slate-600"></span>
            Reports
          </a>
        </div>

        <!-- SETTINGS -->
        <div class="pt-3 border-t border-[#1a1a1a]">
          <a
            href="#"
            data-section-nav="vault"
            class="flex items-center gap-2.5 px-4 py-2 rounded-md hover:bg-[#181818] hover:text-white transition-colors"
          >
            <span class="section-dot w-1.5 h-1.5 rounded-full bg-slate-600"></span>
            Account
          </a>
          <a
            href="#"
            data-section-nav="howto"
            class="flex items-center gap-2.5 px-4 py-2 rounded-md hover:bg-[#181818] hover:text-white transition-colors"
          >
            <span class="section-dot w-1.5 h-1.5 rounded-full bg-slate-600"></span>
            How to
          </a>
          <a
            href="/sign-out"
            target="_top"
            class="flex items-center gap-2.5 px-4 py-2 rounded-md text-rose-300 hover:bg-rose-500/10 hover:text-rose-200 transition-colors"
          >
            <span class="section-dot w-1.5 h-1.5 rounded-full bg-rose-400"></span>
            Sign out
          </a>
        </div>
      </nav>

      <div
        class="px-4 py-3 border-t border-[#1f1f1f] text-[10px] text-slate-600 safe-area-bottom"
      >
        ¬© 2026 Trading Desk
      </div>
    </aside>

    <!-- Main content -->
    <div class="main-content md:ml-60 min-h-screen pt-14 md:pt-0">
      <!-- Risk Status Bar (Responsive) -->
      <div id="risk-status-bar" class="flex items-center justify-between gap-2 px-3 md:px-6 py-2 bg-[#0a0a0a]/80 backdrop-blur-sm border-b border-[#161616] sticky top-14 md:top-0 z-20 md:z-30">
        <!-- Left side: Filter + Stats -->
        <div class="flex items-center gap-2 md:gap-4 flex-1 min-w-0">
          <!-- Filter -->
          <select 
            id="global-account-filter" 
            class="px-2 py-1.5 rounded-lg border border-[#222] bg-black text-[11px] text-slate-300 focus:outline-none focus:border-slate-500 cursor-pointer flex-shrink-0"
          >
            <option value="all">üìÅ All</option>
            <optgroup label="Categories" id="global-filter-categories">
              <option value="cat:crypto">‚Çø Crypto</option>
              <option value="cat:forex">üí± Forex</option>
              <option value="cat:stocks">üìà Stocks</option>
              <option value="cat:futures">üìä Futures</option>
              <option value="cat:options">‚ö° Options</option>
            </optgroup>
            <optgroup label="Accounts" id="global-filter-accounts"></optgroup>
          </select>
          
          <div class="hidden md:block h-4 w-px bg-[#222]"></div>
          
          <!-- Stats (inline) -->
          <div class="flex items-center gap-3 md:gap-4 text-[10px] md:text-[11px] overflow-hidden">
            <div class="flex items-center gap-1 shrink-0">
              <span class="text-slate-500 hidden md:inline">P&L:</span>
              <span id="header-today-pnl" class="font-medium text-emerald-400">+$0.00</span>
            </div>
            <div class="hidden sm:flex items-center gap-1 shrink-0">
              <span class="text-slate-500">Limit:</span>
              <span id="header-limit-percent" class="text-slate-400">-</span>
            </div>
            <div class="flex items-center gap-1 shrink-0">
              <span class="text-slate-500 hidden md:inline">Trades:</span>
              <span id="header-trades-count" class="font-medium text-slate-200">0</span>
              <span class="text-slate-500 md:hidden">trades</span>
            </div>
          </div>
        </div>
        
        <!-- Status Badge -->
        <div id="header-status-badge" class="flex items-center gap-1.5 px-2 py-1 rounded-lg bg-emerald-500/10 border border-emerald-500/20 shrink-0">
          <div id="header-status-dot" class="w-1.5 h-1.5 rounded-full bg-emerald-400"></div>
          <span id="header-status-text" class="text-[9px] md:text-[10px] font-medium text-emerald-400">Ready</span>
        </div>
        
        <!-- Hidden progress bar for calculations -->
        <div class="hidden">
          <div id="header-limit-bar" style="width: 0%"></div>
        </div>
      </div>
      
      <!-- Header -->
      <section
        class="pt-6 md:pt-10 pb-4 px-4 md:px-8 bg-gradient-to-b from-black via-[#050505] to-[#050505]"
      >
        <div class="max-w-5xl mx-auto">
          <div class="flex flex-col md:flex-row md:items-end md:justify-between gap-3">
            <div class="hidden md:block">
              <h1
                class="text-[26px] md:text-[30px] font-semibold tracking-[0.14em] mb-1"
              >
                TRADING DESK
              </h1>
              <p class="text-[12px] text-slate-500">
                Daily prep, trade checklist, Monte Carlo and journal in one place.
              </p>
            </div>
          </div>
        </div>
      </section>
      
      <!-- Loss Limit Alert Modal -->
      <div id="loss-limit-alert-modal" class="fixed inset-0 z-[100] hidden">
        <div class="absolute inset-0 bg-black/80 backdrop-blur-sm"></div>
        <div class="absolute inset-0 flex items-center justify-center p-4">
          <div class="relative bg-[#0a0a0a] border-2 border-rose-500/50 rounded-2xl p-6 max-w-md w-full shadow-2xl shadow-rose-500/20">
            <div class="text-center">
              <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-rose-500/20 border-2 border-rose-500/50 flex items-center justify-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-rose-400">
                  <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                  <line x1="12" y1="9" x2="12" y2="13"></line>
                  <line x1="12" y1="17" x2="12.01" y2="17"></line>
                </svg>
              </div>
              <h3 id="alert-modal-title" class="text-[18px] font-bold text-rose-400 mb-2">Daily Loss Limit Reached!</h3>
              <p id="alert-modal-message" class="text-[13px] text-slate-400 mb-4">
                You have reached your daily loss limit. Consider stopping trading for today to protect your capital.
              </p>
              <div id="alert-modal-stats" class="grid grid-cols-2 gap-3 mb-5">
                <div class="rounded-lg bg-black/40 border border-[#262626] p-3">
                  <div class="text-[10px] text-slate-500">Today's Loss</div>
                  <div id="alert-today-loss" class="text-[16px] font-bold text-rose-400">-$0</div>
                </div>
                <div class="rounded-lg bg-black/40 border border-[#262626] p-3">
                  <div class="text-[10px] text-slate-500">Daily Limit</div>
                  <div id="alert-daily-limit" class="text-[16px] font-bold text-slate-300">$0</div>
                </div>
              </div>
              <!-- Cooldown Timer -->
              <div id="cooldown-section" class="hidden mb-5">
                <div class="text-[11px] text-slate-500 mb-2">Cooldown Timer</div>
                <div class="text-[24px] font-bold text-amber-400" id="cooldown-timer">30:00</div>
                <p class="text-[10px] text-slate-500 mt-1">Take a break. Review your trades.</p>
              </div>
              <div class="flex gap-3">
                <button id="alert-acknowledge-btn" class="flex-1 px-4 py-2.5 rounded-lg bg-rose-500/20 border border-rose-500/30 text-[12px] font-medium text-rose-300 hover:bg-rose-500/30 transition-colors">
                  I Understand - Stop Trading
                </button>
                <button id="alert-dismiss-btn" class="px-4 py-2.5 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-400 hover:text-slate-200 transition-colors">
                  Dismiss
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Tilt Warning Modal -->
      <div id="tilt-warning-modal" class="fixed inset-0 z-[100] hidden">
        <div class="absolute inset-0 bg-black/80 backdrop-blur-sm"></div>
        <div class="absolute inset-0 flex items-center justify-center p-4">
          <div class="relative bg-[#0a0a0a] border-2 border-amber-500/50 rounded-2xl p-6 max-w-md w-full shadow-2xl shadow-amber-500/20">
            <div class="text-center">
              <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-amber-500/20 border-2 border-amber-500/50 flex items-center justify-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-amber-400">
                  <circle cx="12" cy="12" r="10"></circle>
                  <line x1="12" y1="8" x2="12" y2="12"></line>
                  <line x1="12" y1="16" x2="12.01" y2="16"></line>
                </svg>
              </div>
              <h3 class="text-[18px] font-bold text-amber-400 mb-2">Tilt Warning!</h3>
              <p id="tilt-warning-message" class="text-[13px] text-slate-400 mb-4">
                You may be trading on tilt. Take a moment to assess your mental state.
              </p>
              <div id="tilt-indicators" class="space-y-2 mb-5 text-left">
                <!-- Filled dynamically -->
              </div>
              <div class="flex gap-3">
                <button id="tilt-take-break-btn" class="flex-1 px-4 py-2.5 rounded-lg bg-amber-500/20 border border-amber-500/30 text-[12px] font-medium text-amber-300 hover:bg-amber-500/30 transition-colors">
                  Take a Break
                </button>
                <button id="tilt-dismiss-btn" class="px-4 py-2.5 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-400 hover:text-slate-200 transition-colors">
                  Continue Trading
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Daily Prep -->
      <section
        id="prep"
        data-section-panel="prep"
        class="py-6 md:py-10 px-4 md:px-8 border-t border-[#101010] bg-[#050505]"
      >
        <div class="max-w-5xl mx-auto space-y-4 md:space-y-6">
          <div class="flex items-center justify-between">
            <div>
              <h2 class="text-[14px] md:text-[15px] font-semibold mb-1">Daily Prep</h2>
              <p class="text-[11px] md:text-[12px] text-slate-500">
                Quick pass before you do anything. Stored as context for the
                day.
              </p>
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-[12px]">
            <!-- Market & HTF -->
            <div
              class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4"
            >
              <div class="mb-2 text-slate-300 font-medium">
                Market & HTF
              </div>
              <label class="block mb-2">
                <span class="text-slate-500">Instrument</span>
                <div class="relative mt-1">
                  <input
                    id="prep-instrument"
                    class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-slate-100 text-[12px] focus:outline-none focus:border-slate-400"
                    placeholder="BTCUSDT, ES, NQ ‚Ä¶"
                    autocomplete="off"
                  />
                  <div
                    id="prep-instrument-autocomplete"
                    class="absolute z-50 w-full mt-1 bg-black border border-[#222] rounded-lg shadow-lg max-h-60 overflow-y-auto hidden"
                  ></div>
                </div>
              </label>
              <label class="block mb-2">
                <span class="text-slate-500">HTF trend</span>
                <select
                  id="prep-trend"
                  class="mt-1 w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-slate-100 text-[12px] focus:outline-none focus:border-slate-400"
                >
                  <option value="">‚Äì</option>
                  <option value="bull">Bull</option>
                  <option value="bear">Bear</option>
                  <option value="range">Range</option>
                </select>
              </label>
              <label class="block">
                <span class="text-slate-500">Key levels</span>
                <textarea
                  id="prep-levels"
                  rows="3"
                  class="mt-1 w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-slate-100 text-[12px] focus:outline-none focus:border-slate-400"
                  placeholder="Weekly/Daily open, prior high/low, key liquidity ‚Ä¶"
                ></textarea>
              </label>
            </div>

            <!-- Session & news -->
            <div
              class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4"
            >
              <div class="mb-2 text-slate-300 font-medium">
                Session & news
              </div>
              <label class="block mb-2">
                <span class="text-slate-500">Session</span>
                <select
                  id="prep-session"
                  class="mt-1 w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-slate-100 text-[12px] focus:outline-none focus:border-slate-400"
                >
                  <option value="">‚Äì</option>
                  <option value="asia">Asia</option>
                  <option value="london">London</option>
                  <option value="ny">New York</option>
                  <option value="overlap">London/NY overlap</option>
                </select>
              </label>
              <label class="block mb-2">
                <span class="text-slate-500">News risk</span>
                <select
                  id="prep-news"
                  class="mt-1 w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-slate-100 text-[12px] focus:outline-none focus:border-slate-400"
                >
                  <option value="">‚Äì</option>
                  <option value="low">Low</option>
                  <option value="medium">Medium</option>
                  <option value="high">High</option>
                </select>
              </label>
              <label class="block">
                <span class="text-slate-500">Volatility</span>
                <select
                  id="prep-vol"
                  class="mt-1 w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-slate-100 text-[12px] focus:outline-none focus:border-slate-400"
                >
                  <option value="">‚Äì</option>
                  <option value="low">Low</option>
                  <option value="normal">Normal</option>
                  <option value="high">High</option>
                </select>
              </label>
            </div>

            <!-- Psychology -->
            <div
              class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4"
            >
              <div class="mb-2 text-slate-300 font-medium">
                Psychology & risk
              </div>
              <label class="flex items-center gap-2 mb-2">
                <input
                  id="prep-sleep"
                  type="checkbox"
                  class="rounded border-[#333] bg-black"
                />
                <span class="text-slate-300 text-[12px]"
                  >Slept OK / not exhausted</span
                >
              </label>
              <label class="flex items-center gap-2 mb-2">
                <input
                  id="prep-emotions"
                  type="checkbox"
                  class="rounded border-[#333] bg-black"
                />
                <span class="text-slate-300 text-[12px]"
                  >No revenge / FOMO from earlier</span
                >
              </label>
              <label class="flex items-center gap-2 mb-2">
                <input
                  id="prep-risklimit"
                  type="checkbox"
                  class="rounded border-[#333] bg-black"
                />
                <span class="text-slate-300 text-[12px]"
                  >Within daily/weekly loss limit</span
                >
              </label>
              <label class="block">
                <span class="text-slate-500">Focus for today</span>
                <textarea
                  id="prep-notes"
                  rows="3"
                  class="mt-1 w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-slate-100 text-[12px] focus:outline-none focus:border-slate-400"
                  placeholder="Short note on what to do / avoid today."
                ></textarea>
              </label>
            </div>
          </div>

          <!-- Daily Plan Notes -->
          <div class="mt-6">
            <div class="mb-3">
              <h3 class="text-[13px] font-semibold text-slate-300 mb-1">
                Daily Plan Notes
              </h3>
              <p class="text-[11px] text-slate-500">
                Detailed notes for your daily trading plan.
              </p>
            </div>
            <div class="grid md:grid-cols-2 gap-4 text-[12px]">
              <div
                class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4"
              >
                <label class="block">
                  <span class="text-slate-500 font-medium mb-2 block"
                    >Market Profile</span
                  >
                  <textarea
                    id="prep-market-profile"
                    rows="4"
                    class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-slate-100 text-[12px] focus:outline-none focus:border-slate-400"
                    placeholder="TPO type, value areas, POC, single prints..."
                  ></textarea>
                </label>
              </div>

              <div
                class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4"
              >
                <label class="block">
                  <span class="text-slate-500 font-medium mb-2 block"
                    >Support/Resistance</span
                  >
                  <textarea
                    id="prep-support-resistance"
                    rows="4"
                    class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-slate-100 text-[12px] focus:outline-none focus:border-slate-400"
                    placeholder="Key support and resistance levels, prior highs/lows..."
                  ></textarea>
                </label>
              </div>

              <div
                class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4"
              >
                <label class="block">
                  <span class="text-slate-500 font-medium mb-2 block"
                    >Rolling VWAP</span
                  >
                  <textarea
                    id="prep-vwap"
                    rows="4"
                    class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-slate-100 text-[12px] focus:outline-none focus:border-slate-400"
                    placeholder="VWAP levels, deviations, price action around VWAP..."
                  ></textarea>
                </label>
              </div>

              <div
                class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4"
              >
                <label class="block">
                  <span class="text-slate-500 font-medium mb-2 block"
                    >Daily Narrative</span
                  >
                  <textarea
                    id="prep-narrative"
                    rows="4"
                    class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-slate-100 text-[12px] focus:outline-none focus:border-slate-400"
                    placeholder="What happened yesterday, what to watch today..."
                  ></textarea>
                </label>
              </div>

              <div
                class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4"
              >
                <label class="block">
                  <span class="text-slate-500 font-medium mb-2 block"
                    >LTVW</span
                  >
                  <textarea
                    id="prep-ltvw"
                    rows="4"
                    class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-slate-100 text-[12px] focus:outline-none focus:border-slate-400"
                    placeholder="Long-term volume weighted levels, context..."
                  ></textarea>
                </label>
              </div>

              <div
                class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4"
              >
                <label class="block">
                  <span class="text-slate-500 font-medium mb-2 block"
                    >SUMMARY</span
                  >
                  <textarea
                    id="prep-summary"
                    rows="4"
                    class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-slate-100 text-[12px] focus:outline-none focus:border-slate-400"
                    placeholder="Overall plan summary, key takeaways..."
                  ></textarea>
                </label>
              </div>
            </div>
          </div>

          <!-- Done button -->
          <div class="flex justify-center pt-4">
            <button
              id="btn-daily-prep-done"
              class="px-6 py-3 rounded-xl bg-emerald-600/20 border border-emerald-500/30 text-emerald-400 text-[13px] font-medium hover:bg-emerald-600/30 hover:border-emerald-500/50 active:scale-95 transition-all duration-200 flex items-center gap-2"
            >
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="20 6 9 17 4 12"></polyline>
              </svg>
              Done
            </button>
          </div>
        </div>
      </section>

      <!-- Trade Checklist -->
      <section
        id="checklist"
        data-section-panel="checklist"
        class="py-6 md:py-10 px-4 md:px-8 border-t border-[#101010] bg-[#050505] hidden"
      >
        <div class="max-w-6xl mx-auto space-y-4 md:space-y-8">
          <div class="flex items-center justify-between mb-2">
            <div>
              <h2 class="text-[14px] md:text-[15px] font-semibold">Trade Checklist</h2>
              <p class="text-[11px] md:text-[12px] text-slate-500">
                Score the trade before entry. Only trades that pass here go into
                the journal.
              </p>
            </div>
            <button
              id="btn-open-settings"
              class="px-3 py-2 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-200 hover:bg-black/80 hover:border-slate-400 active:scale-95 transition-all duration-200 whitespace-nowrap flex items-center gap-2"
              title="Configure checklist items"
            >
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
              </svg>
              <span class="hidden md:inline">Settings</span>
            </button>
          </div>

          <!-- New idea + Trade-score -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <!-- New idea -->
            <div
              class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4"
            >
              <div
                class="text-[10px] uppercase tracking-[0.18em] text-slate-500 mb-1"
              >
                N E W &nbsp; I D E A
              </div>
              <div class="text-[13px] font-medium mb-2">
                Instrument & Setup <span class="text-rose-400 text-[11px]">*</span>
              </div>
              <div class="relative mb-2">
                <input
                  id="trade-instrument"
                  class="w-full text-[12px] px-3 py-2 rounded-lg border border-[#222] bg-black text-slate-100 focus:outline-none focus:border-slate-400"
                  placeholder="BTCUSDT ‚Äì intraday long from HTF demand"
                  autocomplete="off"
                />
                <div
                  id="instrument-autocomplete"
                  class="absolute z-50 w-full mt-1 bg-black border border-[#222] rounded-lg shadow-lg max-h-60 overflow-y-auto hidden"
                ></div>
              </div>
              <textarea
                id="trade-notes"
                rows="4"
                class="w-full text-[12px] px-3 py-2 rounded-lg border border-[#222] bg-black text-slate-100 focus:outline-none focus:border-slate-400"
                placeholder="Why now, what liquidity, where are you objectively wrong, what is target."
              ></textarea>
            </div>

            <!-- Trade-score -->
            <div
              class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4 flex flex-col justify-between"
            >
              <div>
                <div
                  class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-black border border-[#262626] mb-3"
                >
                  <span
                    class="w-1.5 h-1.5 rounded-full bg-emerald-400"
                  ></span>
                  <span
                    class="text-[10px] uppercase tracking-[0.18em] text-slate-300"
                  >
                    T R A D E &nbsp; S C O R E
                  </span>
                </div>
                <p
                  id="grade-text"
                  class="text-[13px] text-slate-300 leading-relaxed"
                >
                  Fill the checklist below. You get an objective score (0‚Äì100)
                  and a short summary of strong/weak parts.
                </p>
              </div>
              <div
                class="mt-4 grid grid-cols-3 gap-3 text-center text-[11px]"
              >
                <div
                  class="rounded-xl bg-black border border-[#222] p-3 flex flex-col justify-center"
                >
                  <div class="text-slate-500 text-[11px]">Score</div>
                  <div
                    id="grade-score"
                    class="text-[20px] font-semibold mt-1"
                  >
                    0
                  </div>
                </div>
                <div
                  class="rounded-xl bg-black border border-[#222] p-3 flex flex-col justify-center"
                >
                  <div class="text-slate-500 text-[11px]">Quality</div>
                  <div
                    id="grade-label"
                    class="mt-1 text-[12px] text-slate-200"
                  >
                    Not rated
                  </div>
                </div>
                <div
                  class="rounded-xl bg-black border border-[#222] p-3 flex flex-col justify-center"
                >
                  <div class="text-slate-500 text-[11px]">Allowed?</div>
                  <div
                    id="grade-allowed"
                    class="mt-1 inline-flex items-center justify-center px-2 py-1 rounded-full border text-[10px] grade-badge-low"
                  >
                    Set rules first
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Checklist + summary -->
          <div class="grid md:grid-cols-2 gap-4 text-[12px] mt-6">
            <!-- Checklist -->
            <div class="space-y-4">
              <!-- 1 Market structure -->
              <div
                class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4"
                data-group="ms"
              >
                <div class="flex items-baseline justify-between gap-4 mb-1">
                  <div>
                    <div
                      class="text-[10px] uppercase tracking-[0.18em] text-slate-500"
                    >
                      1. Market structure
                    </div>
                    <div class="text-[13px] font-medium">
                      Trend, structure, liquidity
                    </div>
                  </div>
                </div>
                <p class="text-[11px] text-slate-500 mb-2">
                  HTF + LTF tell the same story and you have a clean
                  invalidation.
                </p>
                <div class="flex flex-col gap-2">
                  <label class="flex items-center gap-2">
                    <input type="checkbox" class="crit" data-weight="2" />
                    <span
                      >HTF direction supports the idea (trend or range
                      play).</span
                    >
                  </label>
                  <label class="flex items-center gap-2">
                    <input type="checkbox" class="crit" data-weight="2" />
                    <span>Clear break of structure / shift in structure.</span>
                  </label>
                  <label class="flex items-center gap-2">
                    <input type="checkbox" class="crit" data-weight="1" />
                    <span
                      >Liquidity was taken (sweep/stop hunt) before your
                      entry.</span
                    >
                  </label>
                  <label class="flex items-center gap-2">
                    <input type="checkbox" class="crit" data-weight="2" />
                    <span
                      >Clear invalidation ‚Äì one level where the idea is dead,
                      not ‚Äúfeeling‚Äù.</span
                    >
                  </label>
                </div>
              </div>

              <!-- 2 Orderflow -->
              <div
                class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4"
                data-group="of"
              >
                <div class="mb-1">
                  <div
                    class="text-[10px] uppercase tracking-[0.18em] text-slate-500"
                  >
                    2. Orderflow
                  </div>
                  <div class="text-[13px] font-medium">
                    Aggression, absorption, delta
                  </div>
                </div>
                <p class="text-[11px] text-slate-500 mb-2">
                  Flow should confirm your idea, not fight it.
                </p>
                <div class="flex flex-col gap-2">
                  <label class="flex items-center gap-2">
                    <input type="checkbox" class="crit" data-weight="2" />
                    <span
                      >Aggressive buyers/sellers in your direction around the
                      level.</span
                    >
                  </label>
                  <label class="flex items-center gap-2">
                    <input type="checkbox" class="crit" data-weight="1" />
                    <span
                      >Absorption / trap on the opposite side where you do not
                      want to be.</span
                    >
                  </label>
                  <label class="flex items-center gap-2">
                    <input type="checkbox" class="crit" data-weight="1" />
                    <span
                      >Delta/CVD makes sense versus price (no clean divergence
                      against you).</span
                    >
                  </label>
                </div>
              </div>

              <!-- 3 TPO/profile -->
              <div
                class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4"
                data-group="tpo"
              >
                <div class="mb-1">
                  <div
                    class="text-[10px] uppercase tracking-[0.18em] text-slate-500"
                  >
                    3. TPO / profile
                  </div>
                  <div class="text-[13px] font-medium">
                    Value, POC, single prints
                  </div>
                </div>
                <p class="text-[11px] text-slate-500 mb-2">
                  Know where you are in the day‚Äôs profile ‚Äì edge comes from
                  context, not one bar.
                </p>
                <div class="flex flex-col gap-2">
                  <label class="flex items-center gap-2">
                    <input type="checkbox" class="crit" data-weight="1" />
                    <span
                      >Setup matches today‚Äôs TPO/volume type
                      (trend/normal/neutral).</span
                    >
                  </label>
                  <label class="flex items-center gap-2">
                    <input type="checkbox" class="crit" data-weight="1" />
                    <span
                      >You know if you are at VAH/VAL/POC or a low‚Äëvolume
                      node.</span
                    >
                  </label>
                  <label class="flex items-center gap-2">
                    <input type="checkbox" class="crit" data-weight="1" />
                    <span>You are not entering randomly mid‚Äëvalue.</span>
                  </label>
                </div>
              </div>

              <!-- 4 PA / orderblocks -->
              <div
                class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4"
                data-group="pa"
              >
                <div class="mb-1">
                  <div
                    class="text-[10px] uppercase tracking-[0.18em] text-slate-500"
                  >
                    4. PA & orderblocks
                  </div>
                  <div class="text-[13px] font-medium">
                    OB, demand/supply, entry
                  </div>
                </div>
                <p class="text-[11px] text-slate-500 mb-2">
                  Clean zones with few tests beat random candles every time.
                </p>
                <div class="flex flex-col gap-2">
                  <label class="flex items-center gap-2">
                    <input type="checkbox" class="crit" data-weight="2" />
                    <span
                      >Fresh orderblock / demand/supply with clear
                      origin.</span
                    >
                  </label>
                  <label class="flex items-center gap-2">
                    <input type="checkbox" class="crit" data-weight="1" />
                    <span>First or second test, not overtested zone.</span>
                  </label>
                  <label class="flex items-center gap-2">
                    <input type="checkbox" class="crit" data-weight="1" />
                    <span
                      >Entry trigger (candle pattern, M1/M5 structure shift,
                      divergence, etc.).</span
                    >
                  </label>
                </div>
              </div>

              <!-- 5 Execution & psychology -->
              <div
                class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4"
                data-group="exec"
              >
                <div class="mb-1">
                  <div
                    class="text-[10px] uppercase tracking-[0.18em] text-slate-500"
                  >
                    5. Execution & psychology
                  </div>
                  <div class="text-[13px] font-medium">
                    R:R, size, headspace
                  </div>
                </div>
                <p class="text-[11px] text-slate-500 mb-2">
                  This is where most nonsense stops if you are honest. Good
                  journals weight this heavily.
                </p>
                <div class="flex flex-col gap-2">
                  <label class="flex items-center gap-2">
                    <input type="checkbox" class="crit" data-weight="2" />
                    <span>Defined SL and realistic 2R/3R target.</span>
                  </label>
                  <label class="flex items-center gap-2">
                    <input type="checkbox" class="crit" data-weight="2" />
                    <span>Position size in line with plan (risk %).</span>
                  </label>
                  <label class="flex items-center gap-2">
                    <input type="checkbox" class="crit" data-weight="2" />
                    <span
                      >Not a revenge / FOMO / boredom trade (brutal
                      honesty).</span
                    >
                  </label>
                </div>
              </div>
            </div>

            <!-- Summary & plan / after-note -->
            <div class="space-y-4">
              <div
                class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4"
              >
                <div
                  class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-black border border-[#262626] mb-3"
                >
                  <span
                    class="w-1.5 h-1.5 rounded-full bg-emerald-400"
                  ></span>
                  <span
                    class="text-[10px] uppercase tracking-[0.18em] text-slate-300"
                  >
                    Summary
                  </span>
                </div>
                <p
                  id="summary-text"
                  class="text-[12px] text-slate-300 leading-relaxed whitespace-pre-line"
                >
                  When you tick the checklist, you get a short text here about
                  what is strong and weak in the setup.
                </p>
              </div>

              <div
                class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4"
              >
                <div class="flex items-center justify-between mb-2">
                  <div class="text-[13px] font-medium">Trade plan</div>
                  <button
                    id="btn-configure-trade-plan"
                    class="px-2 py-1 rounded-lg bg-black/60 border border-[#262626] text-[10px] text-slate-300 hover:bg-black/80"
                    title="Configure visible parameters"
                  >
                    Configure
                  </button>
                </div>
                <div class="mb-2" data-param="category">
                  <div class="flex items-center justify-between mb-1">
                    <label class="block text-[11px] text-slate-400">Category</label>
                    <div id="account-balance-display" class="text-[11px] hidden"></div>
                  </div>
                  <select
                    id="plan-account"
                    class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
                  >
                    <option value="">Select category...</option>
                  </select>
                </div>
                <div class="mb-2" data-param="direction">
                  <label class="block text-[11px] text-slate-400 mb-1">Direction <span class="text-rose-400">*</span></label>
                  <div class="flex gap-2">
                    <button
                      id="btn-direction-long"
                      type="button"
                      class="flex-1 px-3 py-2 rounded-lg border border-emerald-500/30 bg-black/40 text-[11px] text-slate-400 hover:bg-emerald-500/10 hover:text-emerald-300 transition-colors flex items-center justify-center gap-1.5"
                      data-direction="long"
                    >
                      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="12" y1="19" x2="12" y2="5"></line>
                        <polyline points="5 12 12 5 19 12"></polyline>
                      </svg>
                      Long
                    </button>
                    <button
                      id="btn-direction-short"
                      type="button"
                      class="flex-1 px-3 py-2 rounded-lg border border-rose-500/30 bg-black/40 text-[11px] text-slate-400 hover:bg-rose-500/10 hover:text-rose-300 transition-colors flex items-center justify-center gap-1.5"
                      data-direction="short"
                    >
                      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <polyline points="19 12 12 19 5 12"></polyline>
                      </svg>
                      Short
                    </button>
                  </div>
                </div>
                <div class="grid grid-cols-3 gap-2 mb-2" data-param="entry-sl-tp">
                  <input
                    id="plan-entry"
                    data-param="entry"
                    class="px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] focus:outline-none focus:border-slate-400"
                    placeholder="Entry"
                  />
                  <input
                    id="plan-sl"
                    data-param="sl"
                    class="px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] focus:outline-none focus:border-slate-400"
                    placeholder="SL"
                  />
                  <input
                    id="plan-tp"
                    data-param="tp"
                    class="px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] focus:outline-none focus:border-slate-400"
                    placeholder="TP / target"
                  />
                </div>
                <div class="grid grid-cols-2 gap-2 mb-2">
                  <div data-param="leverage">
                    <label class="block text-[11px] text-slate-400 mb-1">Leverage</label>
                    <input
                      id="plan-leverage"
                      type="text"
                      value="1"
                      class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
                      placeholder="1:100"
                    />
                  </div>
                  <div data-param="lots">
                    <label class="block text-[11px] text-slate-400 mb-1">Lots</label>
                    <input
                      id="plan-lots"
                      type="number"
                      step="0.01"
                      min="0"
                      class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
                      placeholder="0.01"
                    />
                  </div>
                </div>
                <div class="mb-2" data-param="size">
                  <div class="flex items-center justify-between mb-1">
                    <label class="block text-[11px] text-slate-400">Position Size ($)</label>
                    <span id="margin-display" class="text-[10px] text-slate-500"></span>
                  </div>
                  <input
                    id="plan-size"
                    type="number"
                    step="0.01"
                    min="0"
                    value="1000"
                    class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
                    placeholder="1000.00"
                  />
                </div>
                <div class="mt-4 pt-3 border-t border-[#222]" data-param="result">
                  <label class="block text-[12px] font-medium text-slate-300 mb-1">Log Trade</label>
                  <p class="text-[10px] text-slate-500 mb-3">Click to save trade to journal</p>
                  <div class="flex gap-3">
                    <button
                      id="btn-trade-win"
                      type="button"
                      class="flex-1 px-4 py-3 rounded-xl border-2 border-emerald-500/40 bg-emerald-500/15 text-[12px] font-medium text-emerald-300 hover:bg-emerald-500/25 hover:border-emerald-500/60 active:scale-95 transition-all flex items-center justify-center gap-2"
                    >
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="20 6 9 17 4 12"></polyline>
                      </svg>
                      Win
                    </button>
                    <button
                      id="btn-trade-loss"
                      type="button"
                      class="flex-1 px-4 py-3 rounded-xl border-2 border-rose-500/40 bg-rose-500/15 text-[12px] font-medium text-rose-300 hover:bg-rose-500/25 hover:border-rose-500/60 active:scale-95 transition-all flex items-center justify-center gap-2"
                    >
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                      </svg>
                      Loss
                    </button>
                  </div>
                </div>
                <div class="mb-2" data-param="pnl">
                  <label class="block text-[11px] text-slate-400 mb-1">P&L ($)</label>
                  <input
                    id="plan-pnl"
                    type="number"
                    step="0.01"
                    class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
                    placeholder="0.00"
                    readonly
                  />
                </div>
                <textarea
                  id="plan-notes"
                  data-param="notes"
                  rows="3"
                  class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
                  placeholder="Extra rules: partials, scaling, one entry only, etc."
                ></textarea>
              </div>

              <div
                class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4"
              >
                <div class="text-[13px] font-medium mb-2">
                  Journal note (after)
                </div>
                <textarea
                  id="journal-notes"
                  rows="4"
                  class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
                  placeholder="What happened, what you did well/poorly, what you learned."
                ></textarea>
              </div>

              <!-- Setup Selector -->
              <div
                class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4"
              >
                <div class="flex items-center justify-between mb-2">
                  <div class="text-[13px] font-medium">Setup from Playbook</div>
                  <a href="#" data-section-nav="playbook" class="text-[10px] text-emerald-400 hover:text-emerald-300">+ New Setup</a>
                </div>
                <select
                  id="trade-setup-select"
                  class="w-full px-3 py-2.5 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
                >
                  <option value="">No setup selected</option>
                  <!-- Populated by JavaScript -->
                </select>
                <!-- Compact setup preview badge -->
                <div id="selected-setup-preview" class="hidden mt-2 flex items-center gap-2 flex-wrap">
                  <span class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full bg-blue-500/10 border border-blue-500/20">
                    <span class="w-1.5 h-1.5 rounded-full bg-blue-400"></span>
                    <span id="setup-preview-name" class="text-[10px] font-medium text-blue-300"></span>
                  </span>
                  <span id="setup-preview-winrate" class="text-[10px] text-emerald-400"></span>
                  <span id="setup-preview-desc" class="hidden"></span>
                </div>
              </div>
            </div>
          </div>

          <!-- Done button -->
          <div class="flex justify-center pt-4">
            <button
              id="btn-checklist-done"
              class="px-6 py-3 rounded-xl bg-emerald-600/20 border border-emerald-500/30 text-emerald-400 text-[13px] font-medium hover:bg-emerald-600/30 hover:border-emerald-500/50 active:scale-95 transition-all duration-200 flex items-center gap-2"
            >
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="20 6 9 17 4 12"></polyline>
              </svg>
              Done
            </button>
          </div>
        </div>
      </section>

      <!-- Journal & routines ‚Äì Notion style -->
      <section
        id="journal"
        data-section-panel="journal"
        class="py-6 md:py-10 px-4 md:px-8 border-t border-[#101010] bg-[#050505] hidden"
      >
        <div class="max-w-5xl mx-auto">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-[15px] font-semibold">Journal & routines</h2>
            <button
              id="btn-edit-parameters"
              class="px-3 py-1.5 rounded-lg bg-black/60 border border-[#262626] text-[11px] text-slate-200 hover:bg-black"
            >
              Edit parameters
            </button>
          </div>

          <div class="grid md:grid-cols-2 gap-6 text-[12px]">
            <!-- routine level check -->
            <div class="rounded-3xl notion-panel border p-5">
              <div class="flex items-center gap-2 mb-3">
                <span class="text-[18px]">üìä</span>
                <h3
                  class="text-[13px] font-semibold underline underline-offset-4"
                >
                  routine level check
                </h3>
              </div>
              <div id="routine-list" class="space-y-2 text-slate-200"></div>
            </div>

            <!-- Levels + trade journal -->
            <div class="space-y-4">
              <!-- levels to be trading -->
              <div class="rounded-3xl notion-panel border p-5">
                <div class="flex items-center gap-2 mb-3">
                  <span class="text-[18px]">üìà</span>
                  <h3
                    class="text-[13px] font-semibold underline underline-offset-4"
                  >
                    levels to be trading
                  </h3>
                </div>
                <div class="space-y-2 text-slate-100">
                  <div>
                    <span class="text-[11px] text-emerald-300">support :</span>
                    <input
                      id="journal-support"
                      class="mt-1 w-full px-3 py-2 rounded-lg border border-[#161616] bg-black text-[12px] focus:outline-none focus:border-slate-400"
                      placeholder="areas / levels you want to trade from"
                    />
                  </div>
                  <div>
                    <span class="text-[11px] text-rose-300">resistance :</span>
                    <input
                      id="journal-resistance"
                      class="mt-1 w-full px-3 py-2 rounded-lg border border-[#161616] bg-black text-[12px] focus:outline-none focus:border-slate-400"
                      placeholder="areas / levels you want to fade/short"
                    />
                  </div>
                  <div>
                    <span class="text-[11px] text-slate-300">other notes -</span>
                    <textarea
                      id="journal-other"
                      rows="3"
                      class="mt-1 w-full px-3 py-2 rounded-lg border border-[#161616] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
                      placeholder="plan, session bias, extra comments"
                    ></textarea>
                  </div>
                </div>
              </div>

            </div>
          </div>

        </div>
      </section>

      <!-- Monte Carlo Simulation -->
      <section
        id="montecarlo"
        data-section-panel="montecarlo"
        class="py-6 md:py-10 px-4 md:px-8 border-t border-[#101010] bg-[#050505] hidden"
      >
        <div class="max-w-5xl mx-auto">
          <div class="flex items-start justify-between mb-4">
            <h2 class="text-[15px] font-semibold">Monte Carlo simulation</h2>
            <!-- Widget Settings -->
            <div class="widget-settings-container">
              <button class="widget-settings-btn" data-settings-toggle="montecarlo" title="Show/Hide Widgets">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="3"></circle>
                  <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                </svg>
              </button>
              <div class="widget-settings-dropdown" data-settings-dropdown="montecarlo">
                <div class="widget-settings-header">
                  <span>Show/Hide Widgets</span>
                </div>
                <div class="widget-settings-item">
                  <label for="widget-mc-params">Parameters</label>
                  <div class="toggle-switch">
                    <input type="checkbox" id="widget-mc-params" data-widget="montecarlo-params" checked>
                    <span class="toggle-slider"></span>
                  </div>
                </div>
                <div class="widget-settings-item">
                  <label for="widget-mc-results">Results Chart</label>
                  <div class="toggle-switch">
                    <input type="checkbox" id="widget-mc-results" data-widget="montecarlo-results" checked>
                    <span class="toggle-slider"></span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 text-[12px]">
            <!-- Inputs -->
            <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4 md:p-5" data-widget-id="montecarlo-params">
              <div class="text-[13px] font-semibold mb-3">
                Parameters (per trade)
              </div>
              <div class="space-y-3 text-slate-100">
                <div>
                  <label class="block text-[11px] text-slate-400 mb-1"
                    >Win rate %</label
                  >
                  <input
                    id="mc-winrate"
                    type="number"
                    min="0"
                    max="100"
                    value="45"
                    class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] focus:outline-none focus:border-slate-400"
                  />
                </div>
                <div>
                  <label class="block text-[11px] text-slate-400 mb-1"
                    >Reward : Risk (R multiple)</label
                  >
                  <input
                    id="mc-rmultiple"
                    type="number"
                    step="0.1"
                    min="0"
                    value="2.0"
                    class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] focus:outline-none focus:border-slate-400"
                  />
                </div>
                <div class="grid grid-cols-2 gap-3">
                  <div>
                    <label class="block text-[11px] text-slate-400 mb-1"
                      >Risk per trade %</label
                    >
                    <input
                      id="mc-riskpct"
                      type="number"
                      step="0.1"
                      min="0"
                      value="1.0"
                      class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] focus:outline-none focus:border-slate-400"
                    />
                  </div>
                  <div>
                    <label class="block text-[11px] text-slate-400 mb-1"
                      >Starting Balance $</label
                    >
                    <input
                      id="mc-balance"
                      type="number"
                      step="100"
                      min="0"
                      value="10000"
                      class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] focus:outline-none focus:border-slate-400"
                    />
                  </div>
                </div>
                <div class="grid grid-cols-2 gap-3">
                  <div>
                    <label class="block text-[11px] text-slate-400 mb-1"
                      >Number of trades</label
                    >
                    <input
                      id="mc-trades"
                      type="number"
                      min="1"
                      value="200"
                      class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] focus:outline-none focus:border-slate-400"
                    />
                  </div>
                  <div>
                    <label class="block text-[11px] text-slate-400 mb-1"
                      >Simulations</label
                    >
                    <input
                      id="mc-runs"
                      type="number"
                      min="100"
                      value="1000"
                      class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] focus:outline-none focus:border-slate-400"
                    />
                  </div>
                </div>

                <button
                  id="mc-run"
                  class="mt-2 w-full px-4 py-2 rounded-xl bg-emerald-500 text-[12px] font-medium text-black hover:bg-emerald-400 transition-colors"
                >
                  Run simulation
                </button>
                <p id="mc-status" class="text-[11px] text-slate-500 mt-1">
                  Uses random sequences of wins and losses to estimate equity
                  paths and drawdowns.
                </p>
              </div>
            </div>

            <!-- Output -->
            <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-5" data-widget-id="montecarlo-results">
              <div class="text-[13px] font-semibold mb-3">
                Results
              </div>
              <div
                class="grid grid-cols-2 gap-3 text-[11px] text-slate-300 mb-4"
              >
                <div>
                  <div class="text-slate-500">Median final balance</div>
                  <div id="mc-median" class="text-[13px] mt-1">‚Äì</div>
                </div>
                <div>
                  <div class="text-slate-500">Worst case (5th pct)</div>
                  <div id="mc-p5" class="text-[13px] mt-1">‚Äì</div>
                </div>
                <div>
                  <div class="text-slate-500">Best case (95th pct)</div>
                  <div id="mc-p95" class="text-[13px] mt-1">‚Äì</div>
                </div>
                <div>
                  <div class="text-slate-500">Median max drawdown</div>
                  <div id="mc-dd" class="text-[13px] mt-1">‚Äì</div>
                </div>
              </div>

              <div class="text-[11px] text-slate-400 mb-2">
                Sample equity path (one random simulation):
              </div>
              <div
                id="mc-path"
                class="h-40 w-full rounded-xl bg-black/60 border border-[#262626] overflow-hidden relative"
              >
                <canvas id="mc-canvas" class="w-full h-full"></canvas>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Finance / Perplexity -->
      <section
        id="finance"
        data-section-panel="finance"
        class="py-6 md:py-10 px-4 md:px-8 border-t border-[#101010] bg-[#050505] hidden"
      >
        <div class="max-w-6xl mx-auto space-y-6">
          <div class="flex items-start justify-between">
            <div>
              <h2 class="text-[15px] font-semibold mb-1">Finance & Risk</h2>
              <p class="text-[12px] text-slate-500">
                Risk management tools and external market analysis.
              </p>
            </div>
            <!-- Widget Settings -->
            <div class="widget-settings-container">
              <button class="widget-settings-btn" data-settings-toggle="finance" title="Show/Hide Widgets">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="3"></circle>
                  <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                </svg>
              </button>
              <div class="widget-settings-dropdown" data-settings-dropdown="finance">
                <div class="widget-settings-header">
                  <span>Show/Hide Widgets</span>
                </div>
                <div class="widget-settings-item">
                  <label for="widget-finance-howto">How it Works</label>
                  <div class="toggle-switch">
                    <input type="checkbox" id="widget-finance-howto" data-widget="finance-howto" checked>
                    <span class="toggle-slider"></span>
                  </div>
                </div>
                <div class="widget-settings-item">
                  <label for="widget-finance-risk">Risk Management</label>
                  <div class="toggle-switch">
                    <input type="checkbox" id="widget-finance-risk" data-widget="finance-risk-management" checked>
                    <span class="toggle-slider"></span>
                  </div>
                </div>
                <div class="widget-settings-item">
                  <label for="widget-finance-goals">Goals & Targets</label>
                  <div class="toggle-switch">
                    <input type="checkbox" id="widget-finance-goals" data-widget="finance-goals" checked>
                    <span class="toggle-slider"></span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- How Risk Management Works -->
          <div class="rounded-2xl bg-gradient-to-br from-[#0a0a0a] to-[#080808] border border-[#161616] p-5 mb-4" data-widget-id="finance-howto">
            <h3 class="text-[13px] font-semibold text-slate-200 mb-4">How it Works</h3>
            <div class="grid md:grid-cols-3 gap-4">
              <!-- Step 1 -->
              <div class="flex gap-3">
                <div class="w-8 h-8 rounded-lg bg-emerald-500/20 border border-emerald-500/30 flex items-center justify-center flex-shrink-0">
                  <span class="text-[12px] font-bold text-emerald-400">1</span>
                </div>
                <div>
                  <h4 class="text-[11px] font-semibold text-slate-200 mb-0.5">Select Account</h4>
                  <p class="text-[10px] text-slate-400 leading-relaxed">Choose your trading account. Balance auto-fills for all calculations.</p>
                </div>
              </div>
              <!-- Step 2 -->
              <div class="flex gap-3">
                <div class="w-8 h-8 rounded-lg bg-blue-500/20 border border-blue-500/30 flex items-center justify-center flex-shrink-0">
                  <span class="text-[12px] font-bold text-blue-400">2</span>
                </div>
                <div>
                  <h4 class="text-[11px] font-semibold text-slate-200 mb-0.5">Enter Trade Details</h4>
                  <p class="text-[10px] text-slate-400 leading-relaxed">Set risk %, entry price, stop loss, and daily limit. Results update live.</p>
                </div>
              </div>
              <!-- Step 3 -->
              <div class="flex gap-3">
                <div class="w-8 h-8 rounded-lg bg-amber-500/20 border border-amber-500/30 flex items-center justify-center flex-shrink-0">
                  <span class="text-[12px] font-bold text-amber-400">3</span>
                </div>
                <div>
                  <h4 class="text-[11px] font-semibold text-slate-200 mb-0.5">Monitor Risk</h4>
                  <p class="text-[10px] text-slate-400 leading-relaxed">Track drawdown and daily P&L. Stop trading if daily limit is reached.</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Risk Management Tools - All in One Card -->
          <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-5" data-widget-id="finance-risk-management">
            <!-- Header with Account Selector -->
            <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-5 pb-5 border-b border-[#1a1a1a]">
              <div>
                <h3 class="text-[15px] font-semibold text-slate-200 mb-1">Risk Management</h3>
                <p class="text-[11px] text-slate-400">Select account to calculate position size, track drawdown & daily limits</p>
              </div>
              <div class="flex items-center gap-3">
                <select id="risk-account-select" class="px-3 py-2 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-200 focus:outline-none focus:border-emerald-500/50 min-w-[180px]">
                  <option value="">Select account...</option>
                </select>
                <div class="text-right">
                  <div class="text-[10px] text-slate-500">Balance</div>
                  <div id="risk-balance-display" class="text-[14px] font-semibold text-emerald-400">$0</div>
                </div>
              </div>
            </div>

            <!-- Position Size Calculator -->
            <div class="mb-5">
              <div class="flex items-center justify-between mb-3">
                <div class="flex items-center gap-2">
                  <div class="w-6 h-6 rounded-md bg-emerald-500/20 flex items-center justify-center">
                    <span class="text-[11px] font-bold text-emerald-400">1</span>
                  </div>
                  <h4 class="text-[12px] font-semibold text-slate-300">Position Size Calculator</h4>
                </div>
                <select id="instrument-type" class="px-2 py-1 rounded-lg bg-black/60 border border-[#262626] text-[10px] text-slate-300 focus:outline-none focus:border-emerald-500/50">
                  <option value="crypto">Crypto (% based)</option>
                  <option value="forex">Forex (Pips)</option>
                  <option value="futures">Futures (Ticks)</option>
                  <option value="stocks">Stocks (Shares)</option>
                </select>
              </div>
              
              <div class="grid grid-cols-5 gap-3 mb-3">
                <div>
                  <label class="block text-[10px] text-slate-500 mb-1">Risk %</label>
                  <input type="number" id="risk-percent" class="w-full px-2 py-2 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-200 focus:outline-none focus:border-emerald-500/50" placeholder="1" value="1" step="0.1" />
                </div>
                <div>
                  <label class="block text-[10px] text-slate-500 mb-1">Entry Price</label>
                  <input type="number" id="risk-entry" class="w-full px-2 py-2 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-200 focus:outline-none focus:border-emerald-500/50" placeholder="100" step="any" />
                </div>
                <div>
                  <label class="block text-[10px] text-slate-500 mb-1">Stop Loss</label>
                  <input type="number" id="risk-sl" class="w-full px-2 py-2 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-200 focus:outline-none focus:border-emerald-500/50" placeholder="95" step="any" />
                </div>
                <div>
                  <label class="block text-[10px] text-slate-500 mb-1">Take Profit</label>
                  <input type="number" id="risk-tp" class="w-full px-2 py-2 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-200 focus:outline-none focus:border-emerald-500/50" placeholder="110" step="any" />
                </div>
                <div>
                  <label class="block text-[10px] text-slate-500 mb-1">Daily Limit %</label>
                  <input type="number" id="daily-loss-limit-percent" class="w-full px-2 py-2 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-200 focus:outline-none focus:border-amber-500/50" placeholder="2" step="0.1" />
                </div>
              </div>

              <!-- Forex/Futures specific inputs (hidden by default) -->
              <div id="forex-inputs" class="hidden grid grid-cols-3 gap-3 mb-3">
                <div>
                  <label class="block text-[10px] text-slate-500 mb-1">Pip Value ($)</label>
                  <input type="number" id="pip-value" class="w-full px-2 py-2 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-200 focus:outline-none focus:border-emerald-500/50" placeholder="10" value="10" step="0.01" />
                </div>
                <div>
                  <label class="block text-[10px] text-slate-500 mb-1">SL Pips</label>
                  <input type="number" id="sl-pips" class="w-full px-2 py-2 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-200 focus:outline-none focus:border-emerald-500/50" placeholder="20" step="0.1" />
                </div>
                <div>
                  <label class="block text-[10px] text-slate-500 mb-1">Lot Size</label>
                  <input type="number" id="lot-size" class="w-full px-2 py-2 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-200 focus:outline-none focus:border-emerald-500/50" placeholder="100000" value="100000" />
                </div>
              </div>

              <div id="futures-inputs" class="hidden grid grid-cols-3 gap-3 mb-3">
                <div>
                  <label class="block text-[10px] text-slate-500 mb-1">Tick Value ($)</label>
                  <input type="number" id="tick-value" class="w-full px-2 py-2 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-200 focus:outline-none focus:border-emerald-500/50" placeholder="12.50" value="12.50" step="0.01" />
                </div>
                <div>
                  <label class="block text-[10px] text-slate-500 mb-1">Tick Size</label>
                  <input type="number" id="tick-size" class="w-full px-2 py-2 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-200 focus:outline-none focus:border-emerald-500/50" placeholder="0.25" value="0.25" step="0.01" />
                </div>
                <div>
                  <label class="block text-[10px] text-slate-500 mb-1">Contract Size</label>
                  <input type="number" id="contract-size" class="w-full px-2 py-2 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-200 focus:outline-none focus:border-emerald-500/50" placeholder="1" value="1" />
                </div>
              </div>

              <!-- Results Row -->
              <div class="grid grid-cols-5 gap-3" id="position-size-results">
                <div class="rounded-xl bg-emerald-500/10 border border-emerald-500/20 p-3 text-center cursor-pointer hover:bg-emerald-500/20 transition-colors group" data-copy="position-size">
                  <div class="text-[9px] text-slate-400 mb-0.5">Position Size</div>
                  <div id="result-position-size" class="text-[15px] font-bold text-emerald-300">$0</div>
                  <div class="text-[8px] text-emerald-500 opacity-0 group-hover:opacity-100 transition-opacity">Click to copy</div>
                </div>
                <div class="rounded-xl bg-blue-500/10 border border-blue-500/20 p-3 text-center cursor-pointer hover:bg-blue-500/20 transition-colors group" data-copy="units">
                  <div class="text-[9px] text-slate-400 mb-0.5" id="units-label">Units</div>
                  <div id="result-units" class="text-[15px] font-bold text-blue-300">0</div>
                  <div class="text-[8px] text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity">Click to copy</div>
                </div>
                <div class="rounded-xl bg-amber-500/10 border border-amber-500/20 p-3 text-center">
                  <div class="text-[9px] text-slate-400 mb-0.5">Risk Amount</div>
                  <div id="result-risk-amount" class="text-[15px] font-bold text-amber-300">$0</div>
                </div>
                <div class="rounded-xl bg-purple-500/10 border border-purple-500/20 p-3 text-center">
                  <div class="text-[9px] text-slate-400 mb-0.5">R:R Ratio</div>
                  <div id="result-rr-ratio" class="text-[15px] font-bold text-purple-300">0:0</div>
                </div>
                <div class="rounded-xl bg-rose-500/10 border border-rose-500/20 p-3 text-center">
                  <div class="text-[9px] text-slate-400 mb-0.5">Daily Limit</div>
                  <div id="daily-loss-limit-display" class="text-[15px] font-bold text-rose-300">$0</div>
                </div>
              </div>
              
              <!-- Risk Indicator Bar -->
              <div class="mt-3 p-2 rounded-lg bg-black/40 border border-[#262626]">
                <div class="flex items-center justify-between mb-1">
                  <span class="text-[9px] text-slate-500">Risk Level</span>
                  <span id="risk-level-text" class="text-[9px] text-emerald-400">Conservative</span>
                </div>
                <div class="h-1.5 rounded-full bg-black/60 overflow-hidden">
                  <div id="risk-level-bar" class="h-full bg-emerald-500 transition-all duration-300" style="width: 10%"></div>
                </div>
              </div>
              
              <!-- Hidden field for balance -->
              <input type="hidden" id="risk-balance" value="" />
              <input type="hidden" id="daily-loss-limit" value="" />
            </div>

            <!-- Drawdown & Daily Status -->
            <div class="grid md:grid-cols-2 gap-4 pt-5 border-t border-[#1a1a1a]">
              <!-- Drawdown Tracker -->
              <div>
                <div class="flex items-center gap-2 mb-3">
                  <div class="w-6 h-6 rounded-md bg-blue-500/20 flex items-center justify-center">
                    <span class="text-[11px] font-bold text-blue-400">2</span>
                  </div>
                  <h4 class="text-[12px] font-semibold text-slate-300">Drawdown</h4>
                </div>
                <div id="drawdown-tracker-content">
                  <div class="grid grid-cols-2 gap-2 mb-2">
                    <div class="rounded-lg bg-black/40 border border-[#262626] p-2.5 text-center">
                      <div class="text-[9px] text-slate-500 mb-0.5">Current</div>
                      <div id="current-drawdown" class="text-[14px] font-bold text-slate-200">0%</div>
                    </div>
                    <div class="rounded-lg bg-black/40 border border-[#262626] p-2.5 text-center">
                      <div class="text-[9px] text-slate-500 mb-0.5">Max</div>
                      <div id="max-drawdown" class="text-[14px] font-bold text-slate-200">0%</div>
                    </div>
                  </div>
                  <div class="flex justify-between text-[10px] mb-1.5">
                    <span class="text-slate-500">Peak: <span id="peak-balance" class="text-emerald-400">$0</span></span>
                    <span class="text-slate-500">Now: <span id="current-balance" class="text-slate-300">$0</span></span>
                  </div>
                  <div class="h-1.5 rounded-full bg-black/40 border border-[#262626] overflow-hidden">
                    <div id="drawdown-bar" class="h-full bg-emerald-500 transition-all duration-300" style="width: 0%"></div>
                  </div>
                  <div class="text-[9px] text-right mt-1">
                    <span id="drawdown-level-text" class="text-emerald-400">Safe</span>
                  </div>
                </div>
                <div id="drawdown-empty" class="text-[10px] text-slate-500 text-center py-3 hidden">
                  ‚Üê Select account
                </div>
              </div>

              <!-- Daily Loss Status -->
              <div>
                <div class="flex items-center gap-2 mb-3">
                  <div class="w-6 h-6 rounded-md bg-amber-500/20 flex items-center justify-center">
                    <span class="text-[11px] font-bold text-amber-400">3</span>
                  </div>
                  <h4 class="text-[12px] font-semibold text-slate-300">Daily Loss Limit</h4>
                </div>
                
                <!-- Set Limit Input -->
                <div class="mb-3 p-2.5 rounded-lg bg-black/30 border border-[#1a1a1a]">
                  <div class="text-[9px] text-slate-500 mb-1.5">Set your daily max loss</div>
                  <div class="flex gap-2">
                    <div class="flex-1 relative">
                      <span class="absolute left-2 top-1/2 -translate-y-1/2 text-[11px] text-slate-500">$</span>
                      <input type="number" id="daily-loss-limit-dollar" class="w-full pl-5 pr-2 py-1.5 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-200 focus:outline-none focus:border-amber-500/50" placeholder="100" step="1" />
                    </div>
                    <span class="text-[10px] text-slate-600 self-center">or</span>
                    <div class="flex-1 relative">
                      <input type="number" id="daily-loss-limit-percent-input" class="w-full pl-2 pr-5 py-1.5 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-200 focus:outline-none focus:border-amber-500/50" placeholder="2" step="0.1" />
                      <span class="absolute right-2 top-1/2 -translate-y-1/2 text-[11px] text-slate-500">%</span>
                    </div>
                  </div>
                  <div class="text-[9px] text-slate-600 mt-1.5">üí° % calculated from selected account balance</div>
                </div>
                
                <div id="daily-loss-tracker-content">
                  <div class="grid grid-cols-3 gap-2 mb-2">
                    <div class="rounded-lg bg-black/40 border border-[#262626] p-2.5 text-center">
                      <div class="text-[9px] text-slate-500">Today</div>
                      <div id="today-pnl" class="text-[14px] font-bold text-slate-200">$0</div>
                    </div>
                    <div class="rounded-lg bg-black/40 border border-[#262626] p-2.5 text-center">
                      <div class="text-[9px] text-slate-500">Left</div>
                      <div id="remaining-loss" class="text-[14px] font-bold text-emerald-400">$0</div>
                    </div>
                    <div class="rounded-lg bg-black/40 border border-[#262626] p-2.5 text-center">
                      <div class="text-[9px] text-slate-500">Status</div>
                      <div id="loss-limit-status" class="text-[14px] font-bold text-emerald-400">OK</div>
                    </div>
                  </div>
                  <div class="h-1.5 rounded-full bg-black/40 border border-[#262626] overflow-hidden">
                    <div id="loss-limit-bar" class="h-full bg-emerald-500 transition-all duration-300" style="width: 0%"></div>
                  </div>
                  <div class="text-[9px] text-right mt-1">
                    <span id="loss-progress-text" class="text-slate-500">0%</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Goals & Targets - Inline Editable -->
          <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-5" data-widget-id="finance-goals">
            <div class="flex items-center justify-between mb-4">
              <div>
                <h3 class="text-[14px] font-semibold text-slate-200 mb-1">Goals & Targets</h3>
                <p class="text-[11px] text-slate-400">Set targets and track progress in real-time</p>
              </div>
              <button
                id="btn-reset-goals"
                class="px-2 py-1 rounded-lg text-[10px] text-slate-500 hover:text-rose-400 transition-colors"
                title="Reset all goals"
              >
                Reset
              </button>
            </div>

            <!-- Goals Grid - Inline Editable -->
            <div class="grid md:grid-cols-2 gap-4">
              <!-- Monthly P&L Target -->
              <div class="rounded-xl bg-black/40 border border-[#262626] p-4">
                <div class="flex items-center justify-between mb-3">
                  <span class="text-[11px] text-slate-400">Monthly P&L Target</span>
                  <div class="flex items-center gap-1">
                    <span class="text-[10px] text-slate-500">$</span>
                    <input type="number" id="goal-monthly-pnl" class="w-16 px-1.5 py-1 rounded bg-black/60 border border-[#333] text-[11px] text-slate-200 text-right focus:outline-none focus:border-emerald-500/50" placeholder="500" />
                  </div>
                </div>
                <div class="h-2 rounded-full bg-black/60 border border-[#1a1a1a] overflow-hidden mb-2">
                  <div id="goal-monthly-bar" class="h-full bg-emerald-500 transition-all duration-500" style="width: 0%"></div>
                </div>
                <div class="flex items-center justify-between">
                  <span id="goal-monthly-current" class="text-[12px] font-semibold text-slate-200">$0</span>
                  <span id="goal-monthly-status" class="text-[9px] text-slate-500">No target set</span>
                </div>
              </div>

              <!-- Weekly P&L Target -->
              <div class="rounded-xl bg-black/40 border border-[#262626] p-4">
                <div class="flex items-center justify-between mb-3">
                  <span class="text-[11px] text-slate-400">Weekly P&L Target</span>
                  <div class="flex items-center gap-1">
                    <span class="text-[10px] text-slate-500">$</span>
                    <input type="number" id="goal-weekly-pnl" class="w-16 px-1.5 py-1 rounded bg-black/60 border border-[#333] text-[11px] text-slate-200 text-right focus:outline-none focus:border-emerald-500/50" placeholder="125" />
                  </div>
                </div>
                <div class="h-2 rounded-full bg-black/60 border border-[#1a1a1a] overflow-hidden mb-2">
                  <div id="goal-weekly-bar" class="h-full bg-blue-500 transition-all duration-500" style="width: 0%"></div>
                </div>
                <div class="flex items-center justify-between">
                  <span id="goal-weekly-current" class="text-[12px] font-semibold text-slate-200">$0</span>
                  <span id="goal-weekly-status" class="text-[9px] text-slate-500">No target set</span>
                </div>
              </div>

              <!-- Win Rate Target -->
              <div class="rounded-xl bg-black/40 border border-[#262626] p-4">
                <div class="flex items-center justify-between mb-3">
                  <span class="text-[11px] text-slate-400">Win Rate Target</span>
                  <div class="flex items-center gap-1">
                    <input type="number" id="goal-win-rate" class="w-12 px-1.5 py-1 rounded bg-black/60 border border-[#333] text-[11px] text-slate-200 text-right focus:outline-none focus:border-emerald-500/50" placeholder="55" min="0" max="100" />
                    <span class="text-[10px] text-slate-500">%</span>
                  </div>
                </div>
                <div class="h-2 rounded-full bg-black/60 border border-[#1a1a1a] overflow-hidden mb-2">
                  <div id="goal-winrate-bar" class="h-full bg-purple-500 transition-all duration-500" style="width: 0%"></div>
                </div>
                <div class="flex items-center justify-between">
                  <span id="goal-winrate-current" class="text-[12px] font-semibold text-slate-200">0%</span>
                  <span id="goal-winrate-status" class="text-[9px] text-slate-500">No target set</span>
                </div>
              </div>

              <!-- Max Trades Per Day -->
              <div class="rounded-xl bg-black/40 border border-[#262626] p-4">
                <div class="flex items-center justify-between mb-3">
                  <span class="text-[11px] text-slate-400">Max Trades Today</span>
                  <div class="flex items-center gap-1">
                    <input type="number" id="goal-max-trades" class="w-12 px-1.5 py-1 rounded bg-black/60 border border-[#333] text-[11px] text-slate-200 text-right focus:outline-none focus:border-amber-500/50" placeholder="5" min="1" />
                    <span class="text-[10px] text-slate-500">max</span>
                  </div>
                </div>
                <div class="h-2 rounded-full bg-black/60 border border-[#1a1a1a] overflow-hidden mb-2">
                  <div id="goal-trades-bar" class="h-full bg-amber-500 transition-all duration-500" style="width: 0%"></div>
                </div>
                <div class="flex items-center justify-between">
                  <span id="goal-trades-current" class="text-[12px] font-semibold text-slate-200">0 trades</span>
                  <span id="goal-trades-status" class="text-[9px] text-emerald-400">No limit</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Perplexity Link -->
          <div
            class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-6"
          >
            <div class="flex items-center justify-between mb-3">
              <div>
                <h3 class="text-[14px] font-semibold text-slate-200 mb-1">
                  Perplexity Finance
                </h3>
                <p class="text-[11px] text-slate-400">
                  AI-powered financial analysis and insights for BTCUSD
                </p>
              </div>
            </div>
            <a
              href="https://www.perplexity.ai/finance/BTCUSD"
              target="_blank"
              rel="noopener noreferrer"
              class="inline-flex items-center gap-2 px-4 py-2.5 rounded-lg bg-emerald-500 text-black text-[12px] font-medium hover:bg-emerald-400 transition-colors"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" />
                <polyline points="15 3 21 3 21 9" />
                <line x1="10" y1="14" x2="21" y2="3" />
              </svg>
              Open Perplexity Finance
            </a>
          </div>

          <!-- Quick Links -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-5">
              <h3 class="text-[13px] font-semibold text-slate-200 mb-3">
                External Resources
              </h3>
              <div class="space-y-2 text-[12px]">
                <a
                  href="https://www.coinglass.com/pro/futures/LiquidationHeatMap"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="flex items-center justify-between px-3 py-2 rounded-lg bg-black/40 text-slate-300 hover:bg-black hover:text-white transition-colors"
                >
                  <span>Liquidation Heatmap</span>
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="14"
                    height="14"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" />
                    <polyline points="15 3 21 3 21 9" />
                    <line x1="10" y1="14" x2="21" y2="3" />
                  </svg>
                </a>
                <a
                  href="https://www.coinglass.com/BitcoinOpenInterest"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="flex items-center justify-between px-3 py-2 rounded-lg bg-black/40 text-slate-300 hover:bg-black hover:text-white transition-colors"
                >
                  <span>Open Interest</span>
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="14"
                    height="14"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" />
                    <polyline points="15 3 21 3 21 9" />
                    <line x1="10" y1="14" x2="21" y2="3" />
                  </svg>
                </a>
                <a
                  href="https://www.coinglass.com/FundingRate"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="flex items-center justify-between px-3 py-2 rounded-lg bg-black/40 text-slate-300 hover:bg-black hover:text-white transition-colors"
                >
                  <span>Funding Rates</span>
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="14"
                    height="14"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" />
                    <polyline points="15 3 21 3 21 9" />
                    <line x1="10" y1="14" x2="21" y2="3" />
                  </svg>
                </a>
              </div>
            </div>

            <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-5">
              <h3 class="text-[13px] font-semibold text-slate-200 mb-3">
                News & Analysis
              </h3>
              <div class="space-y-2 text-[12px]">
                <a
                  href="https://www.coindesk.com/"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="flex items-center justify-between px-3 py-2 rounded-lg bg-black/40 text-slate-300 hover:bg-black hover:text-white transition-colors"
                >
                  <span>CoinDesk News</span>
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="14"
                    height="14"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" />
                    <polyline points="15 3 21 3 21 9" />
                    <line x1="10" y1="14" x2="21" y2="3" />
                  </svg>
                </a>
                <a
                  href="https://www.tradingview.com/markets/cryptocurrencies/prices-all/"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="flex items-center justify-between px-3 py-2 rounded-lg bg-black/40 text-slate-300 hover:bg-black hover:text-white transition-colors"
                >
                  <span>Market Screener</span>
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="14"
                    height="14"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" />
                    <polyline points="15 3 21 3 21 9" />
                    <line x1="10" y1="14" x2="21" y2="3" />
                  </svg>
                </a>
                <a
                  href="https://www.forexfactory.com/calendar"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="flex items-center justify-between px-3 py-2 rounded-lg bg-black/40 text-slate-300 hover:bg-black hover:text-white transition-colors"
                >
                  <span>Economic Calendar</span>
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="14"
                    height="14"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" />
                    <polyline points="15 3 21 3 21 9" />
                    <line x1="10" y1="14" x2="21" y2="3" />
                  </svg>
                </a>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Symbols Management -->
      <section
        id="symbols"
        data-section-panel="symbols"
        class="py-6 md:py-10 px-4 md:px-8 border-t border-[#101010] bg-[#050505] hidden"
      >
        <div class="max-w-6xl mx-auto space-y-6">
          <div>
            <h2 class="text-[15px] font-semibold mb-1">Symbol Database</h2>
            <p class="text-[12px] text-slate-500">
              Manage trading symbols. Add custom symbols for any market you trade.
            </p>
          </div>

          <!-- Add New Symbol -->
          <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-5">
            <h3 class="text-[14px] font-semibold text-slate-200 mb-4">Add New Symbol</h3>
            <div class="grid md:grid-cols-2 gap-4">
              <div>
                <label class="block text-[11px] text-slate-400 mb-1">Symbol *</label>
                <input
                  type="text"
                  id="new-symbol-symbol"
                  class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
                  placeholder="BTCUSDT"
                  required
                />
              </div>
              <div>
                <label class="block text-[11px] text-slate-400 mb-1">Name *</label>
                <input
                  type="text"
                  id="new-symbol-name"
                  class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
                  placeholder="Bitcoin / Tether"
                  required
                />
              </div>
              <div>
                <label class="block text-[11px] text-slate-400 mb-1">Market *</label>
                <select
                  id="new-symbol-market"
                  class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
                  required
                >
                  <option value="">Select market...</option>
                  <option value="stocks">Stocks</option>
                  <option value="forex">Forex</option>
                  <option value="crypto">Crypto</option>
                  <option value="commodities">Commodities</option>
                  <option value="indices">Indices</option>
                  <option value="bonds">Bonds</option>
                  <option value="futures">Futures</option>
                  <option value="options">Options</option>
                  <option value="other">Other</option>
                </select>
              </div>
              <div>
                <label class="block text-[11px] text-slate-400 mb-1">Category</label>
                <input
                  type="text"
                  id="new-symbol-category"
                  class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
                  placeholder="cryptocurrency, major, etf, etc."
                />
              </div>
            </div>
            <button
              id="btn-add-symbol"
              class="mt-4 px-4 py-2 rounded-lg bg-emerald-500/20 border border-emerald-500/30 text-[12px] text-emerald-300 hover:bg-emerald-500/30 transition-colors"
            >
              Add Symbol
            </button>
          </div>

          <!-- Existing Symbols -->
          <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-5">
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-[14px] font-semibold text-slate-200">All Symbols</h3>
              <div class="flex gap-2">
                <input
                  type="text"
                  id="symbol-search"
                  class="px-3 py-1.5 rounded-lg border border-[#222] bg-black text-[11px] text-slate-100 focus:outline-none focus:border-slate-400"
                  placeholder="Search symbols..."
                />
                <select
                  id="symbol-market-filter"
                  class="px-3 py-1.5 rounded-lg border border-[#222] bg-black text-[11px] text-slate-100 focus:outline-none focus:border-slate-400"
                >
                  <option value="">All Markets</option>
                  <option value="stocks">Stocks</option>
                  <option value="forex">Forex</option>
                  <option value="crypto">Crypto</option>
                  <option value="commodities">Commodities</option>
                  <option value="indices">Indices</option>
                  <option value="bonds">Bonds</option>
                  <option value="futures">Futures</option>
                  <option value="options">Options</option>
                  <option value="other">Other</option>
                </select>
              </div>
            </div>
            <div id="symbols-list" class="space-y-2 max-h-96 overflow-y-auto">
              <!-- Symbols will be rendered here -->
            </div>
            <div id="symbols-empty" class="text-[12px] text-slate-500 text-center py-8 hidden">
              No symbols found
            </div>
          </div>
        </div>
      </section>

      <!-- Reports Section -->
      <section
        id="reports"
        data-section-panel="reports"
        class="py-6 md:py-10 px-4 md:px-8 border-t border-[#101010] bg-[#050505] hidden"
      >
        <div class="max-w-4xl mx-auto space-y-6">
          <div>
            <h2 class="text-[15px] font-semibold mb-1">Reports & Export</h2>
            <p class="text-[12px] text-slate-500">
              Generate professional PDF reports for tax purposes, performance reviews, and record keeping.
            </p>
          </div>

          <!-- Report Type Selection -->
          <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-5">
            <h3 class="text-[13px] font-semibold text-slate-200 mb-4">Select Report Type</h3>
            
            <div class="grid md:grid-cols-2 gap-4">
              <!-- Tax Report -->
              <div 
                class="rounded-xl bg-black/40 border border-[#262626] p-4 cursor-pointer hover:border-emerald-500/40 hover:bg-emerald-500/5 transition-all group"
                data-report-type="tax"
              >
                <div class="flex items-center gap-3 mb-3">
                  <div class="w-10 h-10 rounded-lg bg-emerald-500/20 flex items-center justify-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-emerald-400">
                      <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                      <polyline points="14 2 14 8 20 8"></polyline>
                      <line x1="16" y1="13" x2="8" y2="13"></line>
                      <line x1="16" y1="17" x2="8" y2="17"></line>
                      <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                  </div>
                  <div>
                    <h4 class="text-[12px] font-semibold text-emerald-300 group-hover:text-emerald-200">Tax Report</h4>
                    <p class="text-[10px] text-slate-500">For skattemeldingen</p>
                  </div>
                </div>
                <p class="text-[11px] text-slate-400">
                  Complete summary of all trades with realized P&L, suitable for tax documentation. Includes trade-by-trade breakdown.
                </p>
              </div>

              <!-- Performance Report -->
              <div 
                class="rounded-xl bg-black/40 border border-[#262626] p-4 cursor-pointer hover:border-blue-500/40 hover:bg-blue-500/5 transition-all group"
                data-report-type="performance"
              >
                <div class="flex items-center gap-3 mb-3">
                  <div class="w-10 h-10 rounded-lg bg-blue-500/20 flex items-center justify-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-400">
                      <line x1="18" y1="20" x2="18" y2="10"></line>
                      <line x1="12" y1="20" x2="12" y2="4"></line>
                      <line x1="6" y1="20" x2="6" y2="14"></line>
                    </svg>
                  </div>
                  <div>
                    <h4 class="text-[12px] font-semibold text-blue-300 group-hover:text-blue-200">Performance Report</h4>
                    <p class="text-[10px] text-slate-500">Trading statistics</p>
                  </div>
                </div>
                <p class="text-[11px] text-slate-400">
                  Detailed performance metrics including win rate, profit factor, average R, and strategy breakdown.
                </p>
              </div>

              <!-- Monthly Summary -->
              <div 
                class="rounded-xl bg-black/40 border border-[#262626] p-4 cursor-pointer hover:border-purple-500/40 hover:bg-purple-500/5 transition-all group"
                data-report-type="monthly"
              >
                <div class="flex items-center gap-3 mb-3">
                  <div class="w-10 h-10 rounded-lg bg-purple-500/20 flex items-center justify-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-purple-400">
                      <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                      <line x1="16" y1="2" x2="16" y2="6"></line>
                      <line x1="8" y1="2" x2="8" y2="6"></line>
                      <line x1="3" y1="10" x2="21" y2="10"></line>
                    </svg>
                  </div>
                  <div>
                    <h4 class="text-[12px] font-semibold text-purple-300 group-hover:text-purple-200">Monthly Summary</h4>
                    <p class="text-[10px] text-slate-500">Month-by-month breakdown</p>
                  </div>
                </div>
                <p class="text-[11px] text-slate-400">
                  Monthly P&L summary with running totals. Perfect for tracking progress over time.
                </p>
              </div>

              <!-- Trade Journal -->
              <div 
                class="rounded-xl bg-black/40 border border-[#262626] p-4 cursor-pointer hover:border-amber-500/40 hover:bg-amber-500/5 transition-all group"
                data-report-type="journal"
              >
                <div class="flex items-center gap-3 mb-3">
                  <div class="w-10 h-10 rounded-lg bg-amber-500/20 flex items-center justify-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-amber-400">
                      <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                      <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                    </svg>
                  </div>
                  <div>
                    <h4 class="text-[12px] font-semibold text-amber-300 group-hover:text-amber-200">Trade Journal</h4>
                    <p class="text-[10px] text-slate-500">Full trade history</p>
                  </div>
                </div>
                <p class="text-[11px] text-slate-400">
                  Complete trade log with all details, notes, and checklist scores. Good for personal records.
                </p>
              </div>
            </div>
          </div>

          <!-- Report Settings -->
          <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-5">
            <h3 class="text-[13px] font-semibold text-slate-200 mb-4">Report Settings</h3>
            
            <div class="grid md:grid-cols-2 gap-4 mb-4">
              <!-- Date Range -->
              <div>
                <label class="block text-[11px] text-slate-400 mb-1">Date Range</label>
                <select id="report-date-range" class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400">
                  <option value="all">All Time</option>
                  <option value="ytd">Year to Date (2026)</option>
                  <option value="2025">2025</option>
                  <option value="2024">2024</option>
                  <option value="q4-2025">Q4 2025</option>
                  <option value="q3-2025">Q3 2025</option>
                  <option value="q2-2025">Q2 2025</option>
                  <option value="q1-2025">Q1 2025</option>
                  <option value="last30">Last 30 Days</option>
                  <option value="last90">Last 90 Days</option>
                  <option value="custom">Custom Range...</option>
                </select>
              </div>

              <!-- Category Filter -->
              <div>
                <label class="block text-[11px] text-slate-400 mb-1">Category</label>
                <select id="report-category" class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400">
                  <option value="all">All Categories</option>
                  <option value="crypto">‚Çø Crypto</option>
                  <option value="forex">üí± Forex</option>
                  <option value="stocks">üìà Stocks</option>
                  <option value="futures">üìä Futures</option>
                  <option value="options">‚ö° Options</option>
                </select>
              </div>
            </div>

            <!-- Custom Date Range (hidden by default) -->
            <div id="custom-date-range" class="grid md:grid-cols-2 gap-4 mb-4 hidden">
              <div>
                <label class="block text-[11px] text-slate-400 mb-1">From</label>
                <input type="date" id="report-date-from" class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400" />
              </div>
              <div>
                <label class="block text-[11px] text-slate-400 mb-1">To</label>
                <input type="date" id="report-date-to" class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400" />
              </div>
            </div>

            <!-- Include in Report -->
            <div class="mb-4">
              <label class="block text-[11px] text-slate-400 mb-2">Include in report:</label>
              <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                <label class="flex items-center gap-2 text-[11px] text-slate-300 cursor-pointer hover:text-white transition-colors">
                  <input type="checkbox" id="report-include-summary" checked class="rounded border-slate-600 bg-black text-emerald-500 focus:ring-0 focus:ring-offset-0" />
                  Summary stats
                </label>
                <label class="flex items-center gap-2 text-[11px] text-slate-300 cursor-pointer hover:text-white transition-colors">
                  <input type="checkbox" id="report-include-monthly" checked class="rounded border-slate-600 bg-black text-emerald-500 focus:ring-0 focus:ring-offset-0" />
                  Monthly breakdown
                </label>
                <label class="flex items-center gap-2 text-[11px] text-slate-300 cursor-pointer hover:text-white transition-colors">
                  <input type="checkbox" id="report-include-trades" checked class="rounded border-slate-600 bg-black text-emerald-500 focus:ring-0 focus:ring-offset-0" />
                  Trade list
                </label>
                <label class="flex items-center gap-2 text-[11px] text-slate-300 cursor-pointer hover:text-white transition-colors">
                  <input type="checkbox" id="report-include-notes" checked class="rounded border-slate-600 bg-black text-emerald-500 focus:ring-0 focus:ring-offset-0" />
                  Trade notes
                </label>
                <label class="flex items-center gap-2 text-[11px] text-slate-300 cursor-pointer hover:text-white transition-colors">
                  <input type="checkbox" id="report-include-checklist" class="rounded border-slate-600 bg-black text-emerald-500 focus:ring-0 focus:ring-offset-0" />
                  Checklist scores
                </label>
                <label class="flex items-center gap-2 text-[11px] text-slate-300 cursor-pointer hover:text-white transition-colors">
                  <input type="checkbox" id="report-include-instruments" checked class="rounded border-slate-600 bg-black text-emerald-500 focus:ring-0 focus:ring-offset-0" />
                  By instrument
                </label>
                <label class="flex items-center gap-2 text-[11px] text-slate-300 cursor-pointer hover:text-white transition-colors">
                  <input type="checkbox" id="report-include-direction" checked class="rounded border-slate-600 bg-black text-emerald-500 focus:ring-0 focus:ring-offset-0" />
                  Long/Short stats
                </label>
                <label class="flex items-center gap-2 text-[11px] text-slate-300 cursor-pointer hover:text-white transition-colors">
                  <input type="checkbox" id="report-include-streaks" class="rounded border-slate-600 bg-black text-emerald-500 focus:ring-0 focus:ring-offset-0" />
                  Win/Loss streaks
                </label>
              </div>
            </div>

            <!-- Display Options -->
            <div class="mb-4">
              <label class="block text-[11px] text-slate-400 mb-2">Display options:</label>
              <div class="flex flex-wrap gap-4">
                <label class="flex items-center gap-2 text-[11px] text-slate-300 cursor-pointer hover:text-white transition-colors">
                  <input type="checkbox" id="report-group-by-month" checked class="rounded border-slate-600 bg-black text-emerald-500 focus:ring-0 focus:ring-offset-0" />
                  Group trades by month
                </label>
                <label class="flex items-center gap-2 text-[11px] text-slate-300 cursor-pointer hover:text-white transition-colors">
                  <input type="checkbox" id="report-show-running-total" checked class="rounded border-slate-600 bg-black text-emerald-500 focus:ring-0 focus:ring-offset-0" />
                  Show running total
                </label>
                <label class="flex items-center gap-2 text-[11px] text-slate-300 cursor-pointer hover:text-white transition-colors">
                  <input type="checkbox" id="report-highlight-winners" checked class="rounded border-slate-600 bg-black text-emerald-500 focus:ring-0 focus:ring-offset-0" />
                  Highlight winners/losers
                </label>
              </div>
            </div>

            <!-- Report Info -->
            <div class="grid md:grid-cols-2 gap-4">
              <div>
                <label class="block text-[11px] text-slate-400 mb-1">Your Name (for report header)</label>
                <input 
                  type="text" 
                  id="report-trader-name" 
                  class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
                  placeholder="Your name..."
                />
              </div>
              <div>
                <label class="block text-[11px] text-slate-400 mb-1">Report Title (optional)</label>
                <input 
                  type="text" 
                  id="report-custom-title" 
                  class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
                  placeholder="Custom title..."
                />
              </div>
            </div>
          </div>

          <!-- Preview & Generate -->
          <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-5">
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-[13px] font-semibold text-slate-200">Report Preview</h3>
              <div class="flex items-center gap-2">
                <button 
                  id="btn-preview-report"
                  class="px-4 py-2 rounded-lg border border-[#333] bg-black/60 text-[11px] text-slate-300 hover:bg-black/80 hover:border-slate-500 transition-all"
                >
                  Preview
                </button>
                <button 
                  id="btn-generate-pdf"
                  class="px-4 py-2 rounded-lg bg-emerald-600 text-[11px] text-white font-medium hover:bg-emerald-500 transition-all flex items-center gap-2"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                  </svg>
                  Download PDF
                </button>
              </div>
            </div>

            <!-- Preview Container -->
            <div id="report-preview" class="rounded-xl bg-white text-black p-6 min-h-[400px] overflow-auto">
              <div class="text-center text-slate-400 py-12">
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="mx-auto mb-4 text-slate-300">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                  <polyline points="14 2 14 8 20 8"></polyline>
                </svg>
                <p class="text-[13px]">Select a report type and click Preview</p>
                <p class="text-[11px] text-slate-400 mt-1">Your report will appear here</p>
              </div>
            </div>
          </div>

          <!-- Export History -->
          <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-5">
            <h3 class="text-[13px] font-semibold text-slate-200 mb-4">Recent Exports</h3>
            <div id="export-history-list" class="space-y-2">
              <!-- Export history will be rendered here -->
            </div>
            <div id="export-history-empty" class="text-[12px] text-slate-500 text-center py-6">
              No exports yet. Generate your first report above.
            </div>
          </div>
        </div>
      </section>

      <!-- How to Section -->
      <section
        id="howto"
        data-section-panel="howto"
        class="py-6 md:py-10 px-4 md:px-8 border-t border-[#101010] bg-[#050505] hidden"
      >
        <div class="max-w-4xl mx-auto">
          <div class="mb-8">
            <h2 class="text-[18px] font-semibold mb-2">Getting Started with Trading Desk</h2>
            <p class="text-[13px] text-slate-400">
              Follow these steps to set up your journal and get the best experience
            </p>
          </div>

          <!-- Getting Started Steps -->
          <div class="space-y-4 mb-10">
            <h3 class="text-[12px] font-semibold text-amber-400 uppercase tracking-wider flex items-center gap-2">
              <span class="text-[14px]">üöÄ</span> First time? Start here
            </h3>

            <!-- Step 1 -->
            <div 
              class="rounded-2xl bg-gradient-to-br from-amber-500/10 to-amber-500/5 border border-amber-500/20 p-5 cursor-pointer hover:border-amber-500/40 hover:bg-amber-500/15 transition-all group"
              data-howto-nav="vault"
            >
              <div class="flex items-start gap-4">
                <div class="w-10 h-10 rounded-xl bg-amber-500/20 flex items-center justify-center text-amber-400 text-[16px] font-bold shrink-0 group-hover:scale-110 transition-transform">1</div>
                <div class="flex-1">
                  <h4 class="text-[14px] font-semibold text-amber-300 mb-2 group-hover:text-amber-200 transition-colors">Set starting balance for your categories</h4>
                  <p class="text-[12px] text-slate-400 leading-relaxed mb-3">
                    Go to <strong class="text-slate-200">Account</strong> in the menu. Click on a category (Crypto, Forex, etc.) and set your starting balance. This lets you track P&L relative to your initial capital.
                  </p>
                  <div class="flex items-center gap-2 text-[10px] text-amber-400/80">
                    <span>üìç</span>
                    <span>Account ‚Üí Click category ‚Üí Set balance</span>
                    <span class="ml-auto opacity-0 group-hover:opacity-100 transition-opacity">Go ‚Üí</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Step 2 -->
            <div 
              class="rounded-2xl bg-gradient-to-br from-emerald-500/10 to-emerald-500/5 border border-emerald-500/20 p-5 cursor-pointer hover:border-emerald-500/40 hover:bg-emerald-500/15 transition-all group"
              data-howto-nav="playbook"
            >
              <div class="flex items-start gap-4">
                <div class="w-10 h-10 rounded-xl bg-emerald-500/20 flex items-center justify-center text-emerald-400 text-[16px] font-bold shrink-0 group-hover:scale-110 transition-transform">2</div>
                <div class="flex-1">
                  <h4 class="text-[14px] font-semibold text-emerald-300 mb-2 group-hover:text-emerald-200 transition-colors">Create your trading strategies in Playbook</h4>
                  <p class="text-[12px] text-slate-400 leading-relaxed mb-3">
                    Go to <strong class="text-slate-200">Playbook</strong> and create one or more setups. Describe your rules, upload example screenshots. When logging trades later, you can link them to a strategy and see which ones perform best.
                  </p>
                  <div class="flex items-center gap-2 text-[10px] text-emerald-400/80">
                    <span>üìç</span>
                    <span>Playbook ‚Üí New Setup ‚Üí Fill out and save</span>
                    <span class="ml-auto opacity-0 group-hover:opacity-100 transition-opacity">Go ‚Üí</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Step 3 -->
            <div 
              class="rounded-2xl bg-gradient-to-br from-blue-500/10 to-blue-500/5 border border-blue-500/20 p-5 cursor-pointer hover:border-blue-500/40 hover:bg-blue-500/15 transition-all group"
              data-howto-nav="checklist"
            >
              <div class="flex items-start gap-4">
                <div class="w-10 h-10 rounded-xl bg-blue-500/20 flex items-center justify-center text-blue-400 text-[16px] font-bold shrink-0 group-hover:scale-110 transition-transform">3</div>
                <div class="flex-1">
                  <h4 class="text-[14px] font-semibold text-blue-300 mb-2 group-hover:text-blue-200 transition-colors">Customize Daily Prep and Trade Checklist</h4>
                  <p class="text-[12px] text-slate-400 leading-relaxed mb-3">
                    Go to <strong class="text-slate-200">Trade Checklist</strong> and click <strong class="text-slate-200">Settings</strong>. Here you can enable/disable sections, change questions, and customize the checklist to match your trading style.
                  </p>
                  <div class="flex items-center gap-2 text-[10px] text-blue-400/80">
                    <span>üìç</span>
                    <span>Trade Checklist ‚Üí Settings (gear icon)</span>
                    <span class="ml-auto opacity-0 group-hover:opacity-100 transition-opacity">Go ‚Üí</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Step 4 -->
            <div 
              class="rounded-2xl bg-gradient-to-br from-cyan-500/10 to-cyan-500/5 border border-cyan-500/20 p-5 cursor-pointer hover:border-cyan-500/40 hover:bg-cyan-500/15 transition-all group"
              data-howto-nav="import"
            >
              <div class="flex items-start gap-4">
                <div class="w-10 h-10 rounded-xl bg-cyan-500/20 flex items-center justify-center text-cyan-400 text-[16px] font-bold shrink-0 group-hover:scale-110 transition-transform">4</div>
                <div class="flex-1">
                  <h4 class="text-[14px] font-semibold text-cyan-300 mb-2 group-hover:text-cyan-200 transition-colors">Import historical trades (optional)</h4>
                  <p class="text-[12px] text-slate-400 leading-relaxed mb-3">
                    Have existing trades? Go to <strong class="text-slate-200">Import Trades</strong>, select a category, upload CSV from TradingView, MetaTrader, or another broker. Your trades will appear in Analysis immediately.
                  </p>
                  <div class="flex items-center gap-2 text-[10px] text-cyan-400/80">
                    <span>üìç</span>
                    <span>Import Trades ‚Üí Select category ‚Üí Upload CSV</span>
                    <span class="ml-auto opacity-0 group-hover:opacity-100 transition-opacity">Go ‚Üí</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Step 5 -->
            <div 
              class="rounded-2xl bg-gradient-to-br from-purple-500/10 to-purple-500/5 border border-purple-500/20 p-5 cursor-pointer hover:border-purple-500/40 hover:bg-purple-500/15 transition-all group"
              data-howto-nav="reports"
            >
              <div class="flex items-start gap-4">
                <div class="w-10 h-10 rounded-xl bg-purple-500/20 flex items-center justify-center text-purple-400 text-[16px] font-bold shrink-0 group-hover:scale-110 transition-transform">5</div>
                <div class="flex-1">
                  <h4 class="text-[14px] font-semibold text-purple-300 mb-2 group-hover:text-purple-200 transition-colors">Generate PDF reports for taxes</h4>
                  <p class="text-[12px] text-slate-400 leading-relaxed mb-3">
                    Go to <strong class="text-slate-200">Reports</strong> to generate professional PDF documents. Tax reports with P&L breakdown, performance summaries, monthly reports ‚Äì perfect for your tax declaration or personal records.
                  </p>
                  <div class="flex items-center gap-2 text-[10px] text-purple-400/80">
                    <span>üìç</span>
                    <span>Reports ‚Üí Select type ‚Üí Customize ‚Üí Download PDF</span>
                    <span class="ml-auto opacity-0 group-hover:opacity-100 transition-opacity">Go ‚Üí</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Daily Trading Workflow -->
          <div class="space-y-4 mb-10">
            <h3 class="text-[12px] font-semibold text-emerald-400 uppercase tracking-wider flex items-center gap-2">
              <span class="text-[14px]">üìÖ</span> Daily trading workflow
            </h3>

            <div class="grid gap-4 md:grid-cols-3">
              <div 
                class="rounded-xl bg-[#0a0a0a] border border-[#161616] p-4 cursor-pointer hover:border-emerald-500/30 hover:bg-emerald-500/5 transition-all group"
                data-howto-nav="prep"
              >
                <div class="flex items-center gap-3 mb-3">
                  <div class="w-8 h-8 rounded-lg bg-emerald-500/20 flex items-center justify-center text-emerald-400 text-[12px] font-bold group-hover:scale-110 transition-transform">1</div>
                  <h4 class="text-[12px] font-medium text-emerald-300 group-hover:text-emerald-200 transition-colors">Morning: Daily Prep</h4>
                </div>
                <p class="text-[11px] text-slate-500 leading-relaxed">
                  Before trading: Analyze the market, set bias, note key levels, check your mindset. Take screenshots of your charts.
                </p>
              </div>

              <div 
                class="rounded-xl bg-[#0a0a0a] border border-[#161616] p-4 cursor-pointer hover:border-blue-500/30 hover:bg-blue-500/5 transition-all group"
                data-howto-nav="checklist"
              >
                <div class="flex items-center gap-3 mb-3">
                  <div class="w-8 h-8 rounded-lg bg-blue-500/20 flex items-center justify-center text-blue-400 text-[12px] font-bold group-hover:scale-110 transition-transform">2</div>
                  <h4 class="text-[12px] font-medium text-blue-300 group-hover:text-blue-200 transition-colors">Trading: Checklist</h4>
                </div>
                <p class="text-[11px] text-slate-500 leading-relaxed">
                  Before each trade: Fill out idea, select category, score the setup. After trade: Click <span class="text-emerald-400">Win</span> or <span class="text-rose-400">Loss</span> to log it.
                </p>
              </div>

              <div 
                class="rounded-xl bg-[#0a0a0a] border border-[#161616] p-4 cursor-pointer hover:border-purple-500/30 hover:bg-purple-500/5 transition-all group"
                data-howto-nav="review"
              >
                <div class="flex items-center gap-3 mb-3">
                  <div class="w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center text-purple-400 text-[12px] font-bold group-hover:scale-110 transition-transform">3</div>
                  <h4 class="text-[12px] font-medium text-purple-300 group-hover:text-purple-200 transition-colors">Evening: Review</h4>
                </div>
                <p class="text-[11px] text-slate-500 leading-relaxed">
                  Go through today's trades in Review. See what went well/wrong, archive the day, and note improvements for tomorrow.
                </p>
              </div>
            </div>
          </div>

          <!-- All Sections Quick Reference -->
          <div class="space-y-4 mb-10">
            <h3 class="text-[12px] font-semibold text-slate-400 uppercase tracking-wider flex items-center gap-2">
              <span class="text-[14px]">üìñ</span> All sections
            </h3>

            <div class="grid md:grid-cols-2 gap-3">
              <div class="flex items-start gap-3 rounded-xl bg-[#0a0a0a] border border-[#161616] p-3 cursor-pointer hover:border-emerald-500/30 hover:bg-emerald-500/5 transition-all" data-howto-nav="prep">
                <div class="w-2 h-2 rounded-full bg-emerald-400 mt-1.5 shrink-0"></div>
                <div>
                  <h4 class="text-[11px] font-medium text-slate-200 mb-0.5">Daily Prep</h4>
                  <p class="text-[10px] text-slate-500">Market analysis, bias, key levels, psychology check</p>
                </div>
              </div>

              <div class="flex items-start gap-3 rounded-xl bg-[#0a0a0a] border border-[#161616] p-3 cursor-pointer hover:border-blue-500/30 hover:bg-blue-500/5 transition-all" data-howto-nav="checklist">
                <div class="w-2 h-2 rounded-full bg-blue-400 mt-1.5 shrink-0"></div>
                <div>
                  <h4 class="text-[11px] font-medium text-slate-200 mb-0.5">Trade Checklist</h4>
                  <p class="text-[10px] text-slate-500">Score setup, select strategy, log trades with Win/Loss</p>
                </div>
              </div>

              <div class="flex items-start gap-3 rounded-xl bg-[#0a0a0a] border border-[#161616] p-3 cursor-pointer hover:border-purple-500/30 hover:bg-purple-500/5 transition-all" data-howto-nav="review">
                <div class="w-2 h-2 rounded-full bg-purple-400 mt-1.5 shrink-0"></div>
                <div>
                  <h4 class="text-[11px] font-medium text-slate-200 mb-0.5">Review</h4>
                  <p class="text-[10px] text-slate-500">Problem analyzer, trade review, daily archives</p>
                </div>
              </div>

              <div class="flex items-start gap-3 rounded-xl bg-[#0a0a0a] border border-[#161616] p-3 cursor-pointer hover:border-cyan-500/30 hover:bg-cyan-500/5 transition-all" data-howto-nav="analysis">
                <div class="w-2 h-2 rounded-full bg-cyan-400 mt-1.5 shrink-0"></div>
                <div>
                  <h4 class="text-[11px] font-medium text-slate-200 mb-0.5">Analysis</h4>
                  <p class="text-[10px] text-slate-500">Heatmap, equity curve, statistics, strategy ranking</p>
                </div>
              </div>

              <div class="flex items-start gap-3 rounded-xl bg-[#0a0a0a] border border-[#161616] p-3 cursor-pointer hover:border-amber-500/30 hover:bg-amber-500/5 transition-all" data-howto-nav="playbook">
                <div class="w-2 h-2 rounded-full bg-amber-400 mt-1.5 shrink-0"></div>
                <div>
                  <h4 class="text-[11px] font-medium text-slate-200 mb-0.5">Playbook</h4>
                  <p class="text-[10px] text-slate-500">Document strategies with rules and screenshots</p>
                </div>
              </div>

              <div class="flex items-start gap-3 rounded-xl bg-[#0a0a0a] border border-[#161616] p-3 cursor-pointer hover:border-rose-500/30 hover:bg-rose-500/5 transition-all" data-howto-nav="risk">
                <div class="w-2 h-2 rounded-full bg-rose-400 mt-1.5 shrink-0"></div>
                <div>
                  <h4 class="text-[11px] font-medium text-slate-200 mb-0.5">Finance & Risk</h4>
                  <p class="text-[10px] text-slate-500">Position size, drawdown, daily limits, P&L goals</p>
                </div>
              </div>

              <div class="flex items-start gap-3 rounded-xl bg-[#0a0a0a] border border-[#161616] p-3 cursor-pointer hover:border-indigo-500/30 hover:bg-indigo-500/5 transition-all" data-howto-nav="montecarlo">
                <div class="w-2 h-2 rounded-full bg-indigo-400 mt-1.5 shrink-0"></div>
                <div>
                  <h4 class="text-[11px] font-medium text-slate-200 mb-0.5">Monte Carlo</h4>
                  <p class="text-[10px] text-slate-500">Simulate outcomes based on your statistics</p>
                </div>
              </div>

              <div class="flex items-start gap-3 rounded-xl bg-[#0a0a0a] border border-[#161616] p-3 cursor-pointer hover:border-slate-500/30 hover:bg-slate-500/5 transition-all" data-howto-nav="import">
                <div class="w-2 h-2 rounded-full bg-slate-400 mt-1.5 shrink-0"></div>
                <div>
                  <h4 class="text-[11px] font-medium text-slate-200 mb-0.5">Import Trades</h4>
                  <p class="text-[10px] text-slate-500">Upload CSV from broker (TradingView, MT4/5, etc.)</p>
                </div>
              </div>

              <div class="flex items-start gap-3 rounded-xl bg-[#0a0a0a] border border-[#161616] p-3 cursor-pointer hover:border-purple-500/30 hover:bg-purple-500/5 transition-all" data-howto-nav="reports">
                <div class="w-2 h-2 rounded-full bg-purple-400 mt-1.5 shrink-0"></div>
                <div>
                  <h4 class="text-[11px] font-medium text-slate-200 mb-0.5">Reports</h4>
                  <p class="text-[10px] text-slate-500">PDF tax reports, performance summaries, trade journals</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Pro Tips -->
          <div class="rounded-2xl bg-gradient-to-br from-slate-800/50 to-slate-900/50 border border-slate-700/50 p-5">
            <h3 class="text-[13px] font-semibold text-slate-200 mb-4 flex items-center gap-2">
              <span class="text-amber-400">üí°</span>
              Pro Tips
            </h3>
            <div class="grid gap-3 md:grid-cols-2 text-[11px]">
              <div class="flex items-start gap-2">
                <span class="text-emerald-400 mt-0.5">‚úì</span>
                <span class="text-slate-400">Use the <strong class="text-slate-300">category filter</strong> at the top to see P&L and stats per category</span>
              </div>
              <div class="flex items-start gap-2">
                <span class="text-emerald-400 mt-0.5">‚úì</span>
                <span class="text-slate-400">Click the <strong class="text-slate-300">status badge</strong> (Ready/Stop) to change trading status</span>
              </div>
              <div class="flex items-start gap-2">
                <span class="text-emerald-400 mt-0.5">‚úì</span>
                <span class="text-slate-400">Set <strong class="text-slate-300">daily loss limits</strong> in Finance & Risk to get alerts</span>
              </div>
              <div class="flex items-start gap-2">
                <span class="text-emerald-400 mt-0.5">‚úì</span>
                <span class="text-slate-400">Check <strong class="text-slate-300">Analysis heatmap</strong> to find your best trading times</span>
              </div>
              <div class="flex items-start gap-2">
                <span class="text-emerald-400 mt-0.5">‚úì</span>
                <span class="text-slate-400">Everything is stored <strong class="text-slate-300">100% locally</strong> in your browser ‚Äì no server, full privacy</span>
              </div>
              <div class="flex items-start gap-2">
                <span class="text-emerald-400 mt-0.5">‚úì</span>
                <span class="text-slate-400">Use <strong class="text-slate-300">Account</strong> to change theme colors to your preference</span>
              </div>
              <div class="flex items-start gap-2">
                <span class="text-emerald-400 mt-0.5">‚úì</span>
                <span class="text-slate-400">Generate <strong class="text-slate-300">PDF tax reports</strong> in Reports section for your tax declaration</span>
              </div>
              <div class="flex items-start gap-2">
                <span class="text-emerald-400 mt-0.5">‚úì</span>
                <span class="text-slate-400">Customize what to include in reports: notes, checklist scores, instruments, streaks</span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Screenshot Vault Section -->
      <section
        id="screenshots"
        data-section-panel="screenshots"
        class="py-6 md:py-10 px-4 md:px-8 border-t border-[#101010] bg-[#050505] hidden"
      >
        <div class="max-w-6xl mx-auto space-y-6">
          <div class="flex items-center justify-between mb-4">
            <div>
              <h2 class="text-[15px] font-semibold mb-1">Daily Calendar</h2>
              <p class="text-[12px] text-slate-500">
                Click on any day to view Daily Prep and trades
              </p>
            </div>
          </div>
          
          <!-- Calendar View -->
          <div id="calendar-container" class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-3 md:p-5">
            <!-- Calendar Controls - Stacked layout -->
            <div class="flex flex-col gap-3 mb-4">
              <!-- Row 1: View Selector (centered) -->
              <div class="flex justify-center">
                <div id="calendar-view-selector" class="inline-flex items-center gap-0.5 p-1 rounded-lg bg-black/40 border border-[#222]">
                  <button data-view="day" class="calendar-view-btn px-3 py-1.5 rounded-md text-[10px] text-slate-400 hover:text-slate-200 transition-colors">Day</button>
                  <button data-view="week" class="calendar-view-btn px-3 py-1.5 rounded-md text-[10px] text-slate-400 hover:text-slate-200 transition-colors">Week</button>
                  <button data-view="month" class="calendar-view-btn px-3 py-1.5 rounded-md text-[10px] bg-emerald-500/20 text-emerald-400 border border-emerald-500/30 transition-colors">Month</button>
                  <button data-view="year" class="calendar-view-btn px-3 py-1.5 rounded-md text-[10px] text-slate-400 hover:text-slate-200 transition-colors">Year</button>
                </div>
              </div>
              
              <!-- Row 2: Navigation (centered) -->
              <div class="flex items-center justify-center gap-2">
                <button id="btn-calendar-today" class="px-2.5 py-1.5 rounded-md border border-[#333] bg-black/60 text-[10px] text-slate-300 hover:bg-black transition-colors">
                  Today
                </button>
                <button id="btn-calendar-prev" class="w-7 h-7 flex items-center justify-center rounded-md border border-[#333] bg-black/60 text-slate-400 hover:text-slate-200 hover:bg-black transition-colors">
                  <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
                </button>
                <h3 id="calendar-month-header" class="text-[13px] font-medium text-slate-200 min-w-[140px] text-center"></h3>
                <button id="btn-calendar-next" class="w-7 h-7 flex items-center justify-center rounded-md border border-[#333] bg-black/60 text-slate-400 hover:text-slate-200 hover:bg-black transition-colors">
                  <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
                </button>
              </div>
            </div>
            
            <!-- Calendar Grid -->
            <div id="calendar-grid" class="grid grid-cols-7 gap-0.5 md:gap-1 mobile-scroll">
              <!-- Calendar will be rendered here -->
            </div>
            
            <!-- Day Detail View (inside calendar container) -->
            <div id="day-detail-view" class="hidden mt-6">
              <div class="flex items-center justify-between mb-4 pb-4 border-b border-[#222]">
                <div>
                  <h3 id="day-detail-date" class="text-[14px] font-semibold text-slate-200"></h3>
                  <p class="text-[11px] text-slate-400">Daily activity</p>
                </div>
                <button
                  id="btn-close-day-detail"
                  class="px-3 py-1.5 rounded-lg border border-[#383838] bg-black/60 text-[11px] text-slate-200 hover:bg-black"
                >
                  ‚Üê Back
                </button>
              </div>
              
              <!-- Daily Prep -->
              <div id="day-detail-prep" class="mb-4 hidden">
                <h4 class="text-[12px] font-medium text-slate-400 mb-2">Daily Prep</h4>
                <div id="day-detail-prep-content" class="rounded-lg border border-[#222] bg-black/30 p-3"></div>
              </div>
              
              <!-- Trades -->
              <div id="day-detail-trades" class="mb-4 hidden">
                <h4 class="text-[12px] font-medium text-slate-400 mb-2">Trades</h4>
                <div id="day-detail-trades-content" class="space-y-2"></div>
              </div>
              
              <!-- Screenshots -->
              <div id="day-detail-screenshots" class="mb-4 hidden">
                <h4 class="text-[12px] font-medium text-slate-400 mb-2">Screenshots</h4>
                <div id="day-detail-screenshots-content" class="grid grid-cols-2 md:grid-cols-3 gap-2"></div>
              </div>
              
              <!-- Empty state -->
              <div id="day-detail-empty" class="text-[12px] text-slate-500 text-center py-6">
                No activity for this day.
              </div>
            </div>
          </div>
          
          <div id="screenshots-empty" class="text-[12px] text-slate-500 text-center py-8">
            No trading days yet. Start trading to see your daily calendar.
          </div>
        </div>
      </section>

      <!-- Account Section -->
      <section
        id="vault"
        data-section-panel="vault"
        class="py-6 md:py-10 px-4 md:px-8 border-t border-[#101010] bg-[#050505] hidden"
      >
        <div class="max-w-6xl mx-auto space-y-6">
          <div>
            <h2 class="text-[15px] font-semibold mb-1">Account</h2>
            <p class="text-[12px] text-slate-500">
              Manage your category balances and application settings.
            </p>
          </div>

          <!-- Category Performance Section -->
          <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4">
            <div class="mb-4">
              <h3 class="text-[13px] font-semibold text-slate-200">Category Performance</h3>
              <p class="text-[11px] text-slate-500 mt-0.5">P&L by asset class</p>
            </div>
            
            <!-- Category Performance Container -->
            <div id="accounts-by-category" class="space-y-2">
              <!-- Dynamically populated by JS with category performance -->
            </div>
            
            <div id="accounts-empty" class="hidden"></div>
          </div>

          <!-- Theme Settings -->
          <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-5">
            <div class="flex items-center gap-3 mb-4">
              <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-emerald-500/20 to-blue-500/20 border border-emerald-500/30 flex items-center justify-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-emerald-400">
                  <circle cx="12" cy="12" r="5"></circle>
                  <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"></path>
                </svg>
              </div>
              <div>
                <h3 class="text-[14px] font-semibold text-slate-200">Theme Settings</h3>
                <p class="text-[11px] text-slate-500">Customize the look and feel of your trading desk</p>
              </div>
            </div>
            
            <div class="grid md:grid-cols-2 gap-6">
              <!-- Left: Colors -->
              <div>
                <label class="block text-[12px] text-slate-400 mb-3">Accent Color</label>
                <div class="flex items-center gap-2 flex-wrap">
                  <button 
                    data-accent-select="emerald" 
                    class="theme-preview active" 
                    style="background: linear-gradient(135deg, #10b981, #059669);"
                    title="Emerald"
                  ></button>
                  <button 
                    data-accent-select="blue" 
                    class="theme-preview" 
                    style="background: linear-gradient(135deg, #3b82f6, #2563eb);"
                    title="Blue"
                  ></button>
                  <button 
                    data-accent-select="purple" 
                    class="theme-preview" 
                    style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);"
                    title="Purple"
                  ></button>
                  <button 
                    data-accent-select="amber" 
                    class="theme-preview" 
                    style="background: linear-gradient(135deg, #f59e0b, #d97706);"
                    title="Amber"
                  ></button>
                  <button 
                    data-accent-select="rose" 
                    class="theme-preview" 
                    style="background: linear-gradient(135deg, #f43f5e, #e11d48);"
                    title="Rose"
                  ></button>
                  <!-- Warm Linen - special multi-color preview -->
                  <button 
                    data-accent-select="warm" 
                    class="theme-preview overflow-hidden p-0" 
                    style="background: linear-gradient(135deg, #EEE5D6 0%, #D6C3A8 25%, #A8745F 50%, #C49155 75%, #1F4E79 100%);"
                    title="Warm Linen"
                  ></button>
                </div>
                <p id="accent-name" class="text-[10px] text-slate-500 mt-2">Emerald (Default)</p>
              </div>
              
              <!-- Right: Mode -->
              <div>
                <label class="block text-[12px] text-slate-400 mb-3">Color Mode</label>
                <div class="flex items-center gap-2">
                  <button 
                    data-mode-select="dark" 
                    class="flex items-center gap-2 px-3 py-2 rounded-lg bg-emerald-500/20 border border-emerald-500/30 text-[11px] text-emerald-300"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    Dark
                  </button>
                  <button 
                    data-mode-select="light" 
                    class="flex items-center gap-2 px-3 py-2 rounded-lg bg-black/60 border border-[#262626] text-[11px] text-slate-400 hover:bg-black/80"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <circle cx="12" cy="12" r="5"></circle>
                      <line x1="12" y1="1" x2="12" y2="3"></line>
                      <line x1="12" y1="21" x2="12" y2="23"></line>
                      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                      <line x1="1" y1="12" x2="3" y2="12"></line>
                      <line x1="21" y1="12" x2="23" y2="12"></line>
                      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                    Light
                  </button>
                </div>
                <p id="mode-hint" class="text-[10px] text-slate-500 mt-2"></p>
              </div>
            </div>
            
            <!-- Apply Button -->
            <div class="flex items-center justify-between mt-5 pt-4 border-t border-[#161616]">
              <div id="theme-change-indicator" class="text-[11px] text-slate-500 hidden">
                <span class="inline-block w-2 h-2 rounded-full bg-amber-400 mr-2"></span>
                Unsaved changes
              </div>
              <button 
                id="apply-theme-btn"
                class="ml-auto px-4 py-2 rounded-lg bg-emerald-500 hover:bg-emerald-400 text-[12px] font-medium text-white transition-all disabled:opacity-50 disabled:cursor-not-allowed"
                disabled
              >
                Apply Theme
              </button>
            </div>
            
            <!-- Preview -->
            <div class="mt-5 pt-5 border-t border-[#161616]">
              <label class="block text-[12px] text-slate-400 mb-3">Preview</label>
              <div id="theme-preview-box" class="rounded-xl p-4 border" style="background-color: var(--bg-card); border-color: var(--border-color);">
                <div class="flex items-center gap-3 mb-3">
                  <div class="w-8 h-8 rounded-lg flex items-center justify-center" style="background-color: var(--accent-glow); border: 1px solid var(--accent-border);">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="color: var(--accent-primary);">
                      <polyline points="22 7 13.5 15.5 8.5 10.5 2 17"></polyline>
                      <polyline points="16 7 22 7 22 13"></polyline>
                    </svg>
                  </div>
                  <div>
                    <div class="text-[12px] font-medium" style="color: var(--text-primary);">Sample Trade</div>
                    <div class="text-[10px]" style="color: var(--text-secondary);">EURUSD ¬∑ Long</div>
                  </div>
                  <div class="ml-auto text-[14px] font-bold" style="color: var(--accent-primary);">+$125.00</div>
                </div>
                <div class="flex gap-2">
                  <span class="px-2 py-1 rounded text-[10px]" style="background-color: var(--accent-glow); border: 1px solid var(--accent-border); color: var(--accent-primary);">Win</span>
                  <span class="px-2 py-1 rounded text-[10px]" style="background-color: var(--bg-elevated); border: 1px solid var(--border-color); color: var(--text-secondary);">68% WR</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Sign Out Section -->
          <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-5">
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-xl bg-rose-500/10 border border-rose-500/20 flex items-center justify-center">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-rose-400">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                    <polyline points="16 17 21 12 16 7"></polyline>
                    <line x1="21" y1="12" x2="9" y2="12"></line>
                  </svg>
                </div>
                <div>
                  <h3 class="text-[14px] font-semibold text-slate-200">Sign Out</h3>
                  <p class="text-[11px] text-slate-500">Log out of your account</p>
                </div>
              </div>
              <button 
                onclick="window.top.location.href='/sign-out';"
                class="px-4 py-2 rounded-lg bg-rose-500/10 border border-rose-500/30 text-[12px] font-medium text-rose-400 hover:bg-rose-500/20 hover:border-rose-500/40 transition-all"
              >
                Sign Out
              </button>
            </div>
          </div>

        </div>
      </section>

      <!-- Review Section -->
      <section
        id="review"
        data-section-panel="review"
        class="py-6 md:py-10 px-4 md:px-8 border-t border-[#101010] bg-[#050505] hidden"
      >
        <div class="max-w-6xl mx-auto space-y-6">
          <div class="flex items-start justify-between">
            <div>
              <h2 class="text-[15px] font-semibold mb-1">Review</h2>
              <p class="text-[12px] text-slate-500">
                Analyze your trading patterns, review trades, and track your progress over time.
              </p>
            </div>
            <!-- Widget Settings -->
            <div class="widget-settings-container">
              <button class="widget-settings-btn" data-settings-toggle="review" title="Show/Hide Widgets">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="3"></circle>
                  <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                </svg>
              </button>
              <div class="widget-settings-dropdown" data-settings-dropdown="review">
                <div class="widget-settings-header">
                  <span>Show/Hide Widgets</span>
                </div>
                <div class="widget-settings-item">
                  <label for="widget-review-analyzer">Problem Analyzer</label>
                  <div class="toggle-switch">
                    <input type="checkbox" id="widget-review-analyzer" data-widget="review-problem-analyzer" checked>
                    <span class="toggle-slider"></span>
                  </div>
                </div>
                <div class="widget-settings-item">
                  <label for="widget-review-trades">Trade Reviews</label>
                  <div class="toggle-switch">
                    <input type="checkbox" id="widget-review-trades" data-widget="review-trade-reviews" checked>
                    <span class="toggle-slider"></span>
                  </div>
                </div>
                <div class="widget-settings-item">
                  <label for="widget-review-daily">Daily Archives</label>
                  <div class="toggle-switch">
                    <input type="checkbox" id="widget-review-daily" data-widget="review-daily-archives" checked>
                    <span class="toggle-slider"></span>
                  </div>
                </div>
                <div class="widget-settings-item">
                  <label for="widget-review-journal">Journal Archives</label>
                  <div class="toggle-switch">
                    <input type="checkbox" id="widget-review-journal" data-widget="review-journal-archives" checked>
                    <span class="toggle-slider"></span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Trading Insights Dashboard -->
          <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-5" data-widget-id="review-problem-analyzer">
            <div class="flex items-center justify-between mb-5">
              <div>
                <h3 class="text-[14px] font-semibold text-slate-200 mb-1">
                  üìä Trading Insights
                </h3>
                <p class="text-[11px] text-slate-400">
                  Your strengths, areas to improve, and strategy performance
                </p>
              </div>
              <button
                id="btn-analyze-trading"
                class="px-4 py-2 rounded-lg bg-gradient-to-r from-emerald-500 to-blue-500 text-[12px] font-medium text-white hover:opacity-90 transition-all flex items-center gap-2"
              >
                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                </svg>
                Analyze
              </button>
            </div>
            
            <div id="trading-analysis-results" class="hidden space-y-4">
              <!-- Quick Stats Row -->
              <div id="analysis-quick-stats" class="grid grid-cols-4 gap-2"></div>
              
              <!-- Three Column Layout: Strengths | Improvements | Strategies -->
              <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                <!-- Strengths -->
                <div class="rounded-xl bg-emerald-500/5 border border-emerald-500/20 p-3">
                  <div class="flex items-center gap-1.5 mb-2">
                    <span class="text-emerald-400 text-[10px]">‚ú®</span>
                    <h4 class="text-[10px] font-semibold text-emerald-300">Strengths</h4>
                  </div>
                  <div id="analysis-strengths" class="space-y-1 text-[10px]"></div>
                </div>
                
                <!-- Areas to Improve -->
                <div class="rounded-xl bg-amber-500/5 border border-amber-500/20 p-3">
                  <div class="flex items-center gap-1.5 mb-2">
                    <span class="text-amber-400 text-[10px]">üéØ</span>
                    <h4 class="text-[10px] font-semibold text-amber-300">To Improve</h4>
                  </div>
                  <div id="analysis-improvements" class="space-y-1 text-[10px]"></div>
                </div>
                
                <!-- Strategies -->
                <div class="rounded-xl bg-blue-500/5 border border-blue-500/20 p-3">
                  <div class="flex items-center gap-1.5 mb-2">
                    <span class="text-blue-400 text-[10px]">üìà</span>
                    <h4 class="text-[10px] font-semibold text-blue-300">Strategies</h4>
                  </div>
                  <div id="analysis-strategies" class="space-y-0.5"></div>
                </div>
              </div>
              
              <!-- Checklist Insights -->
              <div id="analysis-checklist-section" class="rounded-xl bg-slate-500/5 border border-slate-500/20 p-4 hidden">
                <div class="flex items-center gap-2 mb-3">
                  <span class="text-slate-400">‚úÖ</span>
                  <h4 class="text-[12px] font-semibold text-slate-300">Checklist Analysis</h4>
                </div>
                <div id="analysis-checklist-grid" class="grid grid-cols-3 gap-3"></div>
              </div>
              
              <!-- Action Items -->
              <div class="rounded-xl bg-purple-500/5 border border-purple-500/20 p-4">
                <div class="flex items-center gap-2 mb-3">
                  <span class="text-purple-400">üí°</span>
                  <h4 class="text-[12px] font-semibold text-purple-300">Action Items</h4>
                </div>
                <div id="analysis-recommendations-list" class="space-y-2 text-[11px]"></div>
              </div>
            </div>
            
            <div id="analysis-empty" class="text-center py-10">
              <div class="text-4xl mb-3">üìä</div>
              <div class="text-[13px] text-slate-300 mb-1">Ready to analyze your trading?</div>
              <div class="text-[11px] text-slate-500">Click "Analyze" to discover your strengths and areas to improve</div>
            </div>
          </div>

          <!-- Trade Reviews -->
          <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-5" data-widget-id="review-trade-reviews">
            <div class="flex items-center justify-between mb-4">
              <div>
                <h3 class="text-[14px] font-semibold text-slate-200 mb-1">
                  Trade Reviews
                </h3>
                <p class="text-[11px] text-slate-400">
                  Review your trades and identify what worked and what didn't
                </p>
              </div>
              <button
                id="btn-clear-all-reviews"
                class="px-3 py-1.5 rounded-lg border border-[#383838] bg-black/60 text-[11px] text-slate-200 hover:bg-black"
              >
                Clear All Reviews
              </button>
            </div>
            
            <!-- Review Tabs -->
            <div class="flex gap-2 mb-4 border-b border-[#161616]">
              <button
                id="review-tab-needs"
                class="review-tab px-4 py-2 text-[12px] font-medium border-b-2 border-emerald-500 text-emerald-300"
                data-tab="needs"
              >
                Needs Review
              </button>
              <button
                id="review-tab-reviewed"
                class="review-tab px-4 py-2 text-[12px] font-medium border-b-2 border-transparent text-slate-400 hover:text-slate-300"
                data-tab="reviewed"
              >
                Reviewed
              </button>
              <button
                id="review-tab-all"
                class="review-tab px-4 py-2 text-[12px] font-medium border-b-2 border-transparent text-slate-400 hover:text-slate-300"
                data-tab="all"
              >
                All
              </button>
            </div>
            
            <div id="trade-reviews-list" class="space-y-2">
              <!-- Trade reviews will be rendered here -->
            </div>
            <div id="trade-reviews-empty" class="text-[12px] text-slate-500 text-center py-8">
              No trades to review yet. Complete trades to start reviewing.
            </div>
          </div>

          <!-- Daily Archives -->
          <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-5" data-widget-id="review-daily-archives">
            <div class="flex items-center justify-between mb-4">
              <div>
                <h3 class="text-[14px] font-semibold text-slate-200 mb-1">
                  Daily Archives
                </h3>
                <p class="text-[11px] text-slate-400">
                  Complete daily portfolio: Prep, trades, and results organized by day
                </p>
              </div>
            </div>
            <div id="daily-archives-list" class="space-y-3">
              <!-- Daily archives will be rendered here -->
            </div>
            <div id="daily-archives-empty" class="text-[12px] text-slate-500 text-center py-8">
              No daily archives yet. Archives are automatically created as you trade.
            </div>
          </div>

          <!-- Journal Archives -->
          <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-5" data-widget-id="review-journal-archives">
            <div class="flex items-center justify-between mb-4">
              <div>
                <h3 class="text-[14px] font-semibold text-slate-200 mb-1">
                  Journal Archives
                </h3>
                <p class="text-[11px] text-slate-400">
                  All journal entries organized by date
                </p>
              </div>
              <button
                id="btn-export-all-journals"
                class="px-3 py-1.5 rounded-lg bg-emerald-500/20 border border-emerald-500/30 text-[11px] text-emerald-300 hover:bg-emerald-500/30"
              >
                Export All
              </button>
            </div>
            <div id="journal-archives-list" class="space-y-3">
              <!-- Journal archives will be rendered here -->
            </div>
            <div id="journal-archives-empty" class="text-[12px] text-slate-500 text-center py-8">
              No journal archives yet. Journals are automatically archived when saved.
            </div>
          </div>
        </div>
      </section>

      <!-- Playbook Section -->
      <section
        id="playbook"
        data-section-panel="playbook"
        class="py-6 md:py-10 px-4 md:px-8 border-t border-[#101010] bg-[#050505] hidden"
      >
        <div class="max-w-6xl mx-auto space-y-6">
          <!-- Header - stacks on mobile -->
          <div class="flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3">
            <div>
              <h2 class="text-[15px] font-semibold mb-1">Playbook</h2>
              <p class="text-[11px] md:text-[12px] text-slate-500">
                Document your setups and track their performance
              </p>
            </div>
            <button
              id="btn-add-setup"
              class="px-4 py-2 rounded-lg bg-emerald-500 text-[12px] font-medium text-black hover:bg-emerald-400 transition-colors flex items-center justify-center gap-2 w-full sm:w-auto"
            >
              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
              </svg>
              Add Setup
            </button>
          </div>

          <!-- Playbook Stats -->
          <div class="grid grid-cols-2 md:grid-cols-4 gap-2 md:gap-3">
            <div class="rounded-xl bg-[#0a0a0a] border border-[#161616] p-3 md:p-4">
              <div class="text-[9px] md:text-[10px] text-slate-500 mb-1">Total Setups</div>
              <div id="playbook-total-setups" class="text-[18px] md:text-[20px] font-bold text-slate-200">0</div>
            </div>
            <div class="rounded-xl bg-[#0a0a0a] border border-[#161616] p-3 md:p-4">
              <div class="text-[9px] md:text-[10px] text-slate-500 mb-1">Best Performer</div>
              <div id="playbook-best-setup" class="text-[12px] md:text-[14px] font-bold text-emerald-400 truncate">-</div>
              <div id="playbook-best-winrate" class="text-[9px] md:text-[10px] text-slate-500">-</div>
            </div>
            <div class="rounded-xl bg-[#0a0a0a] border border-[#161616] p-3 md:p-4">
              <div class="text-[9px] md:text-[10px] text-slate-500 mb-1">Total Trades</div>
              <div id="playbook-total-trades" class="text-[18px] md:text-[20px] font-bold text-slate-200">0</div>
            </div>
            <div class="rounded-xl bg-[#0a0a0a] border border-[#161616] p-3 md:p-4">
              <div class="text-[9px] md:text-[10px] text-slate-500 mb-1">Avg Win Rate</div>
              <div id="playbook-avg-winrate" class="text-[18px] md:text-[20px] font-bold text-blue-400">0%</div>
            </div>
          </div>

          <!-- Filter & Search -->
          <div class="flex flex-col md:flex-row gap-3">
            <div class="flex-1">
              <input
                type="text"
                id="playbook-search"
                class="w-full px-4 py-2.5 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-200 placeholder-slate-500 focus:outline-none focus:border-emerald-500/50"
                placeholder="Search setups..."
              />
            </div>
            <div class="flex gap-2">
              <select id="playbook-filter-tag" class="px-3 py-2 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-300 focus:outline-none">
                <option value="">All Tags</option>
                <option value="breakout">Breakout</option>
                <option value="reversal">Reversal</option>
                <option value="continuation">Continuation</option>
                <option value="scalp">Scalp</option>
                <option value="swing">Swing</option>
                <option value="orderflow">Order Flow</option>
              </select>
              <select id="playbook-sort" class="px-3 py-2 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-300 focus:outline-none">
                <option value="recent">Most Recent</option>
                <option value="winrate">Best Win Rate</option>
                <option value="trades">Most Trades</option>
                <option value="pnl">Highest P&L</option>
              </select>
            </div>
          </div>

          <!-- Setups Grid -->
          <div id="playbook-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <!-- Setups will be rendered here -->
          </div>
          
          <div id="playbook-empty" class="text-center py-12">
            <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-slate-800/50 flex items-center justify-center">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-slate-600">
                <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
              </svg>
            </div>
            <h3 class="text-[14px] font-semibold text-slate-300 mb-2">No Setups Yet</h3>
            <p class="text-[12px] text-slate-500 mb-4">
              Start building your playbook by documenting your trading setups.
            </p>
            <button
              id="btn-add-setup-empty"
              class="px-4 py-2 rounded-lg bg-emerald-500/20 border border-emerald-500/30 text-[12px] text-emerald-300 hover:bg-emerald-500/30 transition-colors"
            >
              Create Your First Setup
            </button>
          </div>
        </div>
      </section>

      <!-- Analysis Section -->
      <section
        id="analysis"
        data-section-panel="analysis"
        class="py-6 md:py-10 px-4 md:px-8 border-t border-[#101010] bg-[#050505] hidden"
      >
        <div class="max-w-6xl mx-auto space-y-6">
          <!-- Header with Widget Settings -->
          <div class="flex items-start justify-between">
            <div>
              <h2 class="text-[15px] font-semibold mb-1">Analysis</h2>
              <p class="text-[12px] text-slate-500">
                Deep dive into your trading patterns and performance metrics.
              </p>
            </div>
            <div class="flex items-center gap-3">
              <select id="analysis-period" class="px-3 py-2 rounded-lg bg-black/60 border border-[#262626] text-[11px] text-slate-300 focus:outline-none">
                <option value="all">All Time</option>
                <option value="month">This Month</option>
                <option value="week">This Week</option>
              </select>
              <div class="widget-settings-container">
                <button class="widget-settings-btn" data-settings-toggle="analysis" title="Show/Hide Widgets">
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="3"></circle>
                    <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"></path>
                  </svg>
                </button>
                <div class="widget-settings-dropdown" data-settings-dropdown="analysis">
                  <div class="widget-settings-header">
                    <span>Show/Hide Widgets</span>
                  </div>
                  <div class="widget-settings-item">
                    <label for="widget-analysis-overview">Overview Stats</label>
                    <div class="toggle-switch">
                      <input type="checkbox" id="widget-analysis-overview" data-widget="analysis-overview" checked>
                      <span class="toggle-slider"></span>
                    </div>
                  </div>
                  <div class="widget-settings-item">
                    <label for="widget-analysis-progress">Progress Chart</label>
                    <div class="toggle-switch">
                      <input type="checkbox" id="widget-analysis-progress" data-widget="analysis-progress" checked>
                      <span class="toggle-slider"></span>
                    </div>
                  </div>
                  <div class="widget-settings-item">
                    <label for="widget-analysis-heatmap">Trading Heatmap</label>
                    <div class="toggle-switch">
                      <input type="checkbox" id="widget-analysis-heatmap" data-widget="analysis-heatmap" checked>
                      <span class="toggle-slider"></span>
                    </div>
                  </div>
                  <div class="widget-settings-item">
                    <label for="widget-analysis-metrics">Key Metrics</label>
                    <div class="toggle-switch">
                      <input type="checkbox" id="widget-analysis-metrics" data-widget="analysis-metrics" checked>
                      <span class="toggle-slider"></span>
                    </div>
                  </div>
                  <div class="widget-settings-item">
                    <label for="widget-analysis-charts">Charts</label>
                    <div class="toggle-switch">
                      <input type="checkbox" id="widget-analysis-charts" data-widget="analysis-charts" checked>
                      <span class="toggle-slider"></span>
                    </div>
                  </div>
                  <div class="widget-settings-item">
                    <label for="widget-analysis-details">Drawdown & Streaks</label>
                    <div class="toggle-switch">
                      <input type="checkbox" id="widget-analysis-details" data-widget="analysis-details" checked>
                      <span class="toggle-slider"></span>
                    </div>
                  </div>
                  <div class="widget-settings-item">
                    <label for="widget-analysis-strategies">Strategy Performance</label>
                    <div class="toggle-switch">
                      <input type="checkbox" id="widget-analysis-strategies" data-widget="analysis-strategies" checked>
                      <span class="toggle-slider"></span>
                    </div>
                  </div>
                  <div class="widget-settings-item">
                    <label for="widget-analysis-symbols">Symbol Performance</label>
                    <div class="toggle-switch">
                      <input type="checkbox" id="widget-analysis-symbols" data-widget="analysis-symbols" checked>
                      <span class="toggle-slider"></span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Overview Stats -->
          <div class="grid grid-cols-2 md:grid-cols-4 gap-2 md:gap-3" data-widget-id="analysis-overview">
            <div class="rounded-xl bg-[#0a0a0a] border border-[#161616] p-3 md:p-4">
              <div class="text-[9px] md:text-[10px] text-slate-500 mb-1">Total Trades</div>
              <div id="analysis-total-trades" class="text-[20px] md:text-[24px] font-bold text-slate-200">0</div>
            </div>
            <div class="rounded-xl bg-[#0a0a0a] border border-[#161616] p-3 md:p-4">
              <div class="text-[9px] md:text-[10px] text-slate-500 mb-1">Win Rate</div>
              <div id="analysis-win-rate" class="text-[20px] md:text-[24px] font-bold text-emerald-400">0%</div>
            </div>
            <div class="rounded-xl bg-[#0a0a0a] border border-[#161616] p-3 md:p-4">
              <div class="text-[9px] md:text-[10px] text-slate-500 mb-1">Total P&L</div>
              <div id="analysis-total-pnl" class="text-[20px] md:text-[24px] font-bold text-slate-200">$0</div>
            </div>
            <div class="rounded-xl bg-[#0a0a0a] border border-[#161616] p-3 md:p-4">
              <div class="text-[9px] md:text-[10px] text-slate-500 mb-1">Expectancy</div>
              <div id="stat-expectancy" class="text-[20px] md:text-[24px] font-bold text-blue-400">$0</div>
              <div class="text-[8px] md:text-[9px] text-slate-500">per trade</div>
            </div>
          </div>

          <!-- Trade Progress Chart -->
          <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4 md:p-5" data-widget-id="analysis-progress">
            <!-- Header - stacks on mobile -->
            <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3 mb-4">
              <h3 class="text-[14px] font-semibold text-slate-200">Trade Progress</h3>
              
              <!-- Controls - wraps on mobile -->
              <div class="flex flex-wrap items-center gap-2">
                <!-- Timeframe buttons -->
                <div class="flex gap-1 flex-wrap">
                  <button data-timeframe="7D" class="account-chart-timeframe px-2 md:px-2.5 py-1 rounded-lg text-[9px] md:text-[10px] font-medium bg-black/60 border border-[#262626] text-slate-400 hover:bg-black/80">7D</button>
                  <button data-timeframe="4W" class="account-chart-timeframe px-2 md:px-2.5 py-1 rounded-lg text-[9px] md:text-[10px] font-medium bg-black/60 border border-[#262626] text-slate-400 hover:bg-black/80">4W</button>
                  <button data-timeframe="MTD" class="account-chart-timeframe px-2 md:px-2.5 py-1 rounded-lg text-[9px] md:text-[10px] font-medium bg-black/60 border border-[#262626] text-slate-400 hover:bg-black/80">MTD</button>
                  <button data-timeframe="YTD" class="account-chart-timeframe px-2 md:px-2.5 py-1 rounded-lg text-[9px] md:text-[10px] font-medium bg-black/60 border border-[#262626] text-slate-400 hover:bg-black/80">YTD</button>
                  <button data-timeframe="All" class="account-chart-timeframe px-2 md:px-2.5 py-1 rounded-lg text-[9px] md:text-[10px] font-medium bg-emerald-500/20 border border-emerald-500/30 text-emerald-300">All</button>
                </div>
                
                <!-- Metric selector -->
                <select id="chart-metric-selector" class="px-2 py-1 rounded-lg bg-black/60 border border-[#262626] text-[9px] md:text-[10px] text-slate-300 focus:outline-none">
                  <option value="pnl" selected>Cumulative P&L</option>
                  <option value="winrate">Win Rate %</option>
                  <option value="checklist">Checklist Score</option>
                </select>
              </div>
            </div>
            
            <!-- Chart -->
            <div class="h-48 md:h-64">
              <canvas id="account-balance-chart"></canvas>
            </div>
          </div>

          <!-- Trading Heatmap -->
          <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4 md:p-5" data-widget-id="analysis-heatmap">
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-4">
              <div>
                <h3 class="text-[13px] md:text-[14px] font-semibold text-slate-200 mb-0.5">Trading Heatmap</h3>
                <p class="text-[10px] md:text-[11px] text-slate-400">When you trade best</p>
              </div>
              <select id="heatmap-metric" class="px-2 py-1 rounded-lg bg-black/60 border border-[#262626] text-[9px] md:text-[10px] text-slate-300 focus:outline-none w-fit">
                <option value="pnl">P&L</option>
                <option value="winrate">Win Rate</option>
                <option value="trades">Trades</option>
              </select>
            </div>
            <div class="overflow-x-auto">
              <div id="heatmap-container" class="min-w-[500px]">
                <div class="flex mb-1 items-center">
                  <div class="w-12 flex-shrink-0 text-[8px] text-slate-600">Hour</div>
                  <div class="flex-1 flex gap-px text-[7px] text-slate-500">
                    <span class="flex-1 text-center">0</span><span class="flex-1 text-center">2</span><span class="flex-1 text-center">4</span><span class="flex-1 text-center">6</span><span class="flex-1 text-center">8</span><span class="flex-1 text-center">10</span><span class="flex-1 text-center">12</span><span class="flex-1 text-center">14</span><span class="flex-1 text-center">16</span><span class="flex-1 text-center">18</span><span class="flex-1 text-center">20</span><span class="flex-1 text-center">22</span>
                  </div>
                </div>
                <div id="heatmap-grid" class="space-y-px"></div>
              </div>
            </div>
            <div class="flex items-center justify-between mt-4 pt-3 border-t border-[#161616]">
              <div class="flex items-center gap-2">
                <span class="text-[9px] text-slate-500">Loss</span>
                <div class="flex gap-0.5">
                  <div class="w-3 h-3 rounded-sm bg-rose-600/60"></div>
                  <div class="w-3 h-3 rounded-sm bg-rose-800/40"></div>
                  <div class="w-3 h-3 rounded-sm bg-slate-700/50"></div>
                  <div class="w-3 h-3 rounded-sm bg-emerald-800/40"></div>
                  <div class="w-3 h-3 rounded-sm bg-emerald-500/60"></div>
                </div>
                <span class="text-[9px] text-slate-500">Profit</span>
              </div>
              <div id="heatmap-summary" class="text-[10px] text-slate-400">
                Best: <span id="heatmap-best" class="text-emerald-400">-</span> | 
                Worst: <span id="heatmap-worst" class="text-rose-400">-</span>
              </div>
            </div>
            <div id="heatmap-empty" class="hidden text-[12px] text-slate-500 text-center py-8">
              No trading data yet. Complete trades to see your heatmap.
            </div>
          </div>

          <!-- Key Metrics -->
          <div class="grid grid-cols-2 md:grid-cols-4 gap-2 md:gap-3" data-widget-id="analysis-metrics">
            <div class="rounded-xl bg-[#0a0a0a] border border-[#161616] p-3 md:p-4">
              <div class="text-[9px] md:text-[10px] text-slate-500 mb-1">Profit Factor</div>
              <div id="stat-profit-factor" class="text-[18px] md:text-[20px] font-bold text-blue-400">0.00</div>
              <div class="text-[8px] md:text-[9px] text-slate-500 hidden md:block">gross P / gross L</div>
            </div>
            <div class="rounded-xl bg-[#0a0a0a] border border-[#161616] p-3 md:p-4">
              <div class="text-[9px] md:text-[10px] text-slate-500 mb-1">Avg Win</div>
              <div id="stat-avg-win" class="text-[18px] md:text-[20px] font-bold text-emerald-400">$0</div>
              <div class="text-[8px] md:text-[9px] text-slate-500 hidden md:block">average winner</div>
            </div>
            <div class="rounded-xl bg-[#0a0a0a] border border-[#161616] p-3 md:p-4">
              <div class="text-[9px] md:text-[10px] text-slate-500 mb-1">Avg Loss</div>
              <div id="stat-avg-loss" class="text-[18px] md:text-[20px] font-bold text-rose-400">$0</div>
              <div class="text-[8px] md:text-[9px] text-slate-500 hidden md:block">average loser</div>
            </div>
            <div class="rounded-xl bg-[#0a0a0a] border border-[#161616] p-3 md:p-4">
              <div class="text-[9px] md:text-[10px] text-slate-500 mb-1">Risk/Reward</div>
              <div id="stat-risk-reward" class="text-[18px] md:text-[20px] font-bold text-amber-400">0:0</div>
              <div class="text-[8px] md:text-[9px] text-slate-500 hidden md:block">avg ratio</div>
            </div>
          </div>

          <!-- Charts Row -->
          <div class="grid md:grid-cols-2 gap-3 md:gap-4" data-widget-id="analysis-charts">
            <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4 md:p-5">
              <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-3 md:mb-4">
                <h3 class="text-[12px] md:text-[13px] font-semibold text-slate-200">Equity Curve</h3>
                <div class="flex items-center gap-3">
                  <span class="flex items-center gap-1 text-[8px] md:text-[9px] text-slate-500">
                    <span class="w-2 h-0.5 bg-emerald-500"></span> Balance
                  </span>
                  <span class="flex items-center gap-1 text-[8px] md:text-[9px] text-slate-500">
                    <span class="w-2 h-0.5 bg-rose-500/50"></span> Drawdown
                  </span>
                </div>
              </div>
              <div class="h-40 md:h-48">
                <canvas id="equity-curve-chart"></canvas>
              </div>
            </div>
            <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-4 md:p-5">
              <h3 class="text-[12px] md:text-[13px] font-semibold text-slate-200 mb-3 md:mb-4">P&L Distribution</h3>
              <div class="h-40 md:h-48">
                <canvas id="pnl-distribution-chart"></canvas>
              </div>
            </div>
          </div>

          <!-- Drawdown & Streaks -->
          <div class="grid md:grid-cols-2 gap-4" data-widget-id="analysis-details">
            <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-5">
              <h3 class="text-[13px] font-semibold text-slate-200 mb-4">Drawdown Analysis</h3>
              <div class="space-y-3">
                <div class="flex justify-between items-center py-2 border-b border-[#161616]">
                  <span class="text-[11px] text-slate-500">Max Drawdown</span>
                  <span id="stat-max-dd" class="text-[14px] font-semibold text-rose-400">0%</span>
                </div>
                <div class="flex justify-between items-center py-2 border-b border-[#161616]">
                  <span class="text-[11px] text-slate-500">Max DD Amount</span>
                  <span id="stat-max-dd-amount" class="text-[14px] font-semibold text-rose-400">$0</span>
                </div>
                <div class="flex justify-between items-center py-2 border-b border-[#161616]">
                  <span class="text-[11px] text-slate-500">Recovery Time</span>
                  <span id="stat-recovery-time" class="text-[14px] font-semibold text-slate-300">-</span>
                </div>
                <div class="flex justify-between items-center py-2">
                  <span class="text-[11px] text-slate-500">Current DD</span>
                  <span id="stat-current-dd" class="text-[14px] font-semibold text-amber-400">0%</span>
                </div>
              </div>
            </div>
            <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-5">
              <h3 class="text-[13px] font-semibold text-slate-200 mb-4">Win/Loss Streaks</h3>
              <div class="space-y-3">
                <div class="flex justify-between items-center py-2 border-b border-[#161616]">
                  <span class="text-[11px] text-slate-500">Current Streak</span>
                  <span id="stat-current-streak" class="text-[14px] font-semibold text-slate-300">-</span>
                </div>
                <div class="flex justify-between items-center py-2 border-b border-[#161616]">
                  <span class="text-[11px] text-slate-500">Best Win Streak</span>
                  <span id="stat-best-streak" class="text-[14px] font-semibold text-emerald-400">0</span>
                </div>
                <div class="flex justify-between items-center py-2 border-b border-[#161616]">
                  <span class="text-[11px] text-slate-500">Worst Loss Streak</span>
                  <span id="stat-worst-streak" class="text-[14px] font-semibold text-rose-400">0</span>
                </div>
                <div class="flex justify-between items-center py-2">
                  <span class="text-[11px] text-slate-500">Avg Trades/Day</span>
                  <span id="stat-avg-trades" class="text-[14px] font-semibold text-slate-300">0</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Strategy Performance -->
          <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-5" data-widget-id="analysis-strategies">
            <div class="flex items-center justify-between mb-5">
              <div class="flex items-center gap-3">
                <div class="w-9 h-9 rounded-xl bg-gradient-to-br from-blue-500/20 to-purple-500/20 border border-blue-500/20 flex items-center justify-center">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                  </svg>
                </div>
                <div>
                  <h3 class="text-[14px] font-semibold text-slate-200">Strategy Performance</h3>
                  <p class="text-[10px] text-slate-500">Your Playbook setups ranked by performance</p>
                </div>
              </div>
              <a href="#" data-section-nav="playbook" class="px-3 py-1.5 rounded-lg bg-slate-800 hover:bg-slate-700 text-[10px] text-slate-300 transition-colors">
                Playbook ‚Üí
              </a>
            </div>
            <div id="strategy-performance-list"></div>
          </div>

          <!-- Symbol Performance Report -->
          <div class="rounded-2xl bg-[#0a0a0a] border border-[#161616] p-5" data-widget-id="analysis-symbols">
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-[14px] font-semibold text-slate-200">Symbol Performance</h3>
              <div class="flex gap-1">
                <button data-report-range="1D" class="symbol-report-range px-2.5 py-1 rounded-lg text-[10px] font-medium bg-emerald-500/20 border border-emerald-500/30 text-emerald-300">1D</button>
                <button data-report-range="7D" class="symbol-report-range px-2.5 py-1 rounded-lg text-[10px] font-medium bg-black/60 border border-[#262626] text-slate-400 hover:bg-black/80">7D</button>
                <button data-report-range="30D" class="symbol-report-range px-2.5 py-1 rounded-lg text-[10px] font-medium bg-black/60 border border-[#262626] text-slate-400 hover:bg-black/80">30D</button>
                <button data-report-range="All" class="symbol-report-range px-2.5 py-1 rounded-lg text-[10px] font-medium bg-black/60 border border-[#262626] text-slate-400 hover:bg-black/80">All</button>
              </div>
            </div>
            <div id="symbol-report-results">
              <div class="text-[12px] text-slate-500 text-center py-6">
                No symbol data to display yet. Complete trades to see performance by symbol.
              </div>
            </div>
          </div>

          <!-- Empty State -->
          <div id="analysis-empty" class="hidden rounded-2xl bg-[#0a0a0a] border border-[#161616] p-10 text-center">
            <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-slate-800/50 flex items-center justify-center">
              <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="text-slate-600">
                <line x1="18" y1="20" x2="18" y2="10"></line>
                <line x1="12" y1="20" x2="12" y2="4"></line>
                <line x1="6" y1="20" x2="6" y2="14"></line>
              </svg>
            </div>
            <h3 class="text-[14px] font-semibold text-slate-300 mb-2">No Trading Data Yet</h3>
            <p class="text-[12px] text-slate-500 max-w-sm mx-auto">
              Complete some trades to see detailed analytics and insights about your trading patterns.
            </p>
          </div>
        </div>
      </section>

      <!-- Import Trades Section -->
      <section
        id="import"
        data-section-panel="import"
        class="py-6 md:py-10 px-4 md:px-8 border-t border-[#101010] bg-[#050505] hidden"
      >
        <div class="max-w-4xl mx-auto space-y-6">
          <div class="flex items-start justify-between">
            <div>
              <h2 class="text-[15px] font-semibold mb-1">Import Trades</h2>
              <p class="text-[12px] text-slate-500">
                Import trades from CSV files exported from your broker or trading platform.
              </p>
            </div>
          </div>

          <!-- How to Export Guide -->
          <div class="rounded-xl bg-[#0a0a0a] border border-[#161616] overflow-hidden">
            <button id="import-guide-toggle" class="w-full p-4 flex items-center justify-between hover:bg-[#111] transition-colors">
              <div class="flex items-center gap-3">
                <div class="w-8 h-8 rounded-lg bg-blue-500/20 flex items-center justify-center">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-400">
                    <circle cx="12" cy="12" r="10"></circle>
                    <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                    <line x1="12" y1="17" x2="12.01" y2="17"></line>
                  </svg>
                </div>
                <div class="text-left">
                  <div class="text-[12px] font-medium text-slate-200">How to export your trades</div>
                  <div class="text-[10px] text-slate-500">Step-by-step guide for each platform</div>
                </div>
              </div>
              <svg id="import-guide-chevron" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-slate-500 transition-transform">
                <polyline points="6 9 12 15 18 9"></polyline>
              </svg>
            </button>
            
            <div id="import-guide-content" class="hidden border-t border-[#161616]">
              <!-- TradingView -->
              <div class="p-4 border-b border-[#161616]/50">
                <div class="flex items-center gap-2 mb-3">
                  <div class="w-6 h-6 rounded bg-[#2962FF]/20 flex items-center justify-center">
                    <span class="text-[10px] font-bold text-[#2962FF]">TV</span>
                  </div>
                  <span class="text-[12px] font-medium text-slate-200">TradingView</span>
                  <span class="px-1.5 py-0.5 rounded bg-emerald-500/20 text-emerald-400 text-[9px]">Smart Combine</span>
                </div>
                
                <!-- Best method: Both files -->
                <div class="ml-8 mb-3 p-3 rounded-lg bg-emerald-500/10 border border-emerald-500/30">
                  <div class="text-[11px] text-emerald-400 font-medium mb-2">‚úì Best: Upload BOTH files</div>
                  <div class="space-y-3">
                    <div class="flex items-start gap-3">
                      <div class="w-5 h-5 rounded bg-blue-500/20 flex items-center justify-center flex-shrink-0 mt-0.5">
                        <span class="text-[9px] font-bold text-blue-400">1</span>
                      </div>
                      <div>
                        <div class="text-[10px] text-slate-300 font-medium">Order History</div>
                        <div class="text-[9px] text-slate-500">Trading Panel ‚Üí Order History ‚Üí Export CSV</div>
                        <div class="text-[9px] text-blue-400">üìã Provides: Symbol, Entry, Exit, Direction</div>
                      </div>
                    </div>
                    <div class="flex items-start gap-3">
                      <div class="w-5 h-5 rounded bg-emerald-500/20 flex items-center justify-center flex-shrink-0 mt-0.5">
                        <span class="text-[9px] font-bold text-emerald-400">2</span>
                      </div>
                      <div>
                        <div class="text-[10px] text-slate-300 font-medium">Balance History</div>
                        <div class="text-[9px] text-slate-500">Trading Panel ‚Üí Balance History ‚Üí Export CSV</div>
                        <div class="text-[9px] text-emerald-400">üí∞ Provides: Actual P&L from broker</div>
                      </div>
                    </div>
                    <div class="flex items-start gap-3">
                      <div class="w-5 h-5 rounded bg-purple-500/20 flex items-center justify-center flex-shrink-0 mt-0.5">
                        <span class="text-[9px] font-bold text-purple-400">3</span>
                      </div>
                      <div>
                        <div class="text-[10px] text-slate-300 font-medium">Drop both files together</div>
                        <div class="text-[9px] text-slate-500">We combine them automatically! üéØ</div>
                        <div class="text-[9px] text-purple-400">‚ú® Result: Complete trade with P&L</div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Single file alternative -->
                <div class="ml-8 p-2 rounded-lg bg-black/20 border border-[#262626]">
                  <div class="text-[10px] text-slate-500">
                    <span class="text-slate-400">Alternative:</span> Balance History alone also works - you can fill in the symbol manually in preview.
                  </div>
                </div>
              </div>
              
              <!-- MetaTrader 4/5 -->
              <div class="p-4 border-b border-[#161616]/50">
                <div class="flex items-center gap-2 mb-3">
                  <div class="w-6 h-6 rounded bg-[#4A90D9]/20 flex items-center justify-center">
                    <span class="text-[10px] font-bold text-[#4A90D9]">MT</span>
                  </div>
                  <span class="text-[12px] font-medium text-slate-200">MetaTrader 4 / 5</span>
                </div>
                <ol class="space-y-2 text-[11px] text-slate-400 ml-8">
                  <li class="flex gap-2">
                    <span class="text-emerald-500 font-medium">1.</span>
                    <span>Open MetaTrader and press <span class="text-slate-300 bg-black/40 px-1.5 py-0.5 rounded">Ctrl + T</span> to open Terminal</span>
                  </li>
                  <li class="flex gap-2">
                    <span class="text-emerald-500 font-medium">2.</span>
                    <span>Go to <span class="text-slate-300 bg-black/40 px-1.5 py-0.5 rounded">Account History</span> tab</span>
                  </li>
                  <li class="flex gap-2">
                    <span class="text-emerald-500 font-medium">3.</span>
                    <span>Right-click ‚Üí <span class="text-slate-300 bg-black/40 px-1.5 py-0.5 rounded">All History</span> (or select date range)</span>
                  </li>
                  <li class="flex gap-2">
                    <span class="text-emerald-500 font-medium">4.</span>
                    <span>Right-click again ‚Üí <span class="text-slate-300 bg-black/40 px-1.5 py-0.5 rounded">Save as Detailed Report</span></span>
                  </li>
                  <li class="flex gap-2">
                    <span class="text-emerald-500 font-medium">5.</span>
                    <span>Save as .csv (or .htm and we'll convert it)</span>
                  </li>
                </ol>
              </div>
              
              <!-- Interactive Brokers -->
              <div class="p-4 border-b border-[#161616]/50">
                <div class="flex items-center gap-2 mb-3">
                  <div class="w-6 h-6 rounded bg-[#D32F2F]/20 flex items-center justify-center">
                    <span class="text-[10px] font-bold text-[#D32F2F]">IB</span>
                  </div>
                  <span class="text-[12px] font-medium text-slate-200">Interactive Brokers</span>
                </div>
                <ol class="space-y-2 text-[11px] text-slate-400 ml-8">
                  <li class="flex gap-2">
                    <span class="text-emerald-500 font-medium">1.</span>
                    <span>Log in to <span class="text-slate-300 bg-black/40 px-1.5 py-0.5 rounded">Client Portal</span> or TWS</span>
                  </li>
                  <li class="flex gap-2">
                    <span class="text-emerald-500 font-medium">2.</span>
                    <span>Go to <span class="text-slate-300 bg-black/40 px-1.5 py-0.5 rounded">Reports</span> ‚Üí <span class="text-slate-300 bg-black/40 px-1.5 py-0.5 rounded">Statements</span></span>
                  </li>
                  <li class="flex gap-2">
                    <span class="text-emerald-500 font-medium">3.</span>
                    <span>Select <span class="text-slate-300 bg-black/40 px-1.5 py-0.5 rounded">Activity Statement</span> or <span class="text-slate-300 bg-black/40 px-1.5 py-0.5 rounded">Trade Confirmations</span></span>
                  </li>
                  <li class="flex gap-2">
                    <span class="text-emerald-500 font-medium">4.</span>
                    <span>Choose date range and click <span class="text-slate-300 bg-black/40 px-1.5 py-0.5 rounded">Run</span></span>
                  </li>
                  <li class="flex gap-2">
                    <span class="text-emerald-500 font-medium">5.</span>
                    <span>Download as CSV format</span>
                  </li>
                </ol>
              </div>
              
              <!-- Generic CSV -->
              <div class="p-4">
                <div class="flex items-center gap-2 mb-3">
                  <div class="w-6 h-6 rounded bg-slate-500/20 flex items-center justify-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-slate-400">
                      <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                      <polyline points="14 2 14 8 20 8"></polyline>
                    </svg>
                  </div>
                  <span class="text-[12px] font-medium text-slate-200">Generic CSV / Other Brokers</span>
                </div>
                <p class="text-[11px] text-slate-400 mb-3 ml-8">Your CSV should include these columns (we'll try to auto-detect):</p>
                <div class="ml-8 flex flex-wrap gap-2">
                  <span class="text-[10px] px-2 py-1 rounded bg-black/40 text-slate-300 border border-[#262626]">Date/Time</span>
                  <span class="text-[10px] px-2 py-1 rounded bg-black/40 text-slate-300 border border-[#262626]">Symbol</span>
                  <span class="text-[10px] px-2 py-1 rounded bg-black/40 text-slate-300 border border-[#262626]">Side (Buy/Sell)</span>
                  <span class="text-[10px] px-2 py-1 rounded bg-black/40 text-slate-300 border border-[#262626]">Quantity</span>
                  <span class="text-[10px] px-2 py-1 rounded bg-black/40 text-slate-300 border border-[#262626]">Price</span>
                  <span class="text-[10px] px-2 py-1 rounded bg-black/40 text-slate-300 border border-[#262626]">P&L (optional)</span>
                </div>
                <p class="text-[10px] text-slate-500 mt-3 ml-8">üí° Tip: Most brokers have an "Export" or "Download" option in their trade history section.</p>
              </div>
            </div>
          </div>

          <!-- Supported Formats -->
          <div class="rounded-xl bg-[#0a0a0a] border border-[#161616] p-4">
            <h3 class="text-[12px] font-semibold text-slate-300 mb-3">Supported Formats</h3>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
              <div class="flex items-center gap-2 text-[11px] text-slate-400">
                <div class="w-2 h-2 rounded-full bg-emerald-500"></div>
                TradingView
              </div>
              <div class="flex items-center gap-2 text-[11px] text-slate-400">
                <div class="w-2 h-2 rounded-full bg-emerald-500"></div>
                MetaTrader 4/5
              </div>
              <div class="flex items-center gap-2 text-[11px] text-slate-400">
                <div class="w-2 h-2 rounded-full bg-emerald-500"></div>
                Interactive Brokers
              </div>
              <div class="flex items-center gap-2 text-[11px] text-slate-400">
                <div class="w-2 h-2 rounded-full bg-emerald-500"></div>
                Generic CSV
              </div>
            </div>
          </div>

          <!-- File Upload -->
          <div class="rounded-xl bg-[#0a0a0a] border border-[#161616] p-5">
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-[13px] font-semibold text-slate-200">Upload Files</h3>
              <select id="import-format" class="px-3 py-1.5 rounded-lg bg-black/60 border border-[#262626] text-[11px] text-slate-300 focus:outline-none">
                <option value="auto">Auto-detect Format</option>
                <option value="tradingview">TradingView</option>
                <option value="mt4">MetaTrader 4</option>
                <option value="mt5">MetaTrader 5</option>
                <option value="ibkr">Interactive Brokers</option>
                <option value="generic">Generic CSV</option>
              </select>
            </div>
            
            <!-- TradingView Multi-file hint -->
            <div id="tv-multi-file-hint" class="hidden mb-4 p-3 rounded-lg bg-blue-500/10 border border-blue-500/20">
              <div class="flex items-center gap-2 text-[11px] text-blue-400">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="10"></circle>
                  <line x1="12" y1="16" x2="12" y2="12"></line>
                  <line x1="12" y1="8" x2="12.01" y2="8"></line>
                </svg>
                <span><strong>TradingView tip:</strong> Last opp b√•de Order History OG Balance History for best resultat!</span>
              </div>
            </div>
            
            <div id="import-dropzone" class="border-2 border-dashed border-[#262626] rounded-xl p-8 text-center cursor-pointer hover:border-emerald-500/50 transition-colors">
              <input type="file" id="import-file-input" accept=".csv,.txt" multiple class="hidden" />
              <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="mx-auto text-slate-600 mb-3">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="17 8 12 3 7 8"></polyline>
                <line x1="12" y1="3" x2="12" y2="15"></line>
              </svg>
              <p class="text-[13px] text-slate-400 mb-1">Drop CSV file(s) here or click to browse</p>
              <p class="text-[10px] text-slate-600">Supports multiple files ‚Ä¢ .csv and .txt</p>
            </div>
            
            <!-- File Info - Now supports multiple files -->
            <div id="import-files-container" class="hidden mt-4 space-y-2">
              <!-- Files will be listed here -->
            </div>
            
            <!-- Legacy single file info (hidden, for backwards compat) -->
            <div id="import-file-info" class="hidden mt-4 p-3 rounded-lg bg-black/40 border border-[#262626]">
              <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                  <div class="w-10 h-10 rounded-lg bg-emerald-500/20 flex items-center justify-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-emerald-400">
                      <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                      <polyline points="14 2 14 8 20 8"></polyline>
                    </svg>
                  </div>
                  <div>
                    <div id="import-filename" class="text-[12px] font-medium text-slate-200">filename.csv</div>
                    <div id="import-filesize" class="text-[10px] text-slate-500">0 KB</div>
                  </div>
                </div>
                <button id="btn-remove-import-file" class="text-[10px] text-rose-400 hover:text-rose-300">Remove</button>
              </div>
            </div>
          </div>

          <!-- Column Mapping (for generic CSV) -->
          <div id="import-mapping-section" class="hidden rounded-xl bg-[#0a0a0a] border border-[#161616] p-5">
            <div class="flex items-center justify-between mb-4">
              <div>
                <h3 class="text-[13px] font-semibold text-slate-200">Column Mapping</h3>
                <p class="text-[11px] text-slate-500">Map your CSV columns to the required fields</p>
              </div>
              <button id="btn-auto-map" class="flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-blue-500/20 border border-blue-500/30 text-[11px] text-blue-400 hover:bg-blue-500/30 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M12 3v3m6.366-.366-2.12 2.12M21 12h-3m.366 6.366-2.12-2.12M12 21v-3m-6.366.366 2.12-2.12M3 12h3m-.366-6.366 2.12 2.12"/>
                </svg>
                Auto-detect
              </button>
            </div>
            
            <div class="grid grid-cols-2 md:grid-cols-3 gap-4" id="import-mapping-grid">
              <!-- Will be populated dynamically -->
            </div>
            
            <!-- Auto-map status -->
            <div id="auto-map-status" class="hidden mt-4 p-3 rounded-lg bg-emerald-500/10 border border-emerald-500/20">
              <div class="flex items-center gap-2 text-[11px] text-emerald-400">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                  <polyline points="22 4 12 14.01 9 11.01"></polyline>
                </svg>
                <span id="auto-map-message">Auto-detected columns</span>
              </div>
            </div>
          </div>

          <!-- Preview -->
          <div id="import-preview-section" class="hidden rounded-xl bg-[#0a0a0a] border border-[#161616] p-5">
            <div class="flex items-center justify-between mb-4">
              <div>
                <h3 class="text-[13px] font-semibold text-slate-200">Preview</h3>
                <p id="import-preview-count" class="text-[11px] text-slate-500">0 trades found</p>
              </div>
              <div class="flex items-center gap-3 flex-wrap">
                <!-- Account Selector for Import - IMPORTANT -->
                <div class="flex items-center gap-2 px-2 py-1 rounded-lg bg-amber-500/10 border border-amber-500/30">
                  <label class="text-[10px] text-amber-400 font-medium whitespace-nowrap">Account:</label>
                  <select id="import-account-selector" class="px-2 py-1 rounded bg-black/60 border border-amber-500/40 text-[11px] text-slate-200 focus:outline-none focus:border-amber-500/60 min-w-[120px]">
                    <option value="">Select account ‚ö†Ô∏è</option>
                    <!-- Options populated by JS -->
                  </select>
                </div>
                <!-- Contract Size Multiplier -->
                <div class="flex items-center gap-2">
                  <label class="text-[10px] text-slate-500">Contracts:</label>
                  <input type="number" id="import-contract-multiplier" value="1" min="1" step="1" class="w-16 px-2 py-1 rounded bg-black/60 border border-[#262626] text-[11px] text-slate-300 text-center focus:outline-none focus:border-blue-500/50" title="Multiply P&L if your export shows 1 unit but you traded more contracts" />
                </div>
                <label class="flex items-center gap-2 text-[11px] text-slate-400 cursor-pointer">
                  <input type="checkbox" id="import-skip-duplicates" checked class="rounded border-slate-600" />
                  Skip duplicates
                </label>
              </div>
            </div>
            
            <!-- P&L Calculation Note -->
            <div id="import-pnl-note" class="hidden mb-3 flex items-center gap-2 text-[10px]">
              <div id="import-pnl-badge" class="flex items-center gap-1.5 px-2 py-1 rounded-full bg-blue-500/10 border border-blue-500/20">
                <span id="import-pnl-icon" class="text-blue-400">‚óã</span>
                <span id="import-pnl-text" class="text-blue-300">P&L beregnet fra priser</span>
              </div>
              <span id="import-contract-type" class="text-slate-500"></span>
            </div>
            
            <div class="overflow-x-auto">
              <table class="w-full text-[11px]">
                <thead>
                  <tr class="border-b border-[#262626]">
                    <th class="text-left py-2 px-2 text-slate-500 font-medium">
                      <input type="checkbox" id="import-select-all" checked class="rounded border-slate-600" />
                    </th>
                    <th class="text-left py-2 px-2 text-slate-500 font-medium">Date/Time</th>
                    <th class="text-left py-2 px-2 text-slate-500 font-medium">Instrument</th>
                    <th class="text-left py-2 px-2 text-slate-500 font-medium">Direction</th>
                    <th class="text-right py-2 px-2 text-slate-500 font-medium">Entry</th>
                    <th class="text-right py-2 px-2 text-slate-500 font-medium">Exit</th>
                    <th class="text-right py-2 px-2 text-slate-500 font-medium">P&L</th>
                    <th class="text-center py-2 px-2 text-slate-500 font-medium">Status</th>
                  </tr>
                </thead>
                <tbody id="import-preview-body">
                  <!-- Preview rows will be rendered here -->
                </tbody>
              </table>
            </div>
            
            <!-- Import Summary -->
            <div class="mt-4 pt-4 border-t border-[#161616] grid grid-cols-4 gap-4">
              <div class="text-center">
                <div class="text-[10px] text-slate-500">Total Trades</div>
                <div id="import-total" class="text-[14px] font-semibold text-slate-200">0</div>
              </div>
              <div class="text-center">
                <div class="text-[10px] text-slate-500">Selected</div>
                <div id="import-selected" class="text-[14px] font-semibold text-emerald-400">0</div>
              </div>
              <div class="text-center">
                <div class="text-[10px] text-slate-500">Duplicates</div>
                <div id="import-duplicates" class="text-[14px] font-semibold text-amber-400">0</div>
              </div>
              <div class="text-center">
                <div class="text-[10px] text-slate-500">Total P&L</div>
                <div id="import-total-pnl" class="text-[14px] font-semibold text-slate-200">$0</div>
              </div>
            </div>
          </div>

          <!-- Import Actions -->
          <div id="import-actions" class="hidden flex justify-end gap-3">
            <button id="btn-cancel-import" class="px-4 py-2 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-300 hover:bg-black transition-colors">
              Cancel
            </button>
            <button id="btn-import-trades" class="px-5 py-2 rounded-lg bg-emerald-500 text-[12px] font-medium text-black hover:bg-emerald-400 transition-colors flex items-center gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
              </svg>
              Import Selected Trades
            </button>
          </div>

          <!-- Import History -->
          <div class="rounded-xl bg-[#0a0a0a] border border-[#161616] p-5">
            <h3 class="text-[13px] font-semibold text-slate-200 mb-4">Import History</h3>
            <div id="import-history-list" class="space-y-2">
              <!-- Import history will be rendered here -->
            </div>
            <div id="import-history-empty" class="text-[11px] text-slate-500 text-center py-4">
              No imports yet. Upload a file to get started.
            </div>
          </div>
        </div>
      </section>
    </div>

    <!-- Setup Modal -->
    <div id="setup-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 hidden p-4">
      <div class="w-full max-w-2xl rounded-2xl bg-[#0a0a0a] border border-[#262626] max-h-[90vh] overflow-y-auto">
        <div class="sticky top-0 bg-[#0a0a0a] border-b border-[#161616] p-4 flex items-center justify-between">
          <h3 id="setup-modal-title" class="text-[15px] font-semibold text-slate-200">Add New Setup</h3>
          <button id="btn-close-setup-modal" class="text-slate-400 hover:text-slate-200">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
        
        <div class="p-5 space-y-5">
          <!-- Basic Info -->
          <div class="space-y-3">
            <div>
              <label class="block text-[11px] text-slate-400 mb-1.5">Setup Name *</label>
              <input
                type="text"
                id="setup-name"
                class="w-full px-3 py-2.5 rounded-lg bg-black/60 border border-[#262626] text-[13px] text-slate-200 focus:outline-none focus:border-emerald-500/50"
                placeholder="e.g., ICT Breaker Block, VWAP Bounce"
              />
            </div>
            <div>
              <label class="block text-[11px] text-slate-400 mb-1.5">Description</label>
              <textarea
                id="setup-description"
                rows="2"
                class="w-full px-3 py-2.5 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-200 focus:outline-none focus:border-emerald-500/50 resize-none"
                placeholder="Brief description of this setup..."
              ></textarea>
            </div>
          </div>
          
          <!-- Tags -->
          <div>
            <label class="block text-[11px] text-slate-400 mb-1.5">Tags</label>
            <div class="flex flex-wrap gap-2" id="setup-tags-container">
              <label class="cursor-pointer">
                <input type="checkbox" name="setup-tag" value="breakout" class="hidden peer">
                <span class="px-3 py-1.5 rounded-full text-[10px] border border-[#262626] text-slate-400 peer-checked:bg-emerald-500/20 peer-checked:border-emerald-500/30 peer-checked:text-emerald-300 transition-colors">Breakout</span>
              </label>
              <label class="cursor-pointer">
                <input type="checkbox" name="setup-tag" value="reversal" class="hidden peer">
                <span class="px-3 py-1.5 rounded-full text-[10px] border border-[#262626] text-slate-400 peer-checked:bg-blue-500/20 peer-checked:border-blue-500/30 peer-checked:text-blue-300 transition-colors">Reversal</span>
              </label>
              <label class="cursor-pointer">
                <input type="checkbox" name="setup-tag" value="continuation" class="hidden peer">
                <span class="px-3 py-1.5 rounded-full text-[10px] border border-[#262626] text-slate-400 peer-checked:bg-purple-500/20 peer-checked:border-purple-500/30 peer-checked:text-purple-300 transition-colors">Continuation</span>
              </label>
              <label class="cursor-pointer">
                <input type="checkbox" name="setup-tag" value="scalp" class="hidden peer">
                <span class="px-3 py-1.5 rounded-full text-[10px] border border-[#262626] text-slate-400 peer-checked:bg-amber-500/20 peer-checked:border-amber-500/30 peer-checked:text-amber-300 transition-colors">Scalp</span>
              </label>
              <label class="cursor-pointer">
                <input type="checkbox" name="setup-tag" value="swing" class="hidden peer">
                <span class="px-3 py-1.5 rounded-full text-[10px] border border-[#262626] text-slate-400 peer-checked:bg-rose-500/20 peer-checked:border-rose-500/30 peer-checked:text-rose-300 transition-colors">Swing</span>
              </label>
              <label class="cursor-pointer">
                <input type="checkbox" name="setup-tag" value="orderflow" class="hidden peer">
                <span class="px-3 py-1.5 rounded-full text-[10px] border border-[#262626] text-slate-400 peer-checked:bg-cyan-500/20 peer-checked:border-cyan-500/30 peer-checked:text-cyan-300 transition-colors">Order Flow</span>
              </label>
            </div>
          </div>
          
          <!-- Rules -->
          <div class="grid md:grid-cols-2 gap-4">
            <div>
              <label class="block text-[11px] text-slate-400 mb-1.5">Entry Rules</label>
              <textarea
                id="setup-entry-rules"
                rows="4"
                class="w-full px-3 py-2.5 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-200 focus:outline-none focus:border-emerald-500/50 resize-none"
                placeholder="When to enter this setup..."
              ></textarea>
            </div>
            <div>
              <label class="block text-[11px] text-slate-400 mb-1.5">Exit Rules</label>
              <textarea
                id="setup-exit-rules"
                rows="4"
                class="w-full px-3 py-2.5 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-200 focus:outline-none focus:border-emerald-500/50 resize-none"
                placeholder="When to exit (TP, SL, time-based)..."
              ></textarea>
            </div>
          </div>
          
          <div>
            <label class="block text-[11px] text-slate-400 mb-1.5">What to Avoid</label>
            <textarea
              id="setup-avoid"
              rows="2"
              class="w-full px-3 py-2.5 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-200 focus:outline-none focus:border-emerald-500/50 resize-none"
              placeholder="Conditions when NOT to take this setup..."
            ></textarea>
          </div>
          
          <!-- Instruments -->
          <div>
            <label class="block text-[11px] text-slate-400 mb-1.5">Instruments (comma separated)</label>
            <input
              type="text"
              id="setup-instruments"
              class="w-full px-3 py-2.5 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-200 focus:outline-none focus:border-emerald-500/50"
              placeholder="e.g., ES, NQ, BTCUSDT"
            />
          </div>
          
          <!-- Screenshot Upload -->
          <div>
            <label class="block text-[11px] text-slate-400 mb-1.5">Example Screenshot</label>
            <div id="setup-screenshot-drop" class="border-2 border-dashed border-[#262626] rounded-lg p-6 text-center cursor-pointer hover:border-emerald-500/50 transition-colors">
              <input type="file" id="setup-screenshot-input" accept="image/*" class="hidden" />
              <div id="setup-screenshot-preview" class="hidden">
                <img id="setup-screenshot-img" src="" alt="Preview" class="max-h-48 mx-auto rounded-lg mb-2" />
                <button id="btn-remove-screenshot" class="text-[10px] text-rose-400 hover:text-rose-300">Remove</button>
              </div>
              <div id="setup-screenshot-placeholder">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mx-auto text-slate-600 mb-2">
                  <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                  <circle cx="8.5" cy="8.5" r="1.5"></circle>
                  <polyline points="21 15 16 10 5 21"></polyline>
                </svg>
                <p class="text-[11px] text-slate-500">Click or drag to upload an example chart</p>
              </div>
            </div>
          </div>
        </div>
        
        <div class="sticky bottom-0 bg-[#0a0a0a] border-t border-[#161616] p-4 flex justify-end gap-3">
          <button id="btn-cancel-setup" class="px-4 py-2 rounded-lg bg-black/60 border border-[#262626] text-[12px] text-slate-300 hover:bg-black transition-colors">
            Cancel
          </button>
          <button id="btn-save-setup" class="px-5 py-2 rounded-lg bg-emerald-500 text-[12px] font-medium text-black hover:bg-emerald-400 transition-colors">
            Save Setup
          </button>
        </div>
      </div>
    </div>
    
    <!-- Setup Detail Modal -->
    <div id="setup-detail-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 hidden p-4">
      <div class="w-full max-w-3xl rounded-2xl bg-[#0a0a0a] border border-[#262626] max-h-[90vh] overflow-y-auto">
        <div class="sticky top-0 bg-[#0a0a0a] border-b border-[#161616] p-4 flex items-center justify-between">
          <h3 id="setup-detail-title" class="text-[15px] font-semibold text-slate-200">Setup Details</h3>
          <div class="flex items-center gap-2">
            <button id="btn-edit-setup" class="px-3 py-1.5 rounded-lg bg-black/60 border border-[#262626] text-[11px] text-slate-300 hover:bg-black transition-colors">
              Edit
            </button>
            <button id="btn-delete-setup" class="px-3 py-1.5 rounded-lg bg-rose-500/20 border border-rose-500/30 text-[11px] text-rose-300 hover:bg-rose-500/30 transition-colors">
              Delete
            </button>
            <button id="btn-close-setup-detail" class="text-slate-400 hover:text-slate-200 ml-2">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
              </svg>
            </button>
          </div>
        </div>
        <div id="setup-detail-content" class="p-5">
          <!-- Content will be rendered by JavaScript -->
        </div>
      </div>
    </div>

    <!-- Parameters edit modal -->
    <div
      id="parameters-modal"
      class="fixed inset-0 bg-black/60 flex items-center justify-center z-50 hidden p-4"
    >
      <div
        class="w-full max-w-lg rounded-2xl bg-[#050505] border border-[#262626] p-4 md:p-5 max-h-[90vh] overflow-y-auto"
      >
        <div class="flex items-center justify-between mb-3">
          <h3 class="text-[14px] font-semibold">Edit routine parameters</h3>
          <button
            id="btn-close-parameters"
            class="text-[11px] text-slate-400 hover:text-slate-200"
          >
            close
          </button>
        </div>
        <p class="text-[11px] text-slate-400 mb-3">
          One item per line. These define the checklist under ‚Äúroutine level
          check‚Äù.
        </p>
        <textarea
          id="parameters-input"
          rows="8"
          class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
        ></textarea>
        <div class="flex justify-end gap-2 mt-4">
          <button
            id="btn-reset-parameters"
            class="px-3 py-1.5 rounded-lg border border-[#383838] bg-black/60 text-[11px] text-slate-200 hover:bg-black"
          >
            reset defaults
          </button>
          <button
            id="btn-save-parameters"
            class="px-4 py-1.5 rounded-lg bg-emerald-500 text-[11px] font-medium text-black hover:bg-emerald-400"
          >
            save
          </button>
        </div>
      </div>
    </div>

    <!-- Account modal -->
    <div
      id="account-modal"
      class="fixed inset-0 bg-black/60 flex items-center justify-center z-50 hidden p-4"
    >
      <div class="w-full max-w-md rounded-2xl bg-[#0a0a0a] border border-[#222] p-5 max-h-[90vh] overflow-y-auto">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-[14px] font-semibold text-slate-200" id="account-modal-title">Add Account</h3>
          <button id="btn-close-account" class="text-slate-500 hover:text-slate-300 transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
        
        <div class="space-y-4">
          <!-- Category Selection -->
          <div>
            <label class="block text-[11px] text-slate-500 mb-2">Asset Class</label>
            <div id="category-buttons" class="grid grid-cols-3 gap-2">
              <button type="button" data-category="crypto" class="category-btn px-3 py-2 rounded-lg border border-[#222] bg-black/40 text-[11px] text-slate-400 hover:border-slate-500 hover:text-slate-200 transition-all">Crypto</button>
              <button type="button" data-category="forex" class="category-btn px-3 py-2 rounded-lg border border-[#222] bg-black/40 text-[11px] text-slate-400 hover:border-slate-500 hover:text-slate-200 transition-all">Forex</button>
              <button type="button" data-category="stocks" class="category-btn px-3 py-2 rounded-lg border border-[#222] bg-black/40 text-[11px] text-slate-400 hover:border-slate-500 hover:text-slate-200 transition-all">Stocks</button>
              <button type="button" data-category="futures" class="category-btn px-3 py-2 rounded-lg border border-[#222] bg-black/40 text-[11px] text-slate-400 hover:border-slate-500 hover:text-slate-200 transition-all">Futures</button>
              <button type="button" data-category="options" class="category-btn px-3 py-2 rounded-lg border border-[#222] bg-black/40 text-[11px] text-slate-400 hover:border-slate-500 hover:text-slate-200 transition-all">Options</button>
              <button type="button" data-category="other" class="category-btn px-3 py-2 rounded-lg border border-[#222] bg-black/40 text-[11px] text-slate-400 hover:border-slate-500 hover:text-slate-200 transition-all">Other</button>
            </div>
            <input type="hidden" id="account-category-input" value="crypto" />
          </div>
          
          <!-- Account Name -->
          <div>
            <label class="block text-[11px] text-slate-500 mb-1.5">Account / Broker Name</label>
            <input
              id="account-name-input"
              type="text"
              class="w-full px-3 py-2.5 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-emerald-500/50 transition-colors"
              placeholder="e.g., Bybit, Binance, OANDA..."
            />
          </div>
          
          <!-- Initial Balance -->
          <div>
            <label class="block text-[11px] text-slate-500 mb-1.5">Starting Balance</label>
            <div class="relative">
              <span class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 text-[12px]">$</span>
              <input
                id="account-balance-input"
                type="number"
                step="0.01"
                min="0"
                class="w-full pl-7 pr-3 py-2.5 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-emerald-500/50 transition-colors"
                placeholder="10,000.00"
              />
            </div>
          </div>
        </div>
        
        <div class="flex justify-end gap-2 mt-5 pt-4 border-t border-[#1a1a1a]">
          <button
            id="btn-cancel-account"
            class="px-4 py-2 rounded-lg border border-[#222] bg-black/40 text-[11px] text-slate-300 hover:bg-black transition-colors"
          >
            Cancel
          </button>
          <button
            id="btn-save-account"
            class="px-5 py-2 rounded-lg bg-emerald-500 text-[11px] font-medium text-black hover:bg-emerald-400 transition-colors"
          >
            Save Account
          </button>
        </div>
      </div>
    </div>

    <!-- Trade Review Modal -->
    <div
      id="trade-review-modal"
      class="fixed inset-0 bg-black/60 flex items-center justify-center z-50 hidden p-4"
    >
      <div
        class="w-full max-w-2xl rounded-2xl bg-[#050505] border border-[#262626] p-4 md:p-5 max-h-[90vh] overflow-y-auto"
      >
        <div class="flex items-center justify-between mb-3">
          <h3 class="text-[14px] font-semibold" id="trade-review-title">Review Trade</h3>
          <button
            id="btn-close-review"
            class="text-[11px] text-slate-400 hover:text-slate-200"
          >
            close
          </button>
        </div>
        <div id="trade-review-content" class="space-y-4">
          <!-- Trade info will be inserted here -->
        </div>
        <div class="mt-4 space-y-3">
          <div>
            <label class="block text-[11px] text-slate-400 mb-2">Did this trade work?</label>
            <div class="flex gap-2">
              <button
                id="review-worked-yes"
                class="flex-1 px-4 py-2 rounded-lg border border-emerald-500/30 bg-emerald-500/10 text-[12px] text-emerald-300 hover:bg-emerald-500/20 transition-all font-medium"
              >
                ‚úì Worked
              </button>
              <button
                id="review-worked-no"
                class="flex-1 px-4 py-2 rounded-lg border border-rose-500/30 bg-rose-500/10 text-[12px] text-rose-300 hover:bg-rose-500/20 transition-all font-medium"
              >
                ‚úó Didn't Work
              </button>
            </div>
          </div>
          <div>
            <label id="review-problems-label" class="block text-[11px] text-slate-400 mb-2">What went wrong? (Select all that apply)</label>
            <!-- What went wrong checkboxes -->
            <div id="review-problems-wrong" class="space-y-2">
              <label class="flex items-center gap-2">
                <input type="checkbox" class="review-problem" value="market-structure" />
                <span class="text-[12px] text-slate-300">Market structure was wrong</span>
              </label>
              <label class="flex items-center gap-2">
                <input type="checkbox" class="review-problem" value="orderflow" />
                <span class="text-[12px] text-slate-300">Orderflow didn't confirm</span>
              </label>
              <label class="flex items-center gap-2">
                <input type="checkbox" class="review-problem" value="tpo-profile" />
                <span class="text-[12px] text-slate-300">TPO/Profile mismatch</span>
              </label>
              <label class="flex items-center gap-2">
                <input type="checkbox" class="review-problem" value="orderblock" />
                <span class="text-[12px] text-slate-300">Orderblock was weak/overtested</span>
              </label>
              <label class="flex items-center gap-2">
                <input type="checkbox" class="review-problem" value="execution" />
                <span class="text-[12px] text-slate-300">Poor execution / psychology</span>
              </label>
              <label class="flex items-center gap-2">
                <input type="checkbox" class="review-problem" value="risk-management" />
                <span class="text-[12px] text-slate-300">Risk management issue</span>
              </label>
              <label class="flex items-center gap-2">
                <input type="checkbox" class="review-problem" value="timing" />
                <span class="text-[12px] text-slate-300">Bad timing</span>
              </label>
            </div>
            <!-- What worked checkboxes -->
            <div id="review-problems-worked" class="space-y-2 hidden">
              <label class="flex items-center gap-2">
                <input type="checkbox" class="review-problem" value="market-structure" />
                <span class="text-[12px] text-slate-300">Market structure was correct</span>
              </label>
              <label class="flex items-center gap-2">
                <input type="checkbox" class="review-problem" value="orderflow" />
                <span class="text-[12px] text-slate-300">Orderflow confirmed</span>
              </label>
              <label class="flex items-center gap-2">
                <input type="checkbox" class="review-problem" value="tpo-profile" />
                <span class="text-[12px] text-slate-300">TPO/Profile aligned</span>
              </label>
              <label class="flex items-center gap-2">
                <input type="checkbox" class="review-problem" value="orderblock" />
                <span class="text-[12px] text-slate-300">Strong orderblock</span>
              </label>
              <label class="flex items-center gap-2">
                <input type="checkbox" class="review-problem" value="execution" />
                <span class="text-[12px] text-slate-300">Good execution / discipline</span>
              </label>
              <label class="flex items-center gap-2">
                <input type="checkbox" class="review-problem" value="risk-management" />
                <span class="text-[12px] text-slate-300">Proper risk management</span>
              </label>
              <label class="flex items-center gap-2">
                <input type="checkbox" class="review-problem" value="timing" />
                <span class="text-[12px] text-slate-300">Perfect timing</span>
              </label>
            </div>
          </div>
          <div>
            <label class="block text-[11px] text-slate-400 mb-2">Additional notes</label>
            <textarea
              id="review-notes"
              rows="3"
              class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
              placeholder="What specifically went wrong? What would you do differently?"
            ></textarea>
          </div>
        </div>
        <div class="flex justify-end gap-2 mt-4">
          <button
            id="btn-cancel-review"
            class="px-3 py-1.5 rounded-lg border border-[#383838] bg-black/60 text-[11px] text-slate-200 hover:bg-black"
          >
            cancel
          </button>
          <button
            id="btn-save-review"
            class="px-4 py-1.5 rounded-lg bg-emerald-500 text-[11px] font-medium text-black hover:bg-emerald-400"
          >
            save review
          </button>
        </div>
      </div>
    </div>

    <!-- Trade Plan Configuration Modal -->
    <div
      id="trade-plan-config-modal"
      class="fixed inset-0 bg-black/60 flex items-center justify-center z-50 hidden p-4"
    >
      <div
        class="w-full max-w-lg rounded-2xl bg-[#050505] border border-[#262626] p-4 md:p-5 max-h-[90vh] overflow-y-auto"
      >
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-[14px] font-semibold text-slate-200">
            Configure Trade Plan Parameters
          </h3>
          <button
            id="btn-close-trade-plan-config"
            class="text-[11px] text-slate-400 hover:text-slate-200"
          >
            close
          </button>
        </div>
        <p class="text-[11px] text-slate-400 mb-4">
          Select which parameters to show in the Trade Plan section
        </p>
        <div class="space-y-3 mb-4">
          <label class="flex items-center gap-2">
            <input type="checkbox" class="trade-plan-param" data-param="account" checked />
            <span class="text-[12px] text-slate-300">Account</span>
          </label>
          <label class="flex items-center gap-2">
            <input type="checkbox" class="trade-plan-param" data-param="entry" checked />
            <span class="text-[12px] text-slate-300">Entry</span>
          </label>
          <label class="flex items-center gap-2">
            <input type="checkbox" class="trade-plan-param" data-param="sl" checked />
            <span class="text-[12px] text-slate-300">Stop Loss (SL)</span>
          </label>
          <label class="flex items-center gap-2">
            <input type="checkbox" class="trade-plan-param" data-param="tp" checked />
            <span class="text-[12px] text-slate-300">Take Profit (TP)</span>
          </label>
          <label class="flex items-center gap-2">
            <input type="checkbox" class="trade-plan-param" data-param="size" checked />
            <span class="text-[12px] text-slate-300">Position Size ($)</span>
          </label>
          <label class="flex items-center gap-2">
            <input type="checkbox" class="trade-plan-param" data-param="result" checked />
            <span class="text-[12px] text-slate-300">Trade Result (Win/Loss)</span>
          </label>
          <label class="flex items-center gap-2">
            <input type="checkbox" class="trade-plan-param" data-param="pnl" checked />
            <span class="text-[12px] text-slate-300">P&L ($)</span>
          </label>
          <label class="flex items-center gap-2">
            <input type="checkbox" class="trade-plan-param" data-param="notes" checked />
            <span class="text-[12px] text-slate-300">Plan Notes</span>
          </label>
        </div>
        <div class="flex justify-end gap-2">
          <button
            id="btn-save-trade-plan-config"
            class="px-4 py-2 rounded-lg bg-emerald-500 text-[12px] font-medium text-black hover:bg-emerald-400"
          >
            Save
          </button>
        </div>
      </div>
    </div>

    <!-- Settings Modal -->
    <div
      id="settings-modal"
      class="fixed inset-0 bg-black/60 flex items-center justify-center z-50 hidden p-4"
    >
      <div
        class="w-full max-w-4xl max-h-[90vh] rounded-2xl bg-[#050505] border border-[#262626] p-4 md:p-6 overflow-y-auto"
      >
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-[16px] font-semibold text-slate-200">
            Settings
          </h3>
          <button
            id="btn-close-settings"
            class="text-[11px] text-slate-400 hover:text-slate-200"
          >
            close
          </button>
        </div>
        <p class="text-[12px] text-slate-400 mb-6">
          Customize Daily Prep fields and Trade Checklist items to match your trading style. Changes are saved automatically.
        </p>

        <!-- Tabs -->
        <div class="flex gap-2 mb-6 border-b border-[#1f1f1f] pb-2">
          <button
            data-settings-tab="daily-prep"
            class="settings-tab px-4 py-2 rounded-lg text-[12px] font-medium bg-[#181818] text-white"
          >
            Daily Prep
          </button>
          <button
            data-settings-tab="checklist"
            class="settings-tab px-4 py-2 rounded-lg text-[12px] font-medium text-slate-400 hover:text-white hover:bg-[#181818]"
          >
            Trade Checklist
          </button>
        </div>

        <!-- Daily Prep Configuration -->
        <div id="settings-daily-prep" class="settings-panel">
          <div class="mb-4">
            <h4 class="text-[13px] font-medium text-slate-300 mb-2">Daily Prep Fields</h4>
            <p class="text-[11px] text-slate-500 mb-4">Add, edit, or remove fields in your Daily Prep section. Drag to reorder.</p>
          </div>

          <!-- Prep Groups -->
          <div class="space-y-4 mb-6">
            <div class="rounded-xl bg-[#0a0a0a] border border-[#161616] p-4">
              <div class="flex items-center justify-between mb-3">
                <h5 class="text-[12px] font-medium text-slate-300">Prep Groups</h5>
                <button id="btn-add-prep-group" class="px-2 py-1 rounded bg-emerald-500/20 text-emerald-400 text-[10px] hover:bg-emerald-500/30">
                  + Add Group
                </button>
              </div>
              <div id="prep-groups-list" class="space-y-2">
                <!-- Prep groups will be rendered here -->
              </div>
            </div>
          </div>

          <!-- Daily Plan Notes -->
          <div class="rounded-xl bg-[#0a0a0a] border border-[#161616] p-4">
            <div class="flex items-center justify-between mb-3">
              <h5 class="text-[12px] font-medium text-slate-300">Daily Plan Notes</h5>
              <button id="btn-add-prep-note" class="px-2 py-1 rounded bg-emerald-500/20 text-emerald-400 text-[10px] hover:bg-emerald-500/30">
                + Add Note Field
              </button>
            </div>
            <div id="prep-notes-list" class="space-y-2">
              <!-- Note fields will be rendered here -->
            </div>
          </div>

          <!-- Reset to Default -->
          <div class="mt-6 pt-4 border-t border-[#1f1f1f]">
            <button id="btn-reset-prep-defaults" class="px-4 py-2 rounded-lg bg-rose-500/20 text-rose-400 text-[11px] hover:bg-rose-500/30">
              Reset Daily Prep to Defaults
            </button>
          </div>
        </div>

        <!-- Trade Checklist Configuration -->
        <div id="settings-checklist" class="settings-panel hidden">
          <div class="mb-4">
            <h4 class="text-[13px] font-medium text-slate-300 mb-2">Trade Checklist Items</h4>
            <p class="text-[11px] text-slate-500 mb-4">Customize your checklist categories and criteria. Each item has a weight that affects the final score.</p>
          </div>

          <!-- Checklist Categories -->
          <div class="space-y-4 mb-6">
            <div class="rounded-xl bg-[#0a0a0a] border border-[#161616] p-4">
              <div class="flex items-center justify-between mb-3">
                <h5 class="text-[12px] font-medium text-slate-300">Checklist Categories</h5>
                <button id="btn-add-checklist-category" class="px-2 py-1 rounded bg-emerald-500/20 text-emerald-400 text-[10px] hover:bg-emerald-500/30">
                  + Add Category
                </button>
              </div>
              <div id="checklist-categories-list" class="space-y-3">
                <!-- Categories will be rendered here -->
              </div>
            </div>
          </div>

          <!-- Scoring Settings -->
          <div class="rounded-xl bg-[#0a0a0a] border border-[#161616] p-4">
            <h5 class="text-[12px] font-medium text-slate-300 mb-3">Scoring Settings</h5>
            <div class="grid grid-cols-2 gap-4">
              <div>
                <label class="block text-[11px] text-slate-400 mb-1">Minimum score to trade</label>
                <input
                  id="settings-min-score"
                  type="number"
                  min="0"
                  max="100"
                  class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
                  placeholder="70"
                />
              </div>
              <div>
                <label class="block text-[11px] text-slate-400 mb-1">Quality labels</label>
                <select
                  id="settings-quality-labels"
                  class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
                >
                  <option value="default">Default (A+, A, B, C, D)</option>
                  <option value="simple">Simple (Good, OK, Bad)</option>
                  <option value="numeric">Numeric only</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Reset to Default -->
          <div class="mt-6 pt-4 border-t border-[#1f1f1f]">
            <button id="btn-reset-checklist-defaults" class="px-4 py-2 rounded-lg bg-rose-500/20 text-rose-400 text-[11px] hover:bg-rose-500/30">
              Reset Trade Checklist to Defaults
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Edit Prep Group Modal -->
    <div
      id="edit-prep-group-modal"
      class="fixed inset-0 bg-black/70 flex items-center justify-center z-[60] hidden p-4"
    >
      <div class="w-full max-w-lg max-h-[90vh] rounded-2xl bg-[#0a0a0a] border border-[#262626] p-4 md:p-5 overflow-y-auto">
        <div class="flex items-center justify-between mb-4">
          <h3 id="edit-prep-group-title" class="text-[14px] font-semibold text-slate-200">Edit Group</h3>
          <button id="btn-close-edit-prep-group" class="text-[11px] text-slate-400 hover:text-slate-200">close</button>
        </div>
        <div class="space-y-4">
          <div>
            <label class="block text-[11px] text-slate-400 mb-1">Group Title</label>
            <input
              id="edit-prep-group-name"
              type="text"
              class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
              placeholder="e.g., Market & HTF"
            />
          </div>
          <div>
            <div class="flex items-center justify-between mb-2">
              <label class="block text-[11px] text-slate-400">Fields</label>
              <button id="btn-add-prep-field" class="px-2 py-1 rounded bg-emerald-500/20 text-emerald-400 text-[10px] hover:bg-emerald-500/30">
                + Add Field
              </button>
            </div>
            <div id="edit-prep-group-fields" class="space-y-2">
              <!-- Fields will be rendered here -->
            </div>
          </div>
        </div>
        <div class="flex justify-between mt-6">
          <button id="btn-delete-prep-group" class="px-4 py-2 rounded-lg bg-rose-500/20 text-rose-400 text-[11px] hover:bg-rose-500/30">
            Delete Group
          </button>
          <button id="btn-save-prep-group" class="px-4 py-2 rounded-lg bg-emerald-500 text-[12px] font-medium text-black hover:bg-emerald-400">
            Save
          </button>
        </div>
      </div>
    </div>

    <!-- Edit Checklist Category Modal -->
    <div
      id="edit-checklist-category-modal"
      class="fixed inset-0 bg-black/70 flex items-center justify-center z-[60] hidden p-4"
    >
      <div class="w-full max-w-lg max-h-[90vh] rounded-2xl bg-[#0a0a0a] border border-[#262626] p-4 md:p-5 overflow-y-auto">
        <div class="flex items-center justify-between mb-4">
          <h3 id="edit-checklist-category-title" class="text-[14px] font-semibold text-slate-200">Edit Category</h3>
          <button id="btn-close-edit-checklist-category" class="text-[11px] text-slate-400 hover:text-slate-200">close</button>
        </div>
        <div class="space-y-4">
          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="block text-[11px] text-slate-400 mb-1">Category Number</label>
              <input
                id="edit-checklist-category-number"
                type="text"
                class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
                placeholder="1"
              />
            </div>
            <div>
              <label class="block text-[11px] text-slate-400 mb-1">Category ID</label>
              <input
                id="edit-checklist-category-id"
                type="text"
                class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
                placeholder="ms"
              />
            </div>
          </div>
          <div>
            <label class="block text-[11px] text-slate-400 mb-1">Category Title</label>
            <input
              id="edit-checklist-category-title-input"
              type="text"
              class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
              placeholder="e.g., Market structure"
            />
          </div>
          <div>
            <label class="block text-[11px] text-slate-400 mb-1">Subtitle</label>
            <input
              id="edit-checklist-category-subtitle"
              type="text"
              class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
              placeholder="e.g., Trend, structure, liquidity"
            />
          </div>
          <div>
            <label class="block text-[11px] text-slate-400 mb-1">Description</label>
            <textarea
              id="edit-checklist-category-description"
              rows="2"
              class="w-full px-3 py-2 rounded-lg border border-[#222] bg-black text-[12px] text-slate-100 focus:outline-none focus:border-slate-400"
              placeholder="Brief description of this category..."
            ></textarea>
          </div>
          <div>
            <div class="flex items-center justify-between mb-2">
              <label class="block text-[11px] text-slate-400">Checklist Items</label>
              <button id="btn-add-checklist-item" class="px-2 py-1 rounded bg-emerald-500/20 text-emerald-400 text-[10px] hover:bg-emerald-500/30">
                + Add Item
              </button>
            </div>
            <div id="edit-checklist-category-items" class="space-y-2">
              <!-- Items will be rendered here -->
            </div>
          </div>
        </div>
        <div class="flex justify-between mt-6">
          <button id="btn-delete-checklist-category" class="px-4 py-2 rounded-lg bg-rose-500/20 text-rose-400 text-[11px] hover:bg-rose-500/30">
            Delete Category
          </button>
          <button id="btn-save-checklist-category" class="px-4 py-2 rounded-lg bg-emerald-500 text-[12px] font-medium text-black hover:bg-emerald-400">
            Save
          </button>
        </div>
      </div>
    </div>

    <!-- Screenshot Preview Modal -->
    <div
      id="screenshot-preview-modal"
      class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 hidden p-2 md:p-4"
    >
      <div class="relative max-w-7xl max-h-[95vh] w-full">
        <button
          id="btn-close-screenshot-preview"
          class="absolute top-2 right-2 md:top-4 md:right-4 z-10 px-3 py-2 rounded-lg bg-black/80 border border-[#262626] text-slate-200 hover:bg-black text-[12px] touch-target"
        >
          ‚úï Close
        </button>
        <img
          id="screenshot-preview-image"
          src=""
          alt="Screenshot preview"
          class="w-full h-auto rounded-lg border border-[#262626] max-h-[90vh] object-contain"
        />
        <div class="mt-2 text-center">
          <div id="screenshot-preview-date" class="text-[12px] text-slate-400"></div>
        </div>
      </div>
    </div>

    <!-- Journal Archives View Modal -->
    <div
      id="journal-archives-modal"
      class="fixed inset-0 bg-black/60 flex items-center justify-center z-50 hidden p-4"
    >
      <div
        class="w-full max-w-2xl max-h-[90vh] rounded-2xl bg-[#050505] border border-[#262626] p-4 md:p-5 overflow-y-auto"
      >
        <div class="flex items-center justify-between mb-4">
          <h3 id="journal-archives-modal-title" class="text-[14px] font-semibold text-slate-200">
            Journal Archives
          </h3>
          <button
            id="btn-close-journal-archives-modal"
            class="text-[11px] text-slate-400 hover:text-slate-200"
          >
            close
          </button>
        </div>
        <div id="journal-archives-modal-content" class="space-y-3">
          <!-- Trades will be rendered here -->
        </div>
      </div>
    </div>

    <!-- html2canvas for screenshot export -->
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

    <!-- Mobile Menu JS -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('sidebar-overlay');
        
        console.log('Mobile menu init:', { mobileMenuBtn, sidebar, overlay });
        
        function openSidebar() {
          console.log('Opening sidebar');
          if (sidebar) sidebar.classList.add('open');
          if (overlay) overlay.classList.add('open');
          document.body.style.overflow = 'hidden';
        }
        
        function closeSidebar() {
          console.log('Closing sidebar');
          if (sidebar) sidebar.classList.remove('open');
          if (overlay) overlay.classList.remove('open');
          document.body.style.overflow = '';
        }
        
        if (mobileMenuBtn) {
          mobileMenuBtn.addEventListener('click', function(e) {
            e.preventDefault();
            openSidebar();
          });
        }
        
        if (overlay) {
          overlay.addEventListener('click', closeSidebar);
        }
        
        // Close sidebar when clicking a nav link on mobile
        document.querySelectorAll('[data-section-nav]').forEach(link => {
          link.addEventListener('click', () => {
            if (window.innerWidth < 769) {
              closeSidebar();
            }
          });
        });
        
        // Handle escape key
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape') {
            closeSidebar();
          }
        });
        
        // Close sidebar on resize to desktop
        window.addEventListener('resize', () => {
          if (window.innerWidth >= 769) {
            closeSidebar();
          }
        });
      });
    </script>

    <!-- Supabase Sync Layer -->
    <script src="./js/supabase-sync.js"></script>
    
    <!-- App JS -->
    <script src="./js/main.js"></script>
  </body>
</html>
